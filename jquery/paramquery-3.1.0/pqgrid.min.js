/**
 * ParamQuery Pro v3.1.0
 * 
 * Copyright (c) 2012-2015 Paramvir Dhindsa (http://paramquery.com)
 * Released under Commercial license
 * http://paramquery.com/pro/license
 * 
 */
(function(f){var k=f.paramquery=f.paramquery||{};f.paramquery.pqgrid=f.paramquery.pqgrid||{};k.xmlToArray=function(m,e){var c=e.itemParent,a=e.itemNames,b=[];f(m).find(c).each(function(d,c){var e=f(c),g=[];f(a).each(function(a,b){g.push(e.find(b).text().replace(/\r|\n|\t/g,""))});b.push(g)});return b};k.xmlToJson=function(m,e){var c=e.itemParent,a=e.itemNames,b=[];f(m).find(c).each(function(d,c){for(var e=f(c),g={},q=0,n=a.length;q<n;q++){var u=a[q];g[u]=e.find(u).text().replace(/\r|\n|\t/g,"")}b.push(g)});
return b};k.tableToArray=function(m){var e=[],c=[];m=f(m).children("tbody").children("tr");var a=m.length?f(m[0]):f(),b=1<m.length?f(m[1]):f();a.children("th,td").each(function(a,c){var h=f(c),g=h.html(),h=h.width(),q="left";if(b.length)var n=b.find("td:eq("+a+")").attr("align"),q=n?n:q;e.push({title:g,width:h,dataType:"string",align:q,dataIndx:a})});m.each(function(a,b){if(0!=a){var e=[];f(b).children("td").each(function(a,b){e.push(f.trim(f(b).html()))});c.push(e)}});return{data:c,colModel:e}};
k.formatCurrency=function(f){if(isNaN(f))return f;f=Math.round(100*f)/100;f+="";-1==f.indexOf(".")?f+=".00":f.indexOf(".")+2==f.length&&(f+="0");var e=f.length,c=f.substring(0,e-3);f=f.substring(e-3,e);for(var c=c.match(/\d/g).reverse(),e=[],a=0;a<c.length;a++)0<a&&0==a%3&&e.push(","),e.push(c[a]);e=e.reverse();c=e.join("");return c+f};k.validation={is:function(f,e){if("string"==f||!f)return!0;f=f.substring(0,1).toUpperCase()+f.substring(1,f.length);return this["is"+f](e)},isFloat:function(f){var e=
parseFloat(f);return isNaN(e)||e!=f?!1:!0},isInteger:function(f){var e=parseInt(f);return isNaN(e)||e!=f?!1:!0},isDate:function(f){f=Date.parse(f);return isNaN(f)?!1:!0}}})(jQuery);
(function(f){function k(a,b,d){return a?f("<span tabindex='0' rel='tooltip' data-placement='top' title='"+b+"' class='panel panel-default "+d+"'></span>"):f("<span class='pq-ui-button ui-widget-header' tabindex='0' rel='tooltip' title='"+b+"'><span class='ui-icon ui-icon-"+d+"'></span></span>")}function m(a,b){a.bind("click keydown",function(a){if("keydown"!=a.type||a.keyCode==f.ui.keyCode.ENTER)return b.call(this,a)})}function e(a,b,d){b[d?"addClass":"removeClass"]("disabled").css("pointer-events",
d?"none":"").attr("tabindex",d?"":"0")}var c={options:{bootstrap:{on:!1,pager:"panel panel-default",nextIcon:"glyphicon glyphicon-forward",prevIcon:"glyphicon glyphicon-backward",firstIcon:"glyphicon glyphicon-step-backward",lastIcon:"glyphicon glyphicon-step-forward",refreshIcon:"glyphicon glyphicon-refresh"},curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},_regional:{strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",
strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"}};f.extend(c.options,c._regional);c._create=function(){var a=this,b=this.options,d=b.bootstrap,c=d.on;this.element.addClass("pq-pager "+(c?d.pager:""));this.first=k(c,b.strFirstPage,c?d.firstIcon:"seek-first").appendTo(this.element);m(this.first,function(b){1<a.options.curPage&&a._onChange(b,1)});this.prev=k(c,b.strPrevPage,c?d.prevIcon:"seek-prev").appendTo(this.element);
m(this.prev,function(b){1<a.options.curPage&&a._onChange(b,a.options.curPage-1)});f("<span class='pq-separator'></span>").appendTo(this.element);this.pageHolder=f("<span class='pq-page-placeholder'></span>").appendTo(this.element);f("<span class='pq-separator'></span>").appendTo(this.element);this.next=k(c,b.strNextPage,c?d.nextIcon:"seek-next").appendTo(this.element);m(this.next,function(b){a.options.curPage<a.options.totalPages&&a._onChange(b,a.options.curPage+1)});this.last=k(c,b.strLastPage,c?
d.lastIcon:"seek-end").appendTo(this.element);m(this.last,function(b){a.options.curPage!==a.options.totalPages&&a._onChange(b,a.options.totalPages)});f("<span class='pq-separator'></span>").appendTo(this.element);this.rPPHolder=f("<span class='pq-page-placeholder'></span>").appendTo(this.element);this.$refresh=k(c,b.strRefresh,c?d.refreshIcon:"refresh").appendTo(this.element);m(this.$refresh,function(b){if(!1===a._trigger("beforeRefresh",b))return!1;a._trigger("refresh",b)});f("<span class='pq-separator'></span>").appendTo(this.element);
this.$msg=f("<span class='pq-pager-msg'></span>").appendTo(this.element);this._refresh()};c._refreshPage=function(){var a=this;this.pageHolder.empty();for(var b=this.options,d=b.strPage.split(" "),c=[],e=0,g=d.length;e<g;e++){var q=d[e];"{0}"==q?c.push("<input type='text' tabindex='0' class='ui-corner-all' />"):"{1}"==q?c.push("<span class='total'></span>"):c.push("<span>",q,"</span>")}d=c.join("");d=f(d).appendTo(this.pageHolder);this.page=d.filter("input").bind("change",function(d){var c=f(this),
p=c.val();if(isNaN(p)||1>p)return c.val(b.curPage),!1;p=parseInt(p);if(p>b.totalPages||!1===a._onChange(d,p))return c.val(b.curPage),!1});this.$total=d.filter("span.total")};c._onChange=function(a,b){if(!1===this._trigger("beforeChange",a,{curPage:b})||!1===this._trigger("change",a,{curPage:b}))return!1;this.option({curPage:b})};c._refresh=function(){this._refreshPage();var a=this,b=this.options;this.rPPHolder.empty();if(b.strRpp){var d=b.rPPOptions,c=b.strRpp;if(-1!=c.indexOf("{0}")){for(var h=["<select class='ui-corner-all'>"],
g=0,q=d.length;g<q;g++){var n=d[g];h.push('<option value="',n,'">',n,"</option>")}h.push("</select>");d=h.join("");c=c.replace("{0}","</span>"+d);c="<span>"+c+"<span class='pq-separator'></span>"}else c="<span>"+c+"</span><span class='pq-separator'></span>";this.$rPP=f(c).appendTo(this.rPPHolder).filter("select").val(b.rPP).change(function(b){var p=f(this),v=p.val();if(!1===a._trigger("beforeChange",b,{rPP:v}))return p.val(a.options.rPP),!1;!1!==a._trigger("change",b,{rPP:v})&&(a.options.rPP=v)})}c=
b.bootstrap.on;d=b.curPage>=b.totalPages;e(c,this.next,d);e(c,this.last,d);d=1>=b.curPage;e(c,this.first,d);e(c,this.prev,d);this.page.val(b.curPage);this.$total.text(b.totalPages);0<this.options.totalRecords?(c=b.rPP,d=b.curPage,h=b.totalRecords,g=d*c,g>h&&(g=h),b=b.strDisplay,b=b.replace("{0}",(d-1)*c+1),b=b.replace("{1}",g),b=b.replace("{2}",h),this.$msg.html(b)):this.$msg.html("")};c._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()};c._setOption=function(a,b){if("curPage"==
a||"totalPages"==a)b=parseInt(b);this._super.call(this,a,b)};c._setOptions=function(){this._super.apply(this,arguments);this._refresh()};f.widget("paramquery.pqPager",c);f.paramquery.pqPager.regional={};f.paramquery.pqPager.regional.en=c._regional})(jQuery);
(function(f){function k(c,a){return c?"<div class='"+a+"'></div>":"<div class='ui-icon ui-icon-"+a+"'></div>"}var m={options:{length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",bootstrap:{on:!1,slider:"btn btn-default",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",left:"glyphicon glyphicon-chevron-left",right:"glyphicon glyphicon-chevron-right"},theme:!1},_destroy:function(){f(document).off("."+this.eventNamespace);this.element.removeClass("pq-sb pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty();
this.element.removeData()},_create:function(){this._createLayout()},_createLayout:function(){var c=this,a=this.options,b=a.bootstrap,d=b.on,e=a.direction,h=this.eventNamespace,g=a.theme,q=this.element.empty();"vertical"==e?(q.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb pq-sb-vert"),g?(q.addClass("pq-sb-vert-t"),q[0].innerHTML=["<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'>",k(d,d?b.up:"triangle-1-n"),"</div><div class='pq-sb-slider ui-corner-all ui-state-default ",d?
b.slider:"","'></div><div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'>",k(d,d?b.down:"triangle-1-s"),"</div>"].join("")):(q.addClass("pq-sb-vert-wt"),q[0].innerHTML="<div class='top-btn pq-sb-btn'></div><div class='pq-sb-slider'><div class='vert-slider-top'></div><div class='vert-slider-bg'></div><div class='vert-slider-center'></div><div class='vert-slider-bg'></div><div class='vert-slider-bottom'></div></div><div class='bottom-btn pq-sb-btn'></div>")):(q.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb pq-sb-horiz"),
g?(q.addClass("pq-sb-horiz-t"),q[0].innerHTML=["<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'>",k(d,d?b.left:"triangle-1-w"),"</div><div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all ",d?b.slider:"","'></div><div class='right-btn pq-sb-btn ui-state-default ui-corner-right'>",k(d,d?b.right:"triangle-1-e"),"</div>"].join("")):(q.addClass("pq-sb-horiz-wt"),q.width(this.width),q[0].innerHTML="<div class='left-btn pq-sb-btn'></div><div class='pq-sb-slider pq-sb-slider-h'><span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span></div><div class='right-btn pq-sb-btn'></div>"));
q.disableSelection().unbind(".pq-scrollbar").on("mousedown.pq-scrollbar",function(b){if(!a.disabled&&!c.$slider.is(":hidden"))if(f(document).off("."+h).on("mouseup."+h,function(p){c._mouseup(p)}),"vertical"==e){var d=b.pageY,p=c.element.offset().top,v=p+a.length,r=c.$slider,t=r.offset().top,s=r.height(),r=t+s;d<t&&d>p+17?c._setTimerPageLeft(d,s,b,0):d>r&&d<v-17&&c._setTimerPageRight(d,s,b,0)}else d=b.pageX,p=c.element.offset().left,v=p+a.length,t=c.$slider.offset().left,r=t+c.$slider.width(),d<t&&
d>p+17?(c.$slider.css("left",d-c.element.offset().left),c._updateCurPosAndTrigger(b)):d>r&&d<v-17&&(c.$slider.css("left",d-c.element.offset().left-c.$slider.width()),c._updateCurPosAndTrigger(b))});b=this.$slider=f("div.pq-sb-slider",this.element);b.attr("tabindex","0");this._bindSliderEvents(b);this.$top_btn=f("div.top-btn,div.left-btn",this.element).click(function(a){if(!c.options.disabled)return c.decr_cur_pos(a),a.preventDefault(),!1}).mousedown(function(a){c.options.disabled||(c.mousedownTimeout=
window.setTimeout(function(){c.mousedownInterval=window.setInterval(function(){c.decr_cur_pos(a)},0)},c.options.timeout))}).bind("mouseup mouseout",function(a){c._mouseup(a)});this.$bottom_btn=f("div.bottom-btn,div.right-btn",this.element).click(function(a){if(!c.options.disabled)return c.incr_cur_pos(a),a.preventDefault(),!1}).mousedown(function(a){c.options.disabled||(c.mousedownTimeout=window.setTimeout(function(){c.mousedownInterval=window.setInterval(function(){c.incr_cur_pos(a)},0)},c.options.timeout))}).bind("mouseup mouseout",
function(a){c._mouseup(a)});this.refresh()}},e=0;m._setTimerPageLeft=function(c,a,b,d){var l=this,h=l.options;this.mousedownTimeout=window.setTimeout(function(){if(c>=l.$slider.offset().top)l._mouseup();else{l._pageLeft(b);var d=e?0:h.timeout;e++;l._setTimerPageLeft(c,a,b,d)}},d)};m._setTimerPageRight=function(c,a,b,d){var l=this;this.mousedownTimeout=window.setTimeout(function(){if(c<=l.$slider.offset().top+a)l._mouseup();else{l._pageRight(b);var d=e?0:l.options.timeout;e++;l._setTimerPageRight(c,
a,b,d)}},d)};m._bindSliderEvents=function(c){var a=this,b="x";"vertical"==this.options.direction&&(b="y");c.draggable({axis:b,helper:function(b,c){a._setDragLimits();return this},start:function(b){a.topWhileDrag=null;a.dragging=!0},drag:function(b){a.dragging=!0;var c=a.options.pace;"optimum"==c?a._setNormalPace(b):"fast"==c&&a._updateCurPosAndTrigger(b)},stop:function(b){"fast"!=a.options.pace&&a._updateCurPosAndTrigger(b);a.dragging=!1;a.refresh()}}).on("keydown.pq-scrollbar",function(b){var c=
b.keyCode,e=a.options,g=e.cur_pos,q=e.ratio,n=e.num_eles,u=f.ui.keyCode;null==a.keydownTimeout&&(a.keydownTimeout=window.setTimeout(function(){c==u.DOWN||c==u.RIGHT?a.incr_cur_pos(b):c==u.UP||c==u.LEFT?a.decr_cur_pos(b):c==u.HOME?e.steps?0<g&&(e.cur_pos=0,a.updateSliderPos(),a.scroll(b)):0<q&&(e.ratio=0,a.updateSliderPos(),a.drag(b)):c==u.END?e.steps?g<n&&(e.cur_pos=n,a.updateSliderPos(),a.scroll(b)):1>q&&(e.ratio=1,a.updateSliderPos(),a.drag(b)):"vertical"==e.direction&&(c==u.PAGE_DOWN?a._pageRight(b):
c==u.PAGE_UP&&a._pageLeft(b));a.keydownTimeout=null},0));if(c==u.DOWN||c==u.RIGHT||c==u.UP||c==u.LEFT||c==u.PAGE_DOWN||c==u.PAGE_UP||c==u.HOME||c==u.END)return b.preventDefault(),!1})};m.decr_cur_pos=function(c){var a=this.options;if(a.steps)0<a.cur_pos&&(a.cur_pos--,this.updateSliderPos(),this.scroll(c));else if(0<a.ratio){var b=a.ratio-1/(a.num_eles-1);0>b&&(b=0);a.ratio=b;this.updateSliderPos();this.drag(c)}};m.incr_cur_pos=function(c){var a=this.options;if(a.steps)a.cur_pos<a.num_eles-1&&a.cur_pos++,
this.updateSliderPos(),this.scroll(c);else{if(1>a.ratio){var b=a.ratio+1/(a.num_eles-1);1<b&&(b=1);a.ratio=b}this.updateSliderPos();this.drag(c)}};m._mouseup=function(c){this.options.disabled||(e=0,window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),this.mousedownInterval=null)};m._setDragLimits=function(){var c=this.options;if("vertical"==c.direction){var a=this.element.offset().top+17,c=a+c.length-34-this.slider_length;this.$slider.draggable("option",
"containment",[0,a,0,c])}else a=this.element.offset().left+17,c=a+c.length-34-this.slider_length,this.$slider.draggable("option","containment",[a,0,c,0])};m.refresh=function(){var c=this.options,a=this.element;1>=c.num_eles?a.css("display","none"):(a.css("display",""),this._validateCurPos(),this.dragging||(a["vertical"===c.direction?"height":"width"](c.length),this._setSliderBgLength(),4>this.scroll_space||1>=c.num_eles?this.$slider.css("display","none"):this.$slider.css("display","")),this.updateSliderPos())};
m._setSliderBgLength=function(){var c=this.options,a=c.theme,b=this.$slider,d=c.length,d=Math.round(((d-34)*d/(40*c.num_eles+d)-14)/2);1>d&&(d=1);var e=14+2*d;this.scroll_space=c.length-34-e;if(e!==this.slider_length)if(this.slider_length=e,c="vertical"===c.direction?{dim:"height",cls:".vert-slider-bg"}:{dim:"width",cls:".horiz-slider-bg"},a)b[c.dim](e-2);else f(c.cls,this.element)[c.dim](d),b[c.dim](e)};m._updateCurPosAndTrigger=function(c,a){var b=this.options,d=b.direction,e=this.$slider;null==
a&&(a=parseInt(e[0].style["vertical"===d?"top":"left"]));d=(a-17)/(b.length-34-this.slider_length);if(b.steps){if(d*=b.num_eles-1,d=Math.round(d),b.cur_pos!=d){if(this.dragging){if(null!=this.topWhileDrag&&(this.topWhileDrag<a&&b.cur_pos>d||this.topWhileDrag>a&&b.cur_pos<d))return;this.topWhileDrag=a}this.options.cur_pos=d;this.scroll(c)}}else b.ratio=d,this.drag(c)};m._setNormalPace=function(c){this.timer&&(window.clearInterval(this.timer),this.timer=null);var a=this,b=this.options.direction;a.timer=
window.setInterval(function(){var d=parseInt(a.$slider[0].style["vertical"===b?"top":"left"]);a.prev_top===d&&(a._updateCurPosAndTrigger(c,d),window.clearInterval(a.timer),a.timer=null);a.prev_top=d},20)};m._validateCurPos=function(){var c=this.options;c.cur_pos>=c.num_eles&&(c.cur_pos=c.num_eles-1);0>c.cur_pos&&(c.cur_pos=0)};m._updateSliderPosRatio=function(){var c=this.options,a=c.direction,b=c.ratio,d=this.$slider,c=c.length-34-this.slider_length;if(null==b)throw"updateSliderPosRatio ratio N/A";
b=b*c+17;"vertical"==a?d.css("top",b):d.css("left",b)};m._updateSliderPosCurPos=function(){var c=this.options,a=this.scroll_space*c.cur_pos/(c.num_eles-1);"vertical"==c.direction?this.$slider.css("top",17+a):this.$slider.css("left",17+a)};m.updateSliderPos=function(){var c=this.options;if(void 0===c.steps)throw"updateSliderPos. steps N/A";c.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()};m.scroll=function(c){var a=this.options;this._trigger("scroll",c,{cur_pos:a.cur_pos,num_eles:a.num_eles})};
m.drag=function(c){this._trigger("drag",c,{ratio:this.options.ratio})};m._pageRight=function(c){this._trigger("pageRight",c,null)};m._pageLeft=function(c){this._trigger("pageLeft",c,null)};m._setOption=function(c,a){"disabled"==c?(this._super(c,a),!0==a?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==c?(this._super(c,a),this._createLayout()):"ratio"==c?0<=a&&1>=a&&this._super(c,a):this._super(c,a)};m._setOptions=function(){this._super.apply(this,arguments);this.refresh()};
f.widget("paramquery.pqScrollBar",m)})(jQuery);
(function(f){f.paramquery=f.paramquery||{};f.paramquery.onResize=function(k,m){var e=f(k);"static"===e.css("position")&&e.css("position","relative");var c=f('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(e);c[0].data="about:blank";c.css("opacity","0");for(var a=0;a<e.length;a++)f(c[a].contentWindow).on("resize",function(a){m()})}})(jQuery);
(function(f){function k(p){return"<span class='panel panel-default glyphicon glyphicon-"+p+"' ></span>"}function m(p){return"<span class='ui-widget-header pq-ui-button'><span class='ui-icon ui-icon-"+p+"'></span></span>"}function e(p,a,b){var d=b.attr({rowIndxPage:p,colIndx:a,attr:"rowspan"}).attr,c=b.attr({rowIndxPage:p,colIndx:a,attr:"colspan"}).attr;return 1<d||1<c?{rowspan:d,colspan:c}:(p=b.attr({rowIndxPage:p,colIndx:a,attr:"style"}).attr)&&"none"==p.display?!0:!1}function c(p){var a=p.that,
b=p.rowIndx;if(p.select&&b<=a.initV||b>a.pdata.length)return p;p=p.colIndx;var d=a.attr({rowIndx:b,colIndx:p,attr:"data-ref"}).attr;return d&&null!=d.rowIndx?c({rowIndx:d.rowIndx,colIndx:p,that:a}):{rowIndx:b,colIndx:p}}var a=function(){};a.prototype.belongs=function(p){if(p.target==this.that.element[0])return!0};f.paramquery.cClass=a;var b=function(p){this.that=p;var a=this.options=p.options,b=this;this.offset=null;if(null!=a.postRenderInterval){var a=p.widgetEventPrefix.toLowerCase(),d=p.eventNamespace;
p.element.on(a+"refresh"+d,function(p){b.belongs(p)&&b.postRenderAll()}).on(a+"refreshrow"+d,function(p,a){b.belongs(p)&&b.postRenderRow(a)})}};f.paramquery.cGenerateView=b;a=b.prototype=new a;a.generateView=function(p){p=p||{};var a=this.that,b=a.options,d=b.scrollModel.smooth,c="flex"===b.width,e="flex"===b.height,l=b.cls,h=l.cont_inner,l=l.cont_inner_b,g,q,n=a.initH,u=a.finalH,m=b.groupModel,k=a.pqpanes;if(p.$cont)g=this._generateTables(null,null,p),g=g.replace("%style%",""),m=p.$cont,m.empty(),
m[0].innerHTML=k.v?["<div class='",h,"'>",g,"</div><div class='",h,"'>",g,"</div>"].join(""):["<div class='",h,"'>",g,"</div>"].join(""),b=m.children("div").children("table"),a.tables[0]={$tbl:b,$cont:m};else{g=a.initV;q=a.finalV;var G=m?a.dataGM:a.pdata,m=a.$cont;null!=b.editModel.indices&&a.blurEditor({force:!0});n={pageData:G,initV:g,finalV:q,initH:n,finalH:u,source:p.source};a._trigger("beforeTableView",null,n);g=this._generateTables(g,q,p);m.empty();0===a.totalVisibleRows?m.append("<div class='"+
h+" pq-grid-norows' >"+b.strNoRows+"</div>"):(p=e||c?"style='position:relative;'":"",c="",b.virtualY&&d&&(c="style='"+a.iMouseSelection.getBorderStyle(!0)+"'"),g=g.replace("%style%",c),m[0].innerHTML=k.h&&k.v?["<div class='",h,"'>",g,"</div><div class='",h,"'>",g,"</div><div class='",h," ",l,"'>",g,"</div><div class='",h," ",l,"'>",g,"</div>"].join(""):k.v?["<div class='",h,"' ",p," >",g,"</div><div class='",h,"' >",g,"</div>"].join(""):k.h?["<div class='",h,"' style='position:static;' >",g,"</div><div class='",
h," ",l,"' style='position:static;' >",g,"</div>"].join(""):["<div class='",h,"' ",p," >",g,"</div>"].join(""));a.$tbl=m.children("div").children("table");if(b.scrollModel.flexContent&&a.$tbl[0])f.paramquery.onResize(a.$tbl[0],function(){var p=a.iRefresh;p.ignoreTResize||p.softRefresh()});this.setPaneEvents();a._trigger("refresh",null,n)}this.setPanes()};a.postRenderRow=function(p){for(var a=this.that,b=a.colModel,d=a.finalH,c,e=a.initH;e<=d;e++){var h=b[e];!h.hidden&&(c=h.postRender)&&(p.dataIndx=
h.dataIndx,p.$cell=a.getCell(p),c.call(a.element[0],p))}};a.setTimerPostRender=function(p,a,b){var d=this.that,c=this;c.postRenderTimeoutID=function(p){return-1==d.options.postRenderInterval?p():window.setTimeout(p,0)}(function(){c.postRenderRow({rowData:p[a],rowIndxPage:a});a++;a<=b&&c.setTimerPostRender(p,a,b)})};a.postRenderAll=function(){var p=this.that,a=this,b=p.initV,d=p.pdata,c=p.finalV,e=p.options.postRenderInterval;window.clearTimeout(a.postRenderTimeoutID);a.postRenderTimeoutID=function(p){return-1==
e?p():window.setTimeout(p,e)}(function(){a.setTimerPostRender(d,b,c)})};a.scrollView=function(){var p=this.that,a=this.options,b=a.virtualY;a.virtualX||"flex"===a.width||p.$hscroll.pqScrollBar("drag");b||p.$vscroll.pqScrollBar("drag")};a.setPaneEvents=function(){var p=this.that,a=p.pqpanes,b=p.$cont.children("div"),d=p.iMouseSelection;if((p=p.$tbl)&&p.length)if(a.h&&a.v){var a=f(b[0]),p=f(b[1]),c=f(b[2]),b=f(b[3]);a.on("scroll",function(p){this.scrollLeft=this.scrollTop=0});p.on("scroll",function(p){this.scrollTop=
0;this.scrollLeft=d.getScrollLeft(!0)});c.on("scroll",function(p){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=0});b.on("scroll",function(p){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)})}else if(a.v)a=f(b[0]),b=f(b[1]),a.on("scroll",function(p){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=0}),b.on("scroll",function(p){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)});else if(a.h)a=f(b[0]),b=f(b[1]),a.on("scroll",function(p){this.scrollTop=
0;this.scrollLeft=d.getScrollLeft(!0)}),b.on("scroll",function(p){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)});else b.on("scroll",function(p){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)})};a.setPanes=function(){var p=this.that,a=p.pqpanes,b=p.$cont.children("div"),d=p.iRefresh,c=p.$tbl,e=p.options,h=parseInt(e.freezeCols),l=p.initH,g=u.call(p,-1,h)+1,q="flex"===e.width?"":d.getEContWd();if(p.tables.length){var n=p.tables[0].$tbl,m=p.tables[0].$cont,
k=n.parent("div");a.v?(f(k[0]).css({width:g}),f(k[1]).css({left:g,width:q-g}),f(n[1]).css({left:-1*g})):f(k[0]).css({width:q});m.height(n[0].scrollHeight-1);d.setContHeight()}if(c&&c.length)if(d=d.getEContHt(),a.h&&a.v){var h=f(b[0]),l=f(b[1]),n=f(c[1]),m=f(b[2]),k=f(c[2]),b=f(b[3]),C=f(c[3]),c=p.calcHeightFrozenRows();h.css({width:g,height:c});l.css({left:g,width:q-g,height:c});n.css({left:-1*g});m.css({width:g,top:c,height:d-c});k.css({marginTop:-(c+1)});b.css({left:g,width:q-g,top:c,height:d-c});
C.css({marginTop:-(c+1),left:-1*g})}else a.v?(n=f(b[0]),b=f(b[1]),c=f(c[1]),u.call(p,h,l),n.css({width:g,height:d}),b.css({left:g,width:q-g,height:d}),c.css({left:-1*g})):a.h?(h=f(b[0]),b=f(b[1]),l=f(c[1]),c=p.calcHeightFrozenRows(),h.css({height:c,width:q}),b.css({width:q,top:c,height:d-c}),l.css({marginTop:-(c+1)})):b.css({width:q,height:d});e.showHeader&&(a.vH?(p.$header_left.css({width:g}),p.$header_right.css({left:g,width:q-g}),p.$header_right_inner.css({left:-g})):p.$header_left.css({width:q}))};
a._generateTables=function(p,a,b){b=b||{};var d=this.that,c=d.colModel,e=d.options,h=e.bootstrap,l=e.virtualX,g=d.initH,f=d.finalH,q=e.numberCell,n=e.columnBorders,u=e.rowBorders,m=e.wrap,k=e.groupModel,D=e.freezeCols,e=parseInt(e.freezeRows),H=!1,I=0,M=b.other;a=M?b.data.length-1:a;var K=k?!0:!1;b=M?b.data:K?d.dataGM:d.pdata;var P=d.rowIndxOffset;if(M||null!=p&&null!=a){H=(h.on?h.tbody:"")+" pq-grid-table ";n&&(H+="pq-td-border-right ");u&&(H+="pq-td-border-bottom ");n=["<table %style% class='"+
(m?H+"pq-wrap ":H+"pq-no-wrap ")+"' >"];n.push("<tr class='pq-row-hidden'>");q.show&&(I=q.width,n.push("<td style='width:"+I+"px;' ></td>"));for(H=0;H<=f;H++){if(H<g&&H>=D&&(l||M)&&(H=g,H>f))throw"initH>finalH";I=c[H];I.hidden||(I=I.outerWidth,n.push("<td style='width:",I,"px;' pq-col-indx='",H,"'></td>"))}n.push("</tr>");this.offsetRow=null;for(I=0;I<=a;I++)I<p&&I>=e&&(I=p),l=b[I],g=K?l.rowIndx-P:I,l&&l.pq_hidden||(H=d.lastFrozenRow===g,k&&null!=l.groupTitle?this._generateTitleRow(k,l,n,H):k&&l.groupSummary?
this._generateSummaryRow(k,l,c,n,H):(f=l.pq_detail&&l.pq_detail.show,this._generateRow(l,g,c,n,M,H,f),f&&this._generateDetailRow(l,g,c,n,M,H)));d.scrollMode=!1;n.push("</table>");return n.join("")}};a.readCell=function(p,a){var b=a.dataIndx;if(a.nested){for(var d=p,b=b.split("."),c=0,e=b.length;c<e&&(d=d[b[c]],d);c++);return d}return p[b]};a.saveCell=function(p,a,b){var d=a.dataIndx;if(a.nested){a=d.split(".");for(var d=p,c=0,e=a.length;c<e;c++){var l=a[c];c==e-1?d[l]=b:d=p[l]=p[l]||{}}}else p[d]=
b};a._renderCell=function(p,a){var b=this.options,d=p.rowData,c=p.column,e=c.type,c=this.readCell(d,c);if(d){void 0!=a?b=a:"checkBoxSelection"==e?b="<input type='checkbox' "+(c?"checked='checked'":"")+" />":"detail"==e?(b=b.detailModel,b="<div class='ui-icon "+(c&&c.show?b.expandIcon:b.collapseIcon)+"'></div>"):b=c;if(""===b||void 0==b)b="&nbsp;";return b}};a.renderCell=function(p){var a=this.that,b=this.options,d=p.rowData,c=p.rowIndx,e=p.rowIndxPage,l=p.column,h=p.colIndx,g=l.dataIndx,f=b.freezeCols,
n=b.columnBorders,u="pq-col-indx='"+h+"'",m=!1,k="pq-grid-cell ";"right"==l.align?k+=" pq-align-right":"center"==l.align&&(k+=" pq-align-center");h==f-1&&n&&(k+=" pq-last-frozen-col");(f=l.cls)&&(k=k+" "+f);(f=d.pq_cellselect)&&(m=f[g]);m&&(k+=" pq-state-select ui-state-highlight");var G;l.render&&(G=l.render.call(a.element[0],{data:a.pdata,dataModel:b.dataModel,rowData:d,cellData:d[g],rowIndxPage:e,rowIndx:c,colIndx:h,column:l,dataIndx:g}));(b=d.pq_cellcls)&&(b=b[g])&&(k+=" "+b);if(d=d.pq_cellattr)if(g=
d[g]){var a=q(g,a.initV==e),D;for(D in a)u+=" "+D+'="'+a[D]+'"'}return["<td class='",k,"' ",u," >",this._renderCell(p,G),"</td>"].join("")};a.refreshRow=function(p,a,b){var d=this.that,c=d.pdata[p];this._generateRow(c,p,a,b,null,d.lastFrozenRow===p,c.pq_detail&&c.pq_detail.show)};a._generateRow=function(p,a,b,d,c,e,l){var h="pq-grid-row";e&&(h+=" pq-last-frozen-row");l&&(h+=" pq-detail-master");var g=this.that,f=this.options,n=f.rowInit;e=f.freezeCols;var u=f.numberCell;l=f.virtualX;var k=g.initH,
m=g.finalH,G=this.offset;n&&n.call(g.element[0],{rowData:p,rowIndx:a+G});f.stripeRows&&a/2==parseInt(a/2)&&(h+=" pq-grid-oddRow");p.pq_rowselect&&(h+=" pq-row-select ui-state-highlight");g=p.pq_rowcls;null!=g&&(h+=" "+g);f=p.pq_rowattr;g="";if(f){var f=q(f),D;for(D in f)g+=" "+D+'="'+f[D]+'"'}d.push("<tr pq-row-indx='",a,"' class='",h,"' ",g," >");u.show&&d.push(["<td pq-col-indx='-1' class='pq-grid-number-cell ui-state-default'>",c?"&nbsp;":a+1,"</td>"].join(""));p={rowIndx:a+G,rowIndxPage:a,rowData:p};
for(a=0;a<=m;a++)l&&a<k&&a>=e&&(a=k),c=b[a],c.hidden||(p.column=c,p.colIndx=a,p.tree=!1,d.push(this.renderCell(p)));d.push("</tr>");return d};a={widgetEventPrefix:"pqgrid"};a.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",bootstrap:{on:!1,thead:"table table-striped table-condensed table-bordered",tbody:"table table-striped table-condensed table-bordered",grid:"panel panel-default"},distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,
css:{zIndex:1E3}},colModel:null,columnBorders:!0,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:f.ui.keyCode.ENTER,onSave:"next",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",
validate:!0},editor:{select:!1,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,
rowHeight:25,scrollModel:{pace:"fast",smooth:!1,horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!1},selectionModel:{fireSelectChange:!1,type:"cell",mode:"block"},swipeModel:{on:!0,speed:20,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0};a._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",
strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"};f.extend(a.options,a._regional);a._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")};a._disable=function(){null==this.$disable&&(this.$disable=f("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))};a._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),
this.$disable=null)};a._destroy=function(){this.loading&&this.xhr.abort();this._destroyResizable();this._destroyDraggable();this._mouseDestroy();this.element.off(this.eventNamespace);f(window).unbind(this.eventNamespace);f(document).unbind(this.eventNamespace);this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()};a.destroy=function(){this._trigger("destroy");this._super();window.clearInterval(this._refreshEditorPosTimer);
this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout);for(var p in this)delete this[p];f.fragments={}};a.collapse=function(p){var a=this,b=this.element,d=this.options.collapsible,c=d.$collapse.children("span"),e=function(){b.css("overflow","hidden");c.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n");b.hasClass("ui-resizable")&&b.resizable("destroy");a.$toolbar.pqToolbar("disable");d.collapsed=!0;d._collapsed=!0;d.animating=!1;a._trigger("collapse")};p=p?p:{};if(d._collapsed)return!1;
d.htCapture=b.height();!1===p.animate?(b.height(23),e()):(d.animating=!0,b.animate({height:"23px"},function(){e()}))};a.expand=function(p){var a=this,b=this.element,d=this.options.collapsible,c=d.htCapture,e=d.$collapse.children("span"),l=function(){b.css("overflow","");d._collapsed=!1;d.collapsed=!1;a._refreshResizable();d.refreshAfterExpand&&a.refresh();e.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s");a.$toolbar.pqToolbar("enable");d.animating=!1;a._trigger("expand")};
p=p?p:{};if(!1===d._collapsed)return!1;!1===p.animate?(b.height(c),l()):(d.animating=!0,b.animate({height:c},function(){l()}))};a._createCollapse=function(){var p=this,a=this.$top,b=this.options,d=b.collapsible;d.$stripe||(a=f("<div class='pq-slider-icon pq-no-capture'  ></div>").appendTo(a),d.$stripe=a);d.on?d.$collapse||(d.$collapse=f(b.bootstrap.on?k("collapse-down"):m("circle-triangle-n")).appendTo(d.$stripe).click(function(a){d.collapsed?p.expand():p.collapse()})):d.$collapse&&(d.$collapse.remove(),
delete d.$collapse);d.collapsed&&!d._collapsed?p.collapse({animate:!1}):!d.collapsed&&d._collapsed&&p.expand({animate:!1});d.toggle?d.$toggle||(d.$toggle=f(b.bootstrap.on?k("fullscreen"):m("arrow-4-diag")).prependTo(d.$stripe).click(function(a){p.toggle()})):d.$toggle&&(d.$toggle.remove(),delete d.$toggle)};a._create=function(){var a=this,v=this.options,d=v.dataModel,c=v.bootstrap,e=v.sortModel;v.collapsible||(v.collapsible={on:!1,collapsed:!1});v.flexHeight&&(v.height="flex");v.flexWidth&&(v.width=
"flex");if(d.sortIndx){e.on=v.sortable;e.type=d.sorting;var l=[],g=d.sortIndx,d=d.sortDir;if(f.isArray(g)){for(var q=0;q<g.length;q++){var u=d&&d[q]?d[q]:"up";l.push({dataIndx:g[q],dir:u})}e.single=!1}else l.push({dataIndx:g,dir:d?d:"up"}),e.single=!0;e.sorter=l}!1===v.virtualXHeader&&(v.virtualXHeader=null);this.setEditorPosTimer();this.iGenerateView=new b(this);this.iRefresh=new f.paramquery.cRefresh(this);this.iKeyNav=new n(this);this.iIsValid=new h(this);this.hidearrHS=[];this.tables=[];this.$tbl=
null;this._calcThisColModel();this.iSort=new f.paramquery.cSort(this);this.iHeader=new f.paramquery.cHeader(this);this._initTypeColumns();e=this.element;e.on("scroll"+this.eventNamespace,function(){this.scrollTop=this.scrollLeft=0});e.empty().addClass("pq-grid ui-widget ui-widget-content "+(c.on?c.grid:"")+" "+(v.roundCorners?" ui-corner-all":"")).html(["<div class='pq-grid-top ui-widget-header",v.roundCorners?" ui-corner-top":"","'><div class='pq-grid-title",v.roundCorners?" ui-corner-top":"","'>&nbsp;</div></div><div class='pq-grid-center' ><div class='pq-header-outer ui-widget-header'></div><div class='pq-grid-cont-outer' ><div class='pq-grid-cont' tabindex='0'></div></div></div><div class='pq-grid-bottom ui-widget-header",
v.roundCorners?" ui-corner-bottom":"","'><div class='pq-grid-footer'>&nbsp;</div></div>"].join(""));this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});this.$top=f("div.pq-grid-top",e);v.showTop||this.$top.css("display","none");this.$title=f("div.pq-grid-title",e);v.showTitle||this.$title.css("display","none");this.$toolbar=f("div.pq-grid-toolbar",e);c=this.$grid_center=f("div.pq-grid-center",e).on("scroll",function(){this.scrollTop=0});this.$header_o=f("div.pq-header-outer",
this.$grid_center).on("scroll",function(){this.scrollLeft=this.scrollTop=0});this.$bottom=f("div.pq-grid-bottom",e);this.$footer=f("div.pq-grid-footer",e);this.$cont_o=f(".pq-grid-cont-outer",c);e=this.$cont=f("div.pq-grid-cont",c);f(window).bind("resize"+a.eventNamespace+" orientationchange"+a.eventNamespace,function(b,v){a.onWindowResize(b,v)});e.on("click",".pq-grid-cell,.pq-grid-number-cell",function(b){if(!0!==f.data(b.target,a.widgetName+".preventClickEvent")&&f(b.target).closest(".pq-grid")[0]==
a.element[0])return a._onClickCell(b)});e.on("click","tr.pq-grid-row",function(b){if(!0!==f.data(b.target,a.widgetName+".preventClickEvent")&&f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onClickRow(b)});e.on("contextmenu","td.pq-grid-cell",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRightClickCell(b)});e.on("contextmenu","tr.pq-grid-row",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRightClickRow(b)});e.on("dblclick","td.pq-grid-cell",
function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onDblClickCell(b)});e.on("dblclick","tr.pq-grid-row",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onDblClickRow(b)});e.on("mousedown","td.pq-grid-cell",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onCellMouseDown(b)});e.on("mousedown","tr.pq-grid-row",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRowMouseDown(b)});e.on("mousedown",function(b){if(f(b.target).closest(".pq-grid")[0]==
a.element[0])return a._onContMouseDown(b)});e.on("mouseenter","td.pq-grid-cell",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onCellMouseEnter(b,f(this))});e.on("mouseenter","tr.pq-grid-row",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRowMouseEnter(b,f(this))});e.on("mouseleave","td.pq-grid-cell",function(b){if(f(b.target).closest(".pq-grid")[0]==a.element[0])return a._onCellMouseLeave(b,f(this))});e.on("mouseleave","tr.pq-grid-row",function(b){if(f(b.target).closest(".pq-grid")[0]==
a.element[0])return a._onRowMouseLeave(b,f(this))});c.bind("mousewheel DOMMouseScroll",function(b){return a._onMouseWheel(b)});this.$hvscroll=f("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(c);this.$vscroll=f("<div class='pq-vscroll'></div>").appendTo(c);this.prevVScroll=0;e=v.scrollModel;void 0===e.lastColumn&&v.virtualX&&(e.lastColumn="auto");this.$vscroll.pqScrollBar({pace:e.pace,theme:e.theme,bootstrap:v.bootstrap,steps:v.virtualY&&!e.smooth,direction:"vertical",cur_pos:0,
pageRight:function(){a.iKeyNav.pageDown()},pageLeft:function(){a.iKeyNav.pageUp()},drag:function(b,v){a.iMouseSelection.syncViewWithScrollBarVert(v.ratio)},scroll:function(b,v){a.iRefresh.refreshVscroll(v)}});l=this.$hscroll=f("<div class='pq-hscroll'></div>").appendTo(c);"flex"===v.height&&l.css("position","relative");l.pqScrollBar({direction:"horizontal",pace:e.pace,bootstrap:v.bootstrap,theme:e.theme,steps:v.virtualX&&!e.smooth,cur_pos:0,drag:function(b,v){a.iMouseSelection.syncViewWithScrollBarHor(v.ratio)},
scroll:function(b,d){var c=!1===v.virtualXHeader?!1:!0;v.virtualX&&!v.scrollModel.smooth&&a.refresh({header:c})}});v.selectionModel["native"]||this.disableSelection();c.bind("keydown.pq-grid",function(b){f(b.target).closest(".pq-grid")[0]==a.element[0]&&a._onKeyPressDown(b)});this._refreshTitle();this.iRows=new f.paramquery.cRows(this);this.iCells=new f.paramquery.cCells(this);this.generateLoading();this._initPager();this._refreshResizable();this._refreshDraggable();this.iResizeColumns=new f.paramquery.cResizeColumns(this);
this._mouseInit()};a.toggle=function(){var a=this.options,b=a.collapsible,d=this.element,c,e=this._maxim;c=e?"min":"max";var l=f(document.body);if(!1===this._trigger("beforeToggle",null,{state:c}))return!1;"min"==c?(a=e.eleObj,b=e.docObj,this.option({height:a.height,width:a.width,maxHeight:a.maxHeight}),d.css({position:a.position,left:a.left,top:a.top,margin:a.margin,zIndex:a.zIndex}),l.css({height:"",width:"",overflow:b.overflow}),f("html").css({overflow:"visible"}),window.scrollTo(b.scrollLeft,
b.scrollTop),this._maxim=null):(a={height:a.height,width:a.width,position:d.css("position"),left:d.css("left"),top:d.css("top"),margin:d.css("margin"),zIndex:d.css("zIndex"),maxHeight:a.maxHeight},this.option({height:"100%",width:"100%",maxHeight:null}),d.css(f.extend({position:"fixed",left:0,top:0,margin:0},b.css)),b={height:l.height(),width:l.width(),overflow:l.css("overflow"),scrollLeft:f(window).scrollLeft(),scrollTop:f(window).scrollTop()},f(document.body).css({height:0,width:0,overflow:"hidden"}),
f("html").css({overflow:"hidden"}),window.scrollTo(0,0),this._maxim={eleObj:a,docObj:b});this._trigger("toggle",null,{state:c});this._refreshResizable();this.refresh();f(window).trigger("resize",{$grid:d,state:c})};a._mouseCapture=function(a){var b=this.options;return b.virtualX&&b.virtualY&&!b.scrollModel.smooth||!a.target?!1:f(a.target).closest(".pq-grid")[0]==this.element[0]?(a=b.swipeModel,!1==a.on||"touch"==a.on&&!f.support.touch?!1:!0):!1};a._saveDims=function(){var a=this.$tbl;if(a)for(var b=
0;b<a.length;b++){var d=a[b],c=f(d);c.data("offsetHeight",Math.round(d.offsetHeight)-1);c.data("scrollWidth",Math.round(d.scrollWidth))}if(a=this.$tbl_header)for(b=0;b<a.length;b++)d=a[b],c=f(d).parent(),c.data("offsetHeight",Math.round(d.offsetHeight)),c.data("scrollWidth",Math.round(d.scrollWidth))};a._mousePQUp=function(a){f(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate);this._trigger("mousePQUp",a,null)};a._mouseDown=function(a){var b=this;if(f(a.target).closest(".pq-editor-focus").length)this._blurEditMode=
!0,window.setTimeout(function(){b._blurEditMode=!1},0);else return this._saveDims(),this._mousePQUpDelegate=function(a){return b._mousePQUp(a)},f(document).bind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._super(a)};a._mouseStart=function(a){this.blurEditor({force:!0});return!0};a._mouseDrag=function(a){return!1==this._trigger("mouseDrag",a,null)?!1:!0};a._mouseStop=function(a){return!1==this._trigger("mouseStop",a,null)?!1:!0};var d,l;a.onWindowResize=function(a,b){var c=this.options,
e=this.element,h=e.parent();if(b){var g=b.$grid;if(g&&(g==e||0==e.closest(g).length))return}if(h.length&&(h[0]==document.body||"fixed"==e.css("position")?(e=window.innerHeight?window.innerHeight:f(window).height(),h=f(window).width()):(e=h.height(),h=h.width()),null==d||e!=d||h!=l)&&(d=e,l=h,!(f.support.touch&&c.editModel.indices&&f(document.activeElement).is(".pq-editor-focus")))){var q=this,c=c.autoSizeInterval,c=void 0===c?0:c;this.autoResizeTimeout&&(clearTimeout(this.autoResizeTimeout),delete this.autoResizeTimeout);
this.autoResizeTimeout=window.setTimeout(function(){q._refreshAfterResize();delete q.autoResizeTimeout},c)}};a._onMouseWheel=function(a){this._saveDims();var b=this.options,d=0,c=!1;a=a.originalEvent;var e=a.wheelDeltaX,l=a.wheelDeltaY,h=a.wheelDelta;if(e&&Math.abs(e)>Math.abs(l)){if("flex"==b.width)return!0;c=!0;d=e/120}else if(h){if(!this.iRefresh.vscroll)return!0;d=h/120}else if(a.detail){if(!this.iRefresh.vscroll)return!0;d=-1*a.detail/3}a=c?this.$hscroll:this.$vscroll;h=a.pqScrollBar("option");
l=parseInt(h.cur_pos);e=parseInt(h.num_eles);if(!b.scrollModel.smooth&&(c&&b.virtualX||!c&&b.virtualY)){d=0<d?Math[1>d?"ceil":"floor"](d):Math[-1>d?"ceil":"floor"](d);b=l-d;0>b?b=0:b>e-1&&(b=e-1);if(b==l)return!0;a.pqScrollBar("option","cur_pos",l-d);a.pqScrollBar("scroll")}else{b=h.ratio;d=b-d/(e-1);1<d?d=1:0>d&&(d=0);if(b==d)return!0;a.pqScrollBar("option","ratio",d);a.pqScrollBar("drag")}return!1};a._onDblClickCell=function(a){var b=f(a.currentTarget),d=this.getCellIndices({$td:b}),c=d.rowIndxPage,
e=c+this.rowIndxOffset,d=d.colIndx;if(null!=d){if(!1==this._trigger("cellDblClick",a,{$td:b,rowIndxPage:c,rowIndx:e,colIndx:d,column:this.colModel[d],rowData:this.pdata[c]}))return!1;1<this.options.editModel.clicksToEdit&&this.isEditableRow({rowIndx:e})&&this.isEditableCell({colIndx:d,rowIndx:e})&&this.editCell({rowIndxPage:c,colIndx:d})}};a._onClickCont=function(a){};a._onClickRow=function(a){var b=f(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),c=d+this.rowIndxOffset;if(!isNaN(d)&&!1==this._trigger("rowClick",
a,{$tr:b,rowIndxPage:d,rowIndx:c,rowData:this.pdata[d]}))return!1};a._onRightClickRow=function(a){var b=f(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),c=d+this.rowIndxOffset;if(!isNaN(d)&&!1==this._trigger("rowRightClick",a,{$tr:b,rowIndxPage:d,rowIndx:c,rowData:this.pdata[d]}))return!1};a._onDblClickRow=function(a){var b=f(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),c=this.getRowIndxOffset();if(!1==this._trigger("rowDblClick",a,{$tr:b,rowIndxPage:d,rowIndx:d+c,rowData:this.pdata[d]}))return!1};
f.paramquery.getValueFromDataType=function(a,b,d){if("date"==b)return b=Date.parse(a),isNaN(b)?"":d?b:a;if("integer"==b)b=parseInt(a);else if("float"==b)b=parseFloat(a);else return"bool"==b?(b=f.trim(a).toLowerCase(),0==b.length?null:"true"==b||"yes"==b||"1"==b?!0:"false"==b||"no"==b||"0"==b?!1:Boolean(b)):f.trim(a);return isNaN(b)||null==b?null==a?a:null:b};var h=function(a){this.that=a},g=h.prototype;g._isValidCell=function(a){var b=this.that,d=a.column,c=d.validations;if(!c||!c.length)return{valid:!0};
var e=a.value,l=d.dataType,h=function(a){return f.paramquery.getValueFromDataType(a,l,!0)};a=a.rowData;if(!a)throw"rowData required.";for(var g=0;g<c.length;g++){var q=c[g],n=q.type,u=!1,k=q.msg,m=q.value;if(!1!==q.on&&(null==e&&"function"!=typeof n?u=!1:"minLen"==n?(e=h(e),m=h(m),e.length>=m&&(u=!0)):"nonEmpty"==n?null!=e&&""!==e&&(u=!0):"maxLen"==n?(e=h(e),m=h(m),e.length<=m&&(u=!0)):"gt"==n?(e=h(e),m=h(m),e>m&&(u=!0)):"gte"==n?(e=h(e),m=h(m),e>=m&&(u=!0)):"lt"==n?(e=h(e),m=h(m),e<m&&(u=!0)):"lte"==
n?(e=h(e),m=h(m),e<=m&&(u=!0)):"neq"==n?(e=h(e),m=h(m),e!==m&&(u=!0)):"regexp"==n?(new RegExp(m)).test(e)&&(u=!0):"function"==typeof n?(m={column:d,value:e,rowData:a,msg:k},!1==n.call(b.element[0],m)?(u=!1,m.msg!=k&&(k=m.msg)):u=!0):u=!0,!u))return{valid:!1,msg:k,column:d,warn:q.warn,dataIndx:d.dataIndx,validation:q}}return{valid:!0}};g.isValidCell=function(a){var b=this.that,d=a.rowData,c=a.rowIndx,e=a.value,h=a.valueDef,l=a.column,g=b.options,q=g.bootstrap,n=a.allowInvalid,u=l.dataIndx,m=g.validation,
k=g.warning,C=g.editModel,G=C.invalidClass,C=C.warnClass,D=document.activeElement;if(a.checkEditable&&!1==b.isEditableCell({rowData:d,rowIndx:c,dataIndx:u}))return{valid:!0};a=this._isValidCell({column:l,value:e,rowData:d});var e=a.valid,l=a.warn,H=a.msg;if(e)b.data({rowData:d,dataIndx:u,data:"pq_valid"})&&(b.removeClass({rowData:d,rowIndx:c,dataIndx:u,cls:C+" "+G}),b.removeData({rowData:d,dataIndx:u,data:"pq_valid"}));else var m=f.extend({},l?k:m,a.validation),I=m.css,M=m.cls,K=m.icon,P=m.style;
if(n||l){if(e)return{valid:!0};b.addClass({rowData:d,rowIndx:c,dataIndx:u,cls:l?C:G});b.data({rowData:d,dataIndx:u,data:{pq_valid:{css:I,icon:K,style:P,msg:H,cls:M}}});return a}if(!e){c=null==c?b.getRowIndx({rowData:d}).rowIndx:c;if(null==c)return a;if(!h)b.goToPage({rowIndx:c}),b.editCell({rowIndx:c,dataIndx:u});else if(f(D).hasClass("pq-editor-focus")&&(h=g.editModel.indices)){d=h.rowIndx;h=h.dataIndx;if(null!=c&&c!=d)throw"incorrect usage of isValid rowIndx: "+c;if(u!=h)throw"incorrect usage of isValid dataIndx: "+
u;b.editCell({rowIndx:d,dataIndx:u})}if((b=b.getEditCell())&&b.$cell){var N=b.$cell;N.attr("title",H);b="tooltip";c="open";q.on&&q.tooltip&&(b=q.tooltip,c="show");try{N[b]("destroy")}catch(U){}N[b]({trigger:"manual",position:{my:"left center+5",at:"right center"},content:function(){return(""==K?"":"<span class='ui-icon "+K+" pq-tooltip-icon'></span>")+H},open:function(a,b){M&&b.tooltip.addClass(M);if(P){var p=b.tooltip.attr("style");b.tooltip.attr("style",p+";"+P).css("zIndex",N.zIndex()+5)}I&&b.tooltip.css(I)}})[b](c)}return a}if(h&&
(b=b.getEditCell())&&b.$cell){N=b.$cell;N.removeAttr("title");try{N.tooltip("destroy")}catch(L){}}return{valid:!0}};a.isValid=function(a){return this.iIsValid.isValid(a)};g.isValid=function(a){var b=this.that;a=a||{};var d=a.allowInvalid,c=a.checkEditable,d=null==d?!1:d,e=a.dataIndx;if(null!=e){var h=b.columns[e],l=a.rowData||b.getRowData(a),g=a.hasOwnProperty("value"),b=g?a.value:l[e],b=this.isValidCell({rowData:l,checkEditable:c,rowIndx:a.rowIndx,value:b,valueDef:g,column:h,allowInvalid:d});return b.valid||
b.warn?{valid:!0}:b}if(null!=a.rowIndx||null!=a.rowIndxPage||null!=a.rowData)for(var l=a.rowData||b.getRowData(a),f=b.colModel,g=[],q=0,n=f.length;q<n;q++){if(h=f[q],!h.hidden&&(e=h.dataIndx,b=l[e],b=this.isValidCell({rowData:l,value:b,column:h,rowIndx:a.rowIndx,checkEditable:c,allowInvalid:d}),!b.valid&&!b.warn))if(d)g.push({rowData:l,dataIndx:e,column:h});else return b}else{a=a.data?a.data:b.options.dataModel.data;g=[];if(!a)return null;q=0;for(n=a.length;q<n;q++){l=a[q];if(c&&(h=this.getRowIndx({rowData:l}).rowIndx,
!1==b.isEditableRow({rowData:l,rowIndx:h})))continue;l=this.isValid({rowData:l,rowIndx:h,checkEditable:c,allowInvalid:d});if(!1===d){if(!l.valid)return l}else g=g.concat(l.cells)}}return d&&g.length?{cells:g,valid:!1}:{valid:!0}};a.isEditableRow=function(a){var b=this.options.editable;if(null!=b){if("function"==typeof b){var d=a.rowIndx;a=a.rowData||this.getRowData({rowIndx:d});return b.call(this.element[0],{rowData:a,rowIndx:d})}return b}return!0};a.isEditableCell=function(a){var b=a.colIndx,d=a.dataIndx,
b=null==b?this.getColIndx({dataIndx:d}):b,b=this.colModel[b],d=null==d?b.dataIndx:d,c=b.editable;if(a.checkVisible&&b.hidden)return!1;if(null!=c){if("function"==typeof c){var e=a.rowIndx;a=a.rowData||this.getRowData(a);return c.call(this.element[0],{rowIndx:e,rowData:a,column:b,dataIndx:d})}return c}return!0};a._getRowPQData=function(a,b,d){return(d=null==d?this.pdata[a]:d)?d[b]:null};a._setRowPQData=function(a,b,d){if(d=null==d?this.pdata[a]:d)for(var c in b)d[c]=b[c]};a._onContMouseDown=function(a){this.blurEditor({blurIfFocus:!0});
if(!1===this._trigger("contMouseDown",a,{dataModel:this.options.dataModel}))return!1;var b=f(a.target);a=b.closest(".pq-grid-cell");b=b.closest(".pq-grid-row");a.length||b.length||this.$cont.attr("tabindex",0).focus();return!0};a._onCellMouseDown=function(a){var b=f(a.currentTarget),d=this.getCellIndices({$td:b});d.$td=b;d.dataModel=this.options.dataModel;return!1==this._trigger("cellMouseDown",a,d)?!1:!0};a._onRowMouseDown=function(a){var b=f(a.currentTarget),d=this.getRowIndx({$tr:b});d.$tr=b;d.dataModel=
this.options.dataModel;return!1==this._trigger("rowMouseDown",a,d)?!1:!0};a._onCellMouseEnter=function(a,b){var d=this.options,c=this.getCellIndices({$td:b});if(null!=c.rowIndx&&null!=c.colIndx){if(!1===this._trigger("cellMouseEnter",a,c))return!1;"cell"==d.hoverMode&&this.highlightCell(b);return!0}};a._onRowMouseEnter=function(a,b){var d=this.options,c=this.getRowIndx({$tr:b}),e=c.rowIndxPage;if(!1===this._trigger("rowMouseEnter",a,c))return!1;"row"==d.hoverMode&&this.highlightRow(e);return!0};a._onCellMouseLeave=
function(a,b){"cell"==this.options.hoverMode&&this.unHighlightCell(b);return!0};a._onRowMouseLeave=function(a,b){var d=this.getRowIndx({$tr:b}).rowIndxPage;"row"==this.options.hoverMode&&this.unHighlightRow(d);return!0};a.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)};a.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(a){if(a.target){var b=f(a.target);if(b.is("input,textarea,select")||
b.closest(".pq-native-select").length)return!0;a.preventDefault()}})};a._onClickCell=function(a){var b=this.colModel,d=this.options.editModel,c=f(a.currentTarget),e=this.getCellIndices({$td:c}),h=e.rowIndxPage,l=h+this.rowIndxOffset,g,q,n=e.colIndx;e.rowIndx=l;null!=n&&(0<=n&&(g=b[n],q=g.dataIndx,e.dataIndx=q),e.evt=a);if(!1==this._trigger("cellClick",a,{$td:c,rowIndxPage:h,rowIndx:l,colIndx:n,dataIndx:q,column:g,rowData:this.pdata[h]}))return!1;null==n||0>n||1==d.clicksToEdit&&this.isEditableRow({rowIndx:l})&&
this.isEditableCell({colIndx:n,rowIndx:l})&&this.editCell(e)};a._onRightClickCell=function(a){var b=f(a.currentTarget),d=this.getCellIndices({$td:b}),c=d.rowIndxPage,e=c+this.rowIndxOffset,d=d.colIndx,h=this.colModel;if(null!=d&&(h=h[d],!1==this._trigger("cellRightClick",a,{$td:b,rowIndxPage:c,rowIndx:e,colIndx:d,dataIndx:h.dataIndx,column:h,rowData:this.pdata[c]})))return!1};a.highlightCell=function(a){a.addClass("pq-grid-cell-hover ui-state-hover")};a.unHighlightCell=function(a){a.removeClass("pq-grid-cell-hover ui-state-hover")};
a.highlightRow=function(a){isNaN(a)||(a=this.getRow({rowIndxPage:a}))&&a.addClass("pq-grid-row-hover ui-state-hover")};a.unHighlightRow=function(a){isNaN(a)||(a=this.getRow({rowIndxPage:a}))&&a.removeClass("pq-grid-row-hover ui-state-hover")};a._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}};a._findCellFromEvt=function(a){a=f(a.target).closest(".pq-grid-cell");if(null==a||0==a.length)return{rowIndxPage:null,colIndx:null,$td:null};
var b=this.getCellIndices({$td:a});b.$td=a;return b};a._initPager=function(){var a=this,b=a.options,d={bootstrap:b.bootstrap,change:function(b,d){a.blurEditor({force:!0});var c=a.options.pageModel;void 0!=d.curPage&&(c.prevPage=c.curPage,c.curPage=d.curPage);void 0!=d.rPP&&(c.rPP=d.rPP);"remote"==c.type?a.remoteRequest({callback:function(){a._delegatePageChangeEvent({type:"remote"});a._onDataAvailable({apply:!0,header:!1})}}):(a._delegatePageChangeEvent({type:"local"}),a.refreshView({header:!1}))},
refresh:function(b){a.refreshDataAndView()}},b=b.pageModel;b.type&&(this.$pager=b.appendTo?b.appendTo.pqPager(d):this.$footer.pqPager(d))};a._triggerPageChangeEvent=function(a){var b=this._pageChangeEvent;b&&(this._trigger("pageChange",a,b),delete this._pageChangeEvent)};a._delegatePageChangeEvent=function(a){this._pageChangeEvent=a};a.generateLoading=function(){this.$loading&&this.$loading.remove();this.$loading=f("<div class='pq-loading'></div>").appendTo(this.element);f(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",
this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading);this.$loading.find("div.pq-loading-bg").css("opacity",.2)};a._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)};a.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0);this.showLoadingCounter++;this.$loading.show()};a.hideLoading=function(){0<this.showLoadingCounter&&this.showLoadingCounter--;this.showLoadingCounter||this.$loading.hide()};
a.refreshDataFromDataModel=function(){var a=this._queueATriggers,b;for(b in a){var d=a[b];this._trigger(b,d.evt,d.ui)}this._queueATriggers={};this._trigger("beforeRefreshData",null,{});var c=this.options,a=c.pageModel,d=c.dataModel.data,e=a.type;this.rowIndxOffset=0;if(null==d||0==d.length)e&&(a.curPage=0,a.totalPages=0,a.totalRecords=0),this.pdata=d;else{if(e&&"local"==e){a.totalRecords=d.length;a.totalPages=Math.ceil(d.length/a.rPP);a.curPage>a.totalPages&&(a.curPage=a.totalPages);1>a.curPage&&
0<a.totalPages&&(a.curPage=1);var c=(a.curPage-1)*a.rPP,h=a.curPage*a.rPP;h>d.length&&(h=d.length);this.pdata=d.slice(c,h)}else"remote"==e?(c=Math.ceil(a.totalRecords/a.rPP),(a.totalPages=c)&&!a.curPage&&(a.curPage=1),h=a.rPP,h>d.length&&(h=d.length),this.pdata=d.slice(0,h)):this.pdata=c.backwardCompat?d.slice(0):d;if("local"==e||"remote"==e)this.rowIndxOffset=a.rPP*(a.curPage-1);a=this._queueBTriggers;for(b in a)d=a[b],this._trigger(b,d.evt,d.ui);this._queueBTriggers={};this._trigger("dataReady",
null,{})}};a.getQueryStringCRUD=function(){return""};a.remoteRequest=function(a){this.loading&&this.xhr.abort();a=a||{};var b=this,d="",c="",e=this.options,h=!1,l=this.colModel,g=e.dataModel,q=e.sortModel,n=e.filterModel,u=e.pageModel;if("function"==typeof g.getUrl)(e=g.getUrl.call(this.element[0],{colModel:l,dataModel:g,sortModel:q,groupModel:e.groupModel,pageModel:u,filterModel:n}))&&e.url&&(d=e.url),e&&e.data&&(c=e.data);else if("string"==typeof g.url){var d=g.url,c={},e={},m={};"remote"==q.type&&
(a.initBySort||this.sort({initByRemote:!0}),(q=this.iSort.getQueryStringSort())&&(c={pq_sort:q}));"remote"==u.type&&(m={pq_curpage:u.curPage,pq_rpp:u.rPP});"local"!=n.type&&(q=this.iFilterData.getQueryStringFilter())&&(h=!0,e={pq_filter:q});var q=g.postData,k=g.postDataOnce;q&&"function"==typeof q&&(q=q.call(this.element[0],{colModel:l,dataModel:g}));c=f.extend({pq_datatype:g.dataType},e,m,c,q,k)}d&&(this.loading=!0,this.showLoading(),this.xhr=f.ajax({url:d,dataType:g.dataType,async:null==g.async?
!0:g.async,cache:g.cache,contentType:g.contentType,type:g.method,data:c,beforeSend:function(a,d){if("function"==typeof g.beforeSend)return g.beforeSend.call(b.element[0],a,d)},success:function(d,c,e){"function"==typeof g.getData&&(d=g.getData.call(b.element[0],d,c,e));g.data=d.data;u.type&&"remote"==u.type&&(d.curPage&&(u.curPage=d.curPage),d.totalRecords&&(u.totalRecords=d.totalRecords));b.hideLoading();b.loading=!1;b._queueBTriggers.load={ui:{dataModel:g,colModel:l}};a.callback&&a.callback();h&&
(b._queueATriggers.filter={ui:{type:"remote",filterModel:n}})},error:function(a,d,p){b.hideLoading();b.loading=!1;if("function"==typeof g.error)g.error.call(b.element[0],a,d,p);else if("abort"!=p)throw"Error : "+p;}}))};a._refreshTitle=function(){this.$title.html(this.options.title)};a._destroyDraggable=function(){var a=this.element,b=a.parent(".pq-wrapper");b.length&&b.data("draggable")&&(b.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),a.unwrap(".pq-wrapper"))};a._refreshDraggable=
function(){var a=this.element,b=this.$title;this.options.draggable?(b.addClass("pq-draggable pq-no-capture"),a.parent(".pq-wrapper").length||a.wrap("<div class='pq-wrapper' />"),a.parent(".pq-wrapper").draggable({handle:b})):this._destroyDraggable()};a._refreshResizable=function(){var a=this,b=this.element,d=this.options,c=-1<(d.width+"").indexOf("%"),e=-1<(d.height+"").indexOf("%"),h="auto"==d.width,l="flex"==d.width,g="flex"==d.height;if(!d.resizable||(g||e)&&(l||c||h))this._destroyResizable();
else{var q="e,s,se";if(g||e)q="e";else if(l||c||h)q="s";c=!0;b.hasClass("ui-resizable")&&(e=b.resizable("option","handles"),q==e?c=!1:this._destroyResizable());c&&b.resizable({helper:"ui-state-default",handles:q,minWidth:d.minWidth,minHeight:d.minHeight?d.minHeight:100,delay:0,start:function(a,b){f(b.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(a,b){},stop:function(b,c){var e=a.element,v=d.width,h=d.height,l=-1<(v+"").indexOf("%"),g=-1<(h+"").indexOf("%"),
t="auto"==v,v="flex"==v,s=!1;g||"flex"==h||(s=!0,d.height=e.height());l||t||v||(s=!0,d.width=e.width());a.refresh();e.css("position","relative");s&&f(window).trigger("resize")}})}};a._refreshAfterResize=function(){var a=this.options,b=a.width,d=a.height,a=-1!=(b+"").indexOf("%")?!0:!1,b="auto"===b,d=-1!=(d+"").indexOf("%")?!0:!1;(a||b||d)&&this.refresh()};a.refresh=function(a){this.iRefresh.refresh(a)};a._refreshDataIndices=function(){for(var a="JSON"==this.getDataType()?!0:!1,b={},d={},c={},e=this.colModel,
h=e.length,l=0;l<h;l++){var g=e[l],f=g.dataIndx;null==f&&(f=a?"dataIndx_"+l:l,g.dataIndx=f);b[f]=g;d[f]=l;g.validations&&(c[f]=c)}this.columns=b;this.colIndxs=d;this.validations=c};a.refreshView=function(a){null!=this.options.editModel.indices&&this.blurEditor({force:!0});this.refreshDataFromDataModel();this.refresh(a)};a._refreshPager=function(){var a=this.options,b=a.pageModel,d=b.rPP,c=b.totalRecords;b.type?(b=a.pageModel,this.$pager||this._initPager(),this.$pager.pqPager("option",b),c>d?this.$bottom.css("display",
""):a.showBottom||this.$bottom.css("display","none")):(this.$pager&&(this.$pager.pqPager("destroy"),this.$pager=null),a.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none"))};a.getInstance=function(){return{grid:this}};a._addRowsData=function(a){var b=a.data,d=this.options.dataModel.data;a=a.rowIndx;null==d&&(d=[]);if(null==a)for(var c=0,e=b.length;c<e;c++){var h=b[c];d.push(h)}else if(a<d.length)for(c=0,e=b.length;c<e;c++)h=b[c],d.splice(a,0,h),a++;else return!1;return!0};
a.addRows=function(a){return this._addRowsData(a)?(this.refreshDataFromDataModel(),this.refresh(),!0):!1};a.refreshDataAndView=function(a){if("remote"==this.options.dataModel.location){var b=this;this.remoteRequest({callback:function(){b._onDataAvailable(a)}})}else this._onDataAvailable(a)};a.getColIndx=function(a){var b=a.dataIndx;a=a.column;var d;if(a)d=!0;else if(void 0===b)throw"dataIndx / column NA";var c=this.colModel,e=c.length;if(d)for(d=0;d<e;d++){if(c[d]==a)return d}else for(d=0;d<e;d++)if(c[d].dataIndx==
b)return d;return-1};a.getColumn=function(a){if(null==a.dataIndx)throw"dataIndx N/A";return this.columns[a.dataIndx]};a._setOption=function(a,b){var d=this.options,c=d.dataModel;if("height"===a)"flex"===b?(c=this.$vscroll,b&&c&&c.hasClass("pq-sb-vert")&&(d.virtualY?c.pqScrollBar("option","cur_pos",0):c.pqScrollBar("option","ratio",0)),this.$hscroll.css("position","relative")):"flex"===d.height&&this.$hscroll.css("position",""),this._super(a,b);else if("width"===a&&"flex"==b)this._super(a,b),c=this.$hscroll,
b&&c&&c.hasClass("pq-sb-horiz")&&(d.virtualX?c.pqScrollBar("option","cur_pos",0):c.pqScrollBar("option","ratio",0));else if("title"==a)this._super(a,b),this._refreshTitle();else if("roundCorners"==a)this._super(a,b),b?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"));else if("virtualX"==a)this._super(a,
b),this.$hscroll.pqScrollBar("option","steps",b);else if("virtualY"==a)this._super(a,b),this.$vscroll.pqScrollBar("option","steps",b);else if("freezeCols"==a)b=parseInt(b),!isNaN(b)&&0<=b&&b<=this.colModel.length-2&&this._super(a,b);else if("freezeRows"==a)b=parseInt(b),!isNaN(b)&&0<=b&&this._super(a,b);else if("resizable"==a)this._super(a,b),this._refreshResizable();else if("draggable"==a)this._super(a,b),this._refreshDraggable();else if("scrollModel"==a)this._super(a,b);else if("dataModel"==a)b.data!==
c.data&&c.dataUF&&c.dataUF.length&&(c.dataUF.length=0),this._super(a,b);else if("groupModel"==a){if(null==b)for(var d=c.data,c=0,e=d.length;c<e;c++)d[c].pq_hidden=!1;this._super(a,b)}else"pageModel"==a?this._super(a,b):"selectionModel"===a?this._super(a,b):"colModel"===a||"columnTemplate"==a?(this._super(a,b),this._calcThisColModel()):"disabled"===a?(this._super(a,b),!0===b?this._disable():this._enable()):"numberCell"===a?(this._super(a,b),this.iRefresh.decidePanes()):"strLoading"===a?(this._super(a,
b),this._refreshLoadingString()):"showTop"===a?(this._super(a,b),!0===b?this.$top.css("display",""):this.$top.css("display","none")):"showTitle"===a?(this._super(a,b),!0===b?this.$title.css("display",""):this.$title.css("display","none")):"showToolbar"===a?(this._super(a,b),!0===b?this.$toolbar.css("display",""):this.$toolbar.css("display","none")):"toolbar"==a?(this._super(a,b),this.$toolbar.remove(),this._super(a,b),this._createToolbar()):"collapsible"===a?(this._super(a,b),this._createCollapse()):
"showBottom"===a?(this._super(a,b),!0===b?this.$bottom.css("display",""):this.$bottom.css("display","none")):this._super(a,b)};a._generateCellRowOutline=function(){var a=this.options,b=a.editModel;if(this.$div_focus){if(a.debug)throw"this.$div_focus already present assert failed";}else a=this.element,b.inline&&(a=this.getCell(b.indices),a.css("padding",0).empty()),this.$div_focus=f("<div class='pq-editor-outer'><div class='pq-editor-inner'></div></div>").appendTo(a),this.$div_focus.css("zIndex",a.zIndex()+
5),b=f.extend({all:!0},b.indices),b=this.getCell(b),b.css("height",b.height()),b.empty(),this.refreshEditorPos()};a._removeCellRowOutline=function(a){if(this.$div_focus){a=this.$div_focus.find(".pq-editor-focus");a.hasClass("hasDatepicker")&&a.datepicker("hide").datepicker("destroy");if(a[0]==document.activeElement){var b=this._blurEditMode;this._blurEditMode=!0;a.blur();this._blurEditMode=b}this.$div_focus.remove();delete this.$div_focus;a=this.options.editModel;b=f.extend({},a.indices);a.indices=
null;this.refreshCell(b)}};a.refreshEditorPos=function(){var a=this.options.editModel,b=a.cellBorderWidth,d=this.$div_focus,c=this.getCell(a.indices);if(!c||!c.length)return!1;var a=c[0].offsetWidth,e=c[0].offsetHeight,h=this.element.offset(),c=c.offset();d.css({height:e,width:a,borderWidth:b,left:c.left-h.left,top:c.top-h.top-1})};a.setEditorPosTimer=function(){var a=this,b=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null);
this._refreshEditorPosTimer=window.setInterval(function(){b.editModel.indices&&a.refreshEditorPos()},200)};a._findfirstUnhiddenColIndx=function(){for(var a=0;a<this.colModel.length;a++)if(!this.colModel[a].hidden)return a};a.selectRow=function(a){var b=a.evt;if(b&&("keydown"==b.type||"keypress"==b.type)){if(!1==this.iRows.replace(a))return!1}else if(!1==this.iRows.add(a))return!1;return!0};a.get$Tbl=function(a,b){var d=this.$tbl,c=[];if(d&&d.length){var e=this.pqpanes,h=this.options,l=h.freezeRows,
h=h.freezeCols;e.h&&e.v?null==b?a>=l?c.push(d[2],d[3]):c.push(d[0],d[1]):c=b>=h&&a>=l?d[3]:b<h&&a>=l?d[2]:b>=h&&a<l?d[1]:d[0]:c=e.v?null==b?d:b>=h?d[1]:d[0]:e.h?a>=l?d[1]:d[0]:d[0];if(c)return f(c)}};a.scrollCell=function(a){this.scrollRow(a);this.scrollColumn(a)};a.scrollY=function(a){this.$vscroll.pqScrollBar("option","cur_pos",a).pqScrollBar("scroll")};a.scrollRow=function(a){if(!this.pdata||a.rowIndxPage>=this.pdata.length)return!1;this.options.virtualY?this._scrollRowVirtual(a):this.iMouseSelection.scrollRowNonVirtual(a)};
a._scrollRowVirtual=function(a){var b=this.options,d=a.rowIndxPage,c=this.iHierarchy?!0:!1,e=a.rowIndx;a=this.$vscroll;var h=this.scrollCurPos,d=null==d?e-this.rowIndxOffset:d,l=parseInt(b.freezeRows);if(!(d<l)&&(e=this._calcCurPosFromRowIndxPage(d),null!=e)){e<h&&a.pqScrollBar("option","cur_pos",e).pqScrollBar("scroll");var g=this.get$Tbl(d);if(!g||!g.length)return null;var f=g.children("tbody").children("tr[pq-row-indx="+d+"]"),q=d=f.last();1<f.length&&(q=f.first());var n=d[0],f=parseInt(g.css("marginTop"));
if(void 0==n)b.scrollModel.smooth?a.pqScrollBar("option","ratio",e/this.totalVisibleRows).pqScrollBar("drag"):a.pqScrollBar("option","cur_pos",e).pqScrollBar("scroll");else{var b=n.offsetTop+n.offsetHeight,n=this.$cont[0].offsetHeight,u=this._getSBHeight(),q=q.prev("tr");if(!q.hasClass("pq-row-hidden")&&!q.hasClass("pq-last-frozen-row")&&b>n-u-f){b-=n-u-f;f=g.children().children("tr");q=g=0;l?(l=f.filter("tr.pq-last-frozen-row").last().next(),0==l.length&&(l=f.filter("tr.pq-row-hidden").next())):
l=f.filter("tr.pq-row-hidden").next();do{if(!l.length)break;g+=l[0].offsetHeight;if(l[0]==d[0])break;else if(c&&!1!=l.hasClass("pq-detail-child")||q++,g>=b)break;l=l.next()}while(1);c=h+q;c>e&&(c=e);h=a.pqScrollBar("option","num_eles");h<c+1&&(h=c+1);a.pqScrollBar("option",{num_eles:h,cur_pos:c}).pqScrollBar("scroll")}}}};a.blurEditor=function(a){if(this.$div_focus){var b=this.$div_focus.find(".pq-editor-focus");if(a&&a.blurIfFocus)document.activeElement==b[0]&&b.blur();else return b.triggerHandler("blur",
a)}};a._scrollColumnVirtual=function(a){var b=a.colIndx,b=null==b?this.getColIndx({dataIndx:a.dataIndx}):b;a=this.options.freezeCols;var d=this._calcRightEdgeCol(b).width,c=this._getSBWidth(),c=this.$cont[0].offsetWidth-c;if(d>c){for(var d=u.call(this,-1,b+1)-c,c=this.colModel,e=c.length,h=0,l=0,g=a;g<e;g++){var f=c[g];f.hidden||(h+=f.outerWidth);if(g==b){l=g-a-this._calcNumHiddenUnFrozens(g);break}else if(h>=d){l=g-a-this._calcNumHiddenUnFrozens(g)+1;break}}this.$hscroll.pqScrollBar("option","cur_pos",
l).pqScrollBar("scroll");return!0}return this.hidearrHS[b]?(this.hidearrHS[b]=!1,b=b-a-this._calcNumHiddenUnFrozens(b),this.$hscroll.pqScrollBar("option","cur_pos",b).pqScrollBar("scroll"),!0):!1};a.scrollColumn=function(a){var b=this.options;return"flex"===b.width?!1:b.virtualX?this._scrollColumnVirtual(a):this.iMouseSelection.scrollColumnNonVirtual(a)};a.selection=function(a){var b=a.method,d=a.type;if("row"==d)return this.iRows[b](a);if("cell"==d)return this.iCells[b](a)};a.goToPage=function(a){var b=
this.options.pageModel;if("local"==b.type||"remote"==b.type){var d=a.rowIndx,c=b.rPP;a=null==a.page?Math.ceil((d+1)/c):a.page;a!=b.curPage&&(b.curPage=a,"local"==b.type?(this.refreshDataFromDataModel(),this.refresh()):this.refreshDataAndView())}};a.setSelection=function(a){if(null==a)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;var b=this.pdata,d,e;if(a.rowData)e=this.getRowIndx(a),d=e.rowIndx;else{var h=this.rowIndxOffset;d=a.rowIndx;e=a.rowIndxPage;d=null==
d?e+h:d}h=null==a.colIndx&&void 0!==a.dataIndx?this.getColIndx({dataIndx:a.dataIndx}):a.colIndx;if(0>d||0>h||h>=this.colModel.length||null==b||0==b.length)return!1;a.rowIndx=d;a.colIndx=h;this.goToPage(a);e=d-this.rowIndxOffset;a.rowIndxPage=e;null!=h&&(b=(b=this.attr({rowIndx:d,colIndx:h,attr:"style"}).attr)&&"none"==b.display?!0:!1,b?(e=c({rowIndx:d,colIndx:h,that:this,select:!0}),this.data({rowIndx:e.rowIndx,colIndx:e.colIndx,data:{pq_merge_nav:{rowIndx:d,colIndx:h}}}),a.rowIndx=e.rowIndx,a.colIndx=
e.colIndx,a.rowIndxPage=e.rowIndx-this.rowIndxOffset):this.removeData({rowIndx:d,colIndx:h,data:"pq_merge_nav"}));this.scrollRow({rowIndxPage:a.rowIndxPage});if(null==h)return this.selectRow(a);this.scrollColumn({colIndx:a.colIndx});return this.selectCell(a)};a.getColModel=function(){return this.colModel};a.saveEditCell=function(a){var b=this.options,d=b.editModel;if(!d.indices)return null;d=f.extend({},d.indices);a=a?a.evt:null;var c=d.colIndx,d=d.rowIndxPage,h=d+this.rowIndxOffset,l=this.colModel[c],
g=l.dataIndx,q=this.pdata,n=q[d],u=b.dataModel,b=this.iGenerateView,m;if(null==n)return null;if(null!=d){var k=this.getEditCellData();if(f.isPlainObject(k)){m={};for(var E in k)m[E]=n[E]}else m=b.readCell(n,l);"<br>"==k&&(k="");null==m&&""===k&&(k=null);E={rowIndx:h,rowIndxPage:d,dataIndx:g,column:l,newVal:k,value:k,oldVal:m,rowData:n,dataModel:u};if(!1===this._trigger("cellBeforeSave",a,E))return!1;l={};u=!1;f.isPlainObject(k)?(l=k,u=!0):l[g]=k;if((c=e(d,c,this))&&c.rowspan){c=c.rowspan;k={};k[g]=
b.readCell(n,g);g=[];if(c)for(n=0;n<c;n++)g.push({newRow:l,rowIndx:h+n,rowData:q[d+n],oldRow:k,type:"update"});d=this._digestData({source:"edit",checkEditable:!1,rowList:g})}else d=this.updateRow({row:l,rowIndx:h,refresh:u,silent:!0,source:"edit",checkEditable:!1});if(!1===d)return!1;this._trigger("cellSave",a,E);return!0}};a._addInvalid=function(a){};a._digestData=function(a){if(!1===this._trigger("beforeValidate",null,a))return!1;var b=this.options,d=b.editModel,c=b.dataModel,e=c.data,h=b.colModel,
l=b.pageModel,g=b.historyModel,q=a.validate,q=null==q?d.validate:q,n=l.type,u=a.allowInvalid,u=null==u?d.allowInvalid:u,m=b.trackModel,d=a.track,d=null==d?null==b.track?m.on:b.track:d,k=a.history,k=null==k?g.on:k,C=a.checkEditable,C=null==C?!0:C,G=a.checkEditableAdd,G=null==G?C:G,g=this.iGenerateView.saveCell,m=this.columns,D=this.colIndxs,H=a.source,I=this.rowIndxOffset,M=f.paramquery.getValueFromDataType,K=a.rowList,P=K.length;e||(e=b.dataModel.data=[]);for(var N=[],U=0;U<P;U++){var L=K[U],J=L.newRow,
Q=L.rowData,O=L.type,W=L.checkEditable,S=L.rowIndx,Y=L.oldRow;null==W&&("update"==O?W=C:"add"==O&&(W=G));if("update"==O){if(!Y||!Q)throw"assert failed: oldRow and rowData required while update";if(W&&!0!==b.editable&&!1===this.isEditableRow({rowIndx:S,rowData:Q}))continue}else if("delete"==O){N.push(L);continue}if("add"==O)for(var V=0,X=h.length;V<X;V++){var T=h[V],R=T.dataIndx;J[R]=J[R]}for(R in J){T=m[R];V=D[R];if(T){if(W&&null!=T.editable&&!1===this.isEditableCell({rowIndx:S,colIndx:V,dataIndx:R})){delete J[R];
continue}var X=T.dataType,V=M(J[R],X),Z=Y?Y[R]:void 0,Z=void 0!==Z?M(Z,X):void 0;J[R]=V;if(q&&T.validations)if("edit"==H&&!1===u){if(T=this.isValid({dataIndx:R,rowIndx:S,value:V}),!1==T.valid&&!T.warn)return!1}else T=this.iIsValid.isValidCell({column:T,rowData:"add"==O?J:Q,allowInvalid:u,value:V}),!1===T.valid&&(!1!==u||T.warn||delete J[R]);if("update"==O&&V===Z){if("edit"==H)return null;delete J[R];continue}}"update"==O&&(Y[R]=Z)}if(J)if("update"==O)for(R in J){N.push(L);break}else N.push(L)}K=a.rowList=
N;P=K.length;if(!P)return!1;k&&(this.iHistory.increment(),this.iHistory.push({rowList:K}));for(U=0;U<P;U++)if(L=K[U],O=L.type,J=L.newRow,S=L.rowIndx,b=L.rowIndxPage,Q=L.rowData,"update"==O)for(R in d&&this.iUCData.update({rowData:Q,row:J,refresh:!1}),J)T=m[R],V=J[R],g(Q,T,V);else if("add"==O)d&&this.iUCData.add({rowData:J}),null==S&&null==b?e.push(J):(b=S-I,b="remote"==n?b:S,e.splice(b,0,J)),"remote"==n&&l.totalRecords++;else if("delete"==O){b=this.getRowIndx({rowData:Q});h=b.uf;S=b.rowIndx;if(d)this.iUCData["delete"]({rowIndx:S,
rowData:Q});b=S-I;b="remote"==n?b:S;h?c.dataUF.splice(b,1):(b=e.splice(b,1))&&b.length&&"remote"==n&&l.totalRecords--}this._trigger("change",null,a);return!0};a.refreshColumn=function(a){var b=this.colModel,d=a.colIndx,c=a.dataIndx,d=null==d?this.getColIndx({dataIndx:c}):d,c=null==c?b[d]:c,e=this.rowIndxOffset;a.colIndx=d;for(var h=this.initV,l=this.finalV,g=h;g<=l;g++){var f=g;a.rowIndx=f+e;a.rowIndxPage=f;a.colIndx=d;a.column=b[d];a.skip=!0;this.refreshCell(a)}this._trigger("refreshColumn",null,
{dataModel:this.options.dataModel,colModel:b,initV:h,finalV:l,colIndx:d,dataIndx:c});this.iRefresh.softRefresh()};a.refreshCell=function(a){if(this.pdata){var b=this.rowIndxOffset,d=a.skip,c=a.rowIndx,e=a.rowIndxPage,c=a.rowIndx=null==c?e+b:c,e=a.rowIndxPage=null==e?c-b:e,b=a.dataIndx,h=a.colIndx,h=a.colIndx=null==h?this.getColIndx({dataIndx:b}):h,l=this.getCell({all:!0,rowIndxPage:e,colIndx:h}),g=a.column,f=this.colModel;a.column=g?g:f[h];if(g=this.pdata[e])a.rowData=g,l&&0<l.length&&(a=this.iGenerateView.renderCell(a),
l.replaceWith(a),d||(this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:f,rowData:g,rowIndx:c,rowIndxPage:e,colIndx:h,dataIndx:b}),this.iRefresh.softRefresh()))}};a.refreshRow=function(a){if(this.pdata){var b=this.rowIndxOffset,d=a.rowIndx;a=a.rowIndxPage;d=null==d?a+b:d;a=null==a?d-b:a;var b=this.getRow({all:!0,rowIndxPage:a}),c=this.colModel,e=this.pdata[a],h=!1,l=document.activeElement;f(l);if(l==b[0]||1<b.length&&l==b[1])h=!0;if(!e||!b||!b.length)return null;l=[];this.iGenerateView.refreshRow(a,
c,l,null,null,e.pq_detail&&e.pq_detail.show);c=l.join("");b.replaceWith(c);h&&this.getRow({all:!0,rowIndxPage:a}).attr("tabindex",0).focus();this._trigger("refreshRow",null,{rowData:e,rowIndx:d,rowIndxPage:a});this.iRefresh.softRefresh();return!0}};a.quitEditMode=function(a){if(!this._quitEditMode){var b=!1,d=!1,c=!1,e=this.options.editModel,h=e.indices,l=void 0;this._quitEditMode=!0;a&&(b=a.old,d=a.silent,c=a.fireOnly,l=a.evt);h&&(d||b||this._trigger("editorEnd",l,h),c||(this._removeCellRowOutline(a),
e.indices=null));this._quitEditMode=null}};a.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}};a.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}};a.getRowIndxOffset=function(){return this.rowIndxOffset};a.selectCell=function(a){var b=a.evt;if(b&&("keydown"==b.type||"keypress"==b.type)){if(!1==this.iCells.replace(a))return!1}else if(!1===this.iCells.add(a))return!1;return!0};a.getEditCell=function(){var a=this.options.editModel;
if(a.indices){var a=this.getCell(a.indices),b=this.$div_focus.children(".pq-editor-inner"),d=b.find(".pq-editor-focus");return{$td:a,$cell:b,$editor:d}}return null};a.editCell=function(a){this.scrollRow(a);this.scrollColumn(a);var b=this.getCell(a);if(b&&b.length)return this._editCell(a)};a.getFirstEditableColIndx=function(a){if(null==a.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(a))return-1;for(var b=this.colModel,d=0;d<b.length;d++)if(a.colIndx=d,this.isEditableCell(a)&&!b[d].hidden)return d;
return-1};a.editFirstCellInRow=function(a){var b=this.rowIndxOffset,d=a.rowIndx;a=a.rowIndxPage;d=null==d?a+b:d;a=null==a?d-b:a;b=this.getFirstEditableColIndx({rowIndx:d});-1!=b&&this.editCell({rowIndxPage:a,colIndx:b})};a._editCell=function(a){var b=this,d=a.evt,c=this.element[0],e=this.rowIndxOffset,h=a.rowIndxPage,l=a.rowIndx,l=null==l?h+e:l,h=null==h?l-e:h,e=a.colIndx,g=a.dataIndx,e=null==e?this.getColIndx({dataIndx:g}):e,q=this.colModel[e],g=q.dataIndx,n=q.editor,u=this.options,m=u.editModel,
k=u.editor,C=n?f.extend({},k,n):k,n=b.pdata[h],u=!1;if(!this.pdata||h>=this.pdata.length)return!1;if(m.indices){var G=m.indices;if(G.rowIndxPage==h&&G.colIndx==e){this.refreshEditorPos();var D=this.$div_focus.find(".pq-editor-focus");window.setTimeout(function(){D.focus()},0);return!1}if(!1===this.blurEditor({evt:d}))return!1;this.quitEditMode({evt:d})}m.indices={rowIndxPage:h,rowIndx:l,colIndx:e,column:q,dataIndx:g};this._generateCellRowOutline();G=this.$div_focus.children(".pq-editor-inner");"right"==
q.align?G.addClass("pq-align-right"):"center"==q.align?G.addClass("pq-align-center"):G.addClass("pq-align-left");var H=b.iGenerateView.readCell(n,q),I,M={rowIndx:l,rowIndxPage:h,$cell:G,cellData:H,rowData:n,dataIndx:g,column:q},K=C.type;a=null==a.select?C.select:a.select;var P=C.init,N=C.valueIndx,U=C.dataMap,L=C.mapIndices,L=L?L:{},J=C.cls||"",J="function"===typeof J?J.call(c,M):J;I="pq-editor-focus "+J;var J=I+" pq-cell-editor ",Q=C.attr||"",Q="function"===typeof Q?Q.call(c,M):Q,O=C.style||"",O=
(O="function"===typeof O?O.call(c,M):O)?"style='"+O+"'":"";M.cls=I;"function"==typeof K&&(I=K.call(c,M))&&(K=I);k._type=K;"checkbox"==K?(C=C.subtype,G.html("<input "+(H?"checked='checked'":"")+" class='"+J+"' "+Q+" "+O+" type=checkbox name='"+g+"' />"),k=G.children("input"),"triple"==C&&(k.pqval({val:H}),G.click(function(a){f(this).children("input").pqval({incr:!0})}))):"textarea"==K||"select"==K||"textbox"==K?("textarea"==K?I="<textarea class='"+J+"' "+Q+" "+O+" name='"+g+"' ></textarea>":"select"==
K?(k=C.options||[],"function"===typeof k&&(k=k.call(c,M)),J=[Q," class='",J,"' ",O," name='",g,"'"].join(""),I=f.paramquery.select({options:k,attr:J,prepend:C.prepend,labelIndx:C.labelIndx,valueIndx:N,groupIndx:C.groupIndx,dataMap:U})):I="<input class='"+J+"' "+Q+" "+O+" type=text name='"+g+"' />",f(I).appendTo(G).val("select"==K&&null!=N&&(L[N]||this.columns[N])?L[N]?n[L[N]]:n[N]:H)):K&&"contenteditable"!=K||(G.html("<div contenteditable='true' tabindx='0' "+O+" "+Q+" class='"+J+"'></div>"),G.children().html(H),
u=!0);"function"==typeof P&&P.call(c,M);var b=this,D=G.children(".pq-editor-focus"),W=m.filterKeys;(c=q.editModel)&&void 0!==c.filterKeys&&(W=c.filterKeys);var S={$cell:G,$editor:D,dataIndx:g,column:q,colIndx:e,rowIndx:l,rowIndxPage:h,rowData:n};m.indices=S;D.data({FK:W}).on("click",function(a){f(this).focus()}).on("keydown",function(a){b.iKeyNav._keyDownInEdit(a)}).on("keypress",function(a){return b.iKeyNav._keyPressInEdit(a,{FK:W})}).on("keyup",function(a){return b.iKeyNav._keyUpInEdit(a,{FK:W})}).on("blur",
function(a,d){var c=b.options.editModel,e=c.onBlur,h="save"==e,l="validate"==e,p=c.cancelBlurCls,g=d?d.force:!1;if(!b._quitEditMode&&!b._blurEditMode&&c.indices){c=f(a.target);if(!g){if(!1===b._trigger("editorBlur",a,S)||!e||p&&c.hasClass(p))return;if(c.hasClass("hasDatepicker")){if(c.datepicker("widget").is(":visible"))return!1}else if(c.hasClass("ui-autocomplete-input")){if(c.autocomplete("widget").is(":visible"))return}else if(c.hasClass("ui-multiselect")){if(f(".ui-multiselect-menu").is(":visible")||
f(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(c.hasClass("pq-select-button")&&(f(".pq-select-menu").is(":visible")||f(document.activeElement).closest(".pq-select-menu").length))return}b._blurEditMode=!0;if(!b.saveEditCell({evt:a,silent:g||h||!l})&&!g&&l)return b._deleteBlurEditMode(),!1;b.quitEditMode({evt:a});b._deleteBlurEditMode()}}).on("focus",function(a){b._trigger("editorFocus",a,S)});b._trigger("editorBegin",d,S);D.focus();window.setTimeout(function(){!1===
f(document.activeElement).hasClass("pq-editor-focus")&&b.element.find(".pq-editor-focus").focus()},0);if(a)if(u)try{var Y=D[0],V=document.createRange();V.selectNodeContents(Y);var X=window.getSelection();X.removeAllRanges();X.addRange(V)}catch(T){}else D.select()};a._deleteBlurEditMode=function(a){var b=this;a=a?a:{};b._blurEditMode&&(a.timer?window.setTimeout(function(){delete b._blurEditMode},0):delete b._blurEditMode)};a.getRow=function(a){var b=a.rowIndxPage,d=a.rowIndx,c=this.rowIndxOffset,b=
null==b?d-c:b;a=a.all?this.$tbl:this.get$Tbl(b);var e;a&&a.length&&(d=a.children("tbody"),null!=b&&(e=d.children("tr[pq-row-indx="+b+"]"),e.length>a.length&&(e=e.filter(".pq-detail-master"))));return e};a.getCell=function(a){var b=a.rowIndxPage,d=a.rowIndx,b=null==b?d-this.rowIndxOffset:b,d=a.colIndx,c=a.dataIndx,d=null==d?this.getColIndx({dataIndx:c}):d;return(a=a.all?this.$tbl:this.get$Tbl(b,d))&&a.length?a.children().children("tr[pq-row-indx="+b+"]").children("[pq-col-indx="+d+"]"):f()};a.getCellHeader=
function(a){var b=a.colIndx;a=a.dataIndx;b=null==b?this.getColIndx({dataIndx:a}):b;a=this.$tbl_header;var d,c=this.options.freezeCols;void 0!=a&&(1<a.length&&(a=b>=c?f(a[1]):f(a[0])),d=a.children().children("tr.pq-grid-title-row:last").children("[pq-col-indx="+b+"]"));return 0==d.length||"hidden"==d[0].style.visibility?null:d};a.getEditorIndices=function(){var a=this.options.editModel.indices;return a?f.extend({},a):null};a.getEditCellData=function(){var a=this.options,b=a.editModel.indices;if(!b)return null;
var d=b.rowIndxPage,c=b.rowIndx,e=this.colModel[b.colIndx],h=e.editor,l=a.editor,a=h?f.extend({},l,h):l,g=a.valueIndx,q=a.labelIndx,h=(h=a.mapIndices)?h:{},n=e.dataIndx,u=this.$div_focus.children(".pq-editor-inner"),m;if("function"==typeof a.getData)m=a.getData.call(this.element[0],{$cell:u,rowData:b.rowData,dataIndx:n,rowIndx:c,rowIndxPage:d,column:e});else if(b=l._type,"checkbox"==b)m=u.children(),m="triple"==a.subtype?m.pqval():m.is(":checked")?!0:!1;else if("contenteditable"==b)m=u.children().html();
else if((d=u.find('*[name="'+n+'"]'))&&d.length)if("select"==b&&null!=g)if(h[g]||this.columns[g]){if(m={},m[h[g]?h[g]:g]=d.val(),m[h[q]?h[q]:q]=d.find("option:selected").text(),a=a.dataMap)if(b=d.find("option:selected").data("map"))for(d=0;d<a.length;d++)c=a[d],m[h[c]?h[c]:c]=b[c]}else m=d.val();else m=d.val();else(d=u.find(".pq-editor-focus"))&&d.length&&(m=d.val());return m};a.getCellIndices=function(a){var b=a.$td;if(null==b||0==b.length||b.closest(".pq-grid")[0]!=this.element[0])return{rowIndxPage:null,
colIndx:null};a=b.parent("tr").attr("pq-row-indx");var d;null!=a&&(a=parseInt(a),d=a+this.rowIndxOffset);var b=b.attr("pq-col-indx"),c;null!=b&&(b=parseInt(b),0<=b&&(c=this.colModel[b].dataIndx));return{rowIndxPage:a,rowIndx:d,colIndx:b,dataIndx:c}};a.getRowsByClass=function(a){var b=this.options,d="remote"==b.pageModel.type?!0:!1,c=this.rowIndxOffset,b=b.dataModel.data,e=[];if(null==b)return e;for(var h=0,l=b.length;h<l;h++){var g=b[h];a.rowData=g;this.hasClass(a)&&(g={rowData:g},g.rowIndx=d?h+c:
h,e.push(g))}return e};a.getCellsByClass=function(a){var b=this.options,d="remote"==b.pageModel.type?!0:!1,c=this.rowIndxOffset,b=b.dataModel.data,e=this.colModel,h=e.length,l=[],g=function(a){for(var b=0;b<h;b++){var d=e[b].dataIndx;a.dataIndx=d;this.hasClass(a)&&l.push({rowData:a.rowData,dataIndx:d,colIndx:b,rowIndx:a.rowIndx})}};if(null==b)return l;if(null!=a.rowIndx||null!=a.rowIndxPage||null!=a.rowData)a.rowData=a.rowData||this.getRowData(a),null==a.rowIndx&&(a.rowIndx=this.getRowIndx({rowData:n})),
g(a);else for(var f=0,q=b.length;f<q;f++){var n=b[f];a.rowData=n;a.rowIndx=d?f+c:f;g(a)}return l};a.data=function(a){var b=a.dataIndx,d=a.colIndx,b=null!=d?this.colModel[d].dataIndx:b,d=a.data,c=null==d||"string"==typeof d?!0:!1;a=a.rowData||this.getRowData(a);if(!a)return{data:null};if(null==b){b=a.pq_rowdata;if(c){var e;null!=b&&(e=null==d?b:b[d]);return{data:e}}d=f.extend(!0,a.pq_rowdata,d);a.pq_rowdata=d}else{var h=a.pq_celldata;if(c)return null!=h&&(b=h[b],e=null==d||null==b?b:b[d]),{data:e};
h||(a.pq_celldata={});d=f.extend(!0,a.pq_celldata[b],d);a.pq_celldata[b]=d}};a.attr=function(a){var b=a.rowIndx,d=a.dataIndx,c=a.colIndx,d=null!=c?this.colModel[c].dataIndx:d,c=a.attr,e=null==c||"string"==typeof c?!0:!1,h=this.rowIndxOffset,l=a.refresh;a=a.rowData||this.getRowData(a);if(!a)return{attr:null};e||!1===l||null!=b||(b=this.getRowIndx({rowData:a}).rowIndx);if(null==d){d=a.pq_rowattr;if(e){var g;null!=d&&(g=null==c?d:d[c]);return{attr:g}}c=f.extend(!0,a.pq_rowattr,c);a.pq_rowattr=c;!1!==
l&&null!=b&&(b=this.getRow({rowIndxPage:b-h}))&&(d=q(c),b.attr(d))}else{var n=a.pq_cellattr;if(e)return null!=n&&(b=n[d],g=null==c||null==b?b:b[c]),{attr:g};n||(a.pq_cellattr={});c=f.extend(!0,a.pq_cellattr[d],c);a.pq_cellattr[d]=c;!1!==l&&null!=b&&(b=this.getCell({rowIndxPage:b-h,dataIndx:d}))&&(d=q(c),b.attr(d))}};var q=function(a,b){var d={},c;for(c in a){var e=a[c];if(e)if("title"==c)e=e.replace(/\"/g,"&quot;"),d[c]=e;else if("style"==c&&"object"==typeof e){var h=[],l,g;for(g in e)l=e[g],b&&"display"==
g&&"none"==l||l&&h.push(g+":"+l);(e=h.join(";")+(h.length?";":""))&&(d[c]=e)}else"object"==typeof e&&(e=JSON.stringify(e)),d[c]=e}return d};a.removeData=function(a){var b=a.dataIndx,d=a.colIndx,b=null!=d?this.colModel[d].dataIndx:b,d=a.data,d=null==d?[]:d,d="string"==typeof d?d.split(" "):d,c=d.length,e=a.rowData||this.getRowData(a);if(e)if(null==b){if(b=e.pq_rowdata){if(c)for(a=0;a<c;a++){var h=d[a];delete b[h]}c&&!f.isEmptyObject(b)||delete e.pq_rowdata}}else if((e=e.pq_celldata)&&e[b]){var l=e[b];
if(c)for(a=0;a<c;a++)h=d[a],delete l[h];c&&!f.isEmptyObject(l)||delete e[b]}};a.removeAttr=function(a){var b=a.rowIndx,d=a.dataIndx,c=a.colIndx,d=null!=c?this.colModel[c].dataIndx:d,e=a.attr,e=null==e?[]:e,e="string"==typeof e?e.split(" "):e,h=e.length,c=b-this.rowIndxOffset,l=a.refresh,g=a.rowData||this.getRowData(a);if(g)if(!1!==l&&null==b&&(b=this.getRowIndx({rowData:g}).rowIndx),null==d){if(d=g.pq_rowattr){if(h)for(a=0;a<h;a++){var q=e[a];delete d[q]}else for(q in d)e.push(q);h&&!f.isEmptyObject(d)||
delete g.pq_rowattr}!1!==l&&null!=b&&e.length&&(e=e.join(" "),(b=this.getRow({rowIndxPage:c}))&&b.removeAttr(e))}else{if((g=g.pq_cellattr)&&g[d]){var n=g[d];if(h)for(a=0;a<h;a++)q=e[a],delete n[q];else for(q in n)e.push(q);h&&!f.isEmptyObject(n)||delete g[d]}!1!==l&&null!=b&&e.length&&(e=e.join(" "),(b=this.getCell({rowIndxPage:c,dataIndx:d}))&&b.removeAttr(e))}};f.paramquery.uniqueArray=function(a){for(var b=[],d=f.inArray,c=0,e=a.length;c<e;c++){var h=a[c];-1==d(h,b)&&b.push(h)}return b};a.addClass=
function(a){var b=a.rowIndx,d=a.dataIndx,c=f.paramquery.uniqueArray,e=a.cls,h=this.rowIndxOffset,l=a.refresh,g=a.rowData||this.getRowData(a);if(g)if(!1!==l&&null==b&&(b=this.getRowIndx({rowData:g}).rowIndx),null==d){var d=g.pq_rowcls,q;q=c((d?d+" "+e:e).split(/\s+/)).join(" ");g.pq_rowcls=q;!1!==l&&null!=b&&(b=this.getRow({rowIndxPage:b-h}))&&b.addClass(e)}else{a=[];"function"!=typeof d.push?a.push(d):a=d;var n=g.pq_cellcls;n||(n=g.pq_cellcls={});for(var g=0,u=a.length;g<u;g++)d=a[g],q=(q=n[d])?q+
" "+e:e,q=c(q.split(/\s+/)).join(" "),n[d]=q,!1!==l&&null!=b&&(d=this.getCell({rowIndxPage:b-h,dataIndx:d}))&&d.addClass(e)}};a.removeClass=function(a){var b=a.rowIndx,d=this.getRowData(a),c=a.dataIndx,e=a.cls;a=a.refresh;if(d){var h=d.pq_cellcls,l=d.pq_rowcls;!1!==a&&null==b&&(b=this.getRowIndx({rowData:d}).rowIndx);if(null==c)l&&(d.pq_rowcls=this._removeClass(l,e),null!=b&&!1!==a&&(b=this.getRow({rowIndx:b}))&&b.removeClass(e));else if(h){l=[];"function"!=typeof c.push?l.push(c):l=c;for(var g=0,
q=l.length;g<q;g++){var c=l[g],f=h[c];f&&(d.pq_cellcls[c]=this._removeClass(f,e),null!=b&&!1!==a&&(c=this.getCell({rowIndx:b,dataIndx:c}))&&c.removeClass(e))}}}};a.hasClass=function(a){var b=a.dataIndx,d=a.cls;a=this.getRowData(a);d=new RegExp("\\b"+d+"\\b");return a?null==b?(b=a.pq_rowcls)&&d.test(b)?!0:!1:(a=a.pq_cellcls)&&a[b]&&d.test(a[b])?!0:!1:null};a._removeClass=function(a,b){if(a&&b){for(var d=a.split(/\s+/),c=b.split(/\s+/),e=[],h=0,l=d.length;h<l;h++){for(var g=d[h],q=!1,f=0,n=c.length;f<
n;f++)if(g===c[f]){q=!0;break}q||e.push(g)}return 1<e.length?e.join(" "):1===e.length?e[0]:null}};a.getRowIndx=function(a){var b=a.$tr,d=a.rowData;a=a.row;if(d||a){var b=this.options,c=b.dataModel,b="remote"==b.pageModel.type?!0:!1,e=c.data,h=!1,c=c.dataUF;if(d){var l=!1;if(e)for(var g=0,q=e.length;g<q;g++)if(e[g]==d){l=!0;break}if(!l&&c)for(h=!0,g=0,q=c.length;g<q;g++)if(c[g]==d){l=!0;break}}else for(g=0,q=e;g<q;g++){var d=e[g],l=!0,f;for(f in a)a[f]!==d[f]&&(l=!1);if(l)break}return l?(l=this.rowIndxOffset,
{rowIndxPage:h?void 0:b?g:g-l,uf:h,rowIndx:b?g+l:g,rowData:d}):{}}if(null==b||0==b.length)return{rowIndxPage:null};d=b.attr("pq-row-indx");if(null==d)return{rowIndxPage:null};d=parseInt(d);return{rowIndxPage:d,rowIndx:d+this.rowIndxOffset}};var n=function(a){this.options=a.options;this.that=a;var b=this,d=a.widgetEventPrefix.toLowerCase();a.element.on(d+"celleditkeyup"+a.eventNamespace,function(a,d){return b.filterKeys(a,d)})},g=n.prototype;g._incrRowIndx=function(a,b){var d=this.that,c=a;b=null==
b?1:b;for(var d=d.pdata,e=0,h=a+1,l=d.length;h<l&&(d[h].pq_hidden||(e++,c=h,e!=b));h++);return c};g._decrRowIndx=function(a,b){var d=a,c=this.that.pdata;b=null==b?1:b;for(var e=0,h=a-1;0<=h&&(c[h].pq_hidden||(e++,d=h,e!=b));h--);return d};a.addColumn=function(a,b){var d=this.options,c=d.dataModel.data;d.colModel.push(a);this._calcThisColModel();for(d=0;d<c.length;d++)c[d].push("")};a.rowNextSelect=function(){var a=this.selection({type:"row",method:"getSelection"}),b,d=this.rowIndxOffset;a&&a[0]&&
(a=a[0].rowIndx,b=this.iKeyNav._incrRowIndx(a-d));null!=b&&(this.setSelection(null),this._setSelection({rowIndxPage:b}));return b};a.rowPrevSelect=function(){var a=this.selection({type:"row",method:"getSelection"}),b,d=this.rowIndxOffset;a&&a[0]&&(a=a[0].rowIndx,b=this.iKeyNav._decrRowIndx(a-d));null!=b&&(this.setSelection(null),this.setSelection({rowIndxPage:b}));return b};g._incrIndx=function(a,b){var d=this.that,c=d._getLastVisibleRowIndxPage(d.pdata),d=d.colModel,e=d.length;if(null==b){if(a==
c)return null;a=this._incrRowIndx(a);return{rowIndxPage:a}}var h;do{b++;if(b>=e){if(a==c)return null;a=this._incrRowIndx(a);b=0}h=d[b]}while(h&&h.hidden);return{rowIndxPage:a,colIndx:b}};g._decrIndx=function(a,b){var d=this.that,c=d.colModel,e=c.length,d=d._getFirstVisibleRowIndxPage(d.pdata);if(null==b){if(a==d)return null;a=this._decrRowIndx(a);return{rowIndxPage:a}}var h;do{b--;if(0>b){if(a==d)return null;a=this._decrRowIndx(a);b=e-1}h=c[b]}while(h&&h.hidden);return{rowIndxPage:a,colIndx:b}};g._incrEditIndx=
function(a,b){var d=this.that,c=d.colModel,e=c.length,h,l=d.rowIndxOffset,g=d._getLastVisibleRowIndxPage(d.pdata);do{b++;if(b>=e){if(a==g)return null;do{a=this._incrRowIndx(a);var q=a+l;h=d.isEditableRow({rowIndx:q});if(a==g&&!1==h)return null}while(!1==h);b=0}h=c[b];q=a+l;q=d.isEditableCell({rowIndx:q,colIndx:b,checkVisible:!0})}while(h&&(h.hidden||!1==q));return{rowIndxPage:a,colIndx:b}};g._decrEditIndx=function(a,b){var d=this.that,c=d.colModel,e=c.length,h,l=d.rowIndxOffset,g=d._getFirstVisibleRowIndxPage(d.pdata);
do{b--;if(0>b){if(a==g)return null;do{a=this._decrRowIndx(a);var q=a+l;h=d.isEditableRow({rowIndx:q});if(a==g&&!1==h)return null}while(!1==h);b=e-1}h=c[b];q=a+l;q=d.isEditableCell({rowIndx:q,colIndx:b,checkVisible:!0})}while(h&&(h.hidden||!1==q));return{rowIndxPage:a,colIndx:b}};g._incrEditRowIndx=function(a,b){var d=this.that,c=d.rowIndxOffset,e=d._getLastVisibleRowIndxPage(d.pdata);if(a==e)return null;do{a=this._incrRowIndx(a);var h=a+c,l=d.isEditableRow({rowIndx:h}),h=d.isEditableCell({rowIndx:h,
colIndx:b}),l=l&&h;if(a==e&&!l)return null}while(!l);return{rowIndxPage:a,colIndx:b}};g._decrEditRowIndx=function(a,b){var d=this.that,c=d.rowIndxOffset,e=d._getFirstVisibleRowIndxPage(d.pdata);if(a==e)return null;do{a=this._decrRowIndx(a);var h=a+c,l=d.isEditableRow({rowIndx:h}),h=d.isEditableCell({rowIndx:h,colIndx:b}),l=l&&h;if(a==e&&!l)return null}while(!l);return{rowIndxPage:a,colIndx:b}};a._onKeyPressDown=function(a){if(0<f(a.target).closest(".pq-grid-header").length)return!1==this._trigger("headerKeyDown",
a,{dataModel:this.options.dataModel})?!1:!0;if(!1===this.iKeyNav._bodyKeyPressDown(a)||!1==this._trigger("keyDown",a,{dataModel:this.options.dataModel}))return!1};g._saveAndMove=function(a,b){if(null==a)return b.preventDefault(),!1;var d=this.that,c=this.options.selectionModel,e=a.rowIndxPage,h=a.colIndx;d._blurEditMode=!0;if(!1===d.saveEditCell({evt:b})||!d.pdata)return d.pdata||d.quitEditMode(b),d._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),b.preventDefault(),!1;d.quitEditMode(b);
if(a.incr)var l,e=(l=b.shiftKey?this._decrEditIndx(e,h):this._incrEditIndx(e,h))?l.rowIndxPage:e,h=l?l.colIndx:h;"row"==c.type?(d.setSelection(null),d.setSelection({rowIndxPage:e}),d.scrollColumn({colIndx:h})):"cell"==c.type?(d.setSelection(null),d.setSelection({rowIndxPage:e,colIndx:h})):(d.scrollRow({rowIndxPage:e}),d.scrollColumn({colIndx:h}));!1!==a.edit&&d._editCell({rowIndxPage:e,colIndx:h});d._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"});b.preventDefault();return!1};g._keyPressInEdit=
function(a,b){var d=this.that,c=d.options.editModel.indices;b=b?b:{};var e=b.FK,h="Backspace Left Right Up Down Del Home End".split(" "),l=c.column.dataType;return a.key&&-1!==f.inArray(a.key,h)?!0:!1===d._trigger("editorKeyPress",a,f.extend({},c))||e&&("float"==l||"integer"==l)&&(d="float"==l?"0123456789.-":"0123456789-",c=(c=a.charCode)?c:a.keyCode,(c=String.fromCharCode(c))&&-1==d.indexOf(c))?!1:!0};g.getValText=function(a){a=a[0].nodeName.toLowerCase();var b="text";-1!=f.inArray(a,["input","textarea",
"select"])&&(b="val");return b};g._keyUpInEdit=function(a,b){var d=this.that,c=d.options;b=b?b:{};var e=b.FK,c=c.editModel,h=c.indices;d._trigger("editorKeyUp",a,f.extend({},h));d=h.column.dataType;if(e&&("float"==d||"integer"==d)){var e=f(a.target),h="integer"==d?c.reInt:c.reFloat,c=this.getValText(e),l=e.data("oldVal"),g=e[c]();if(!1==h.test(g))if(h.test(l))e[c](l);else if(d="float"==d?parseFloat(l):parseInt(l),isNaN(d))e[c](0);else e[c](d)}};g._keyDownInEdit=function(a){var b=this.that,d=b.options,
c=d.editModel.indices;if(c){var e=f(a.target),h=f.ui.keyCode,l=d.selectionModel,g=d.editModel,c=f.extend({},c),d=c.rowIndxPage,q=c.colIndx,n=c.column.editModel,g=n?f.extend({},g,n):g,n=this.getValText(e);e.data("oldVal",e[n]());if(!1==b._trigger("cellEditKeyDown",a,c)||!1==b._trigger("editorKeyDown",a,c))return!1;if(a.keyCode==h.TAB)return c={rowIndxPage:d,colIndx:q,incr:!0},this._saveAndMove(c,a);if(a.keyCode==g.saveKey)return c="next"==g.onSave?{rowIndxPage:d,colIndx:q,incr:!0}:{rowIndxPage:d,colIndx:q,
edit:!1},this._saveAndMove(c,a);if(a.keyCode==h.ESCAPE)return b.quitEditMode({evt:a}),"cell"==l.type?b.getCell({rowIndxPage:d,colIndx:q}).attr("tabindex",0).focus():"row"==l.type&&(b=b.getRow({rowIndxPage:d}),f(b[0]).attr("tabindex",0).focus()),a.preventDefault(),!1;if(a.keyCode==h.PAGE_UP||a.keyCode==h.PAGE_DOWN)return a.preventDefault(),!1;if(g.keyUpDown){if(a.keyCode==h.DOWN)return c=this._incrEditRowIndx(d,q),this._saveAndMove(c,a);if(a.keyCode==h.UP)return c=this._decrEditRowIndx(d,q),this._saveAndMove(c,
a)}}};g.select=function(a){var b=this.that,d=a.rowIndx,c=a.colIndx,e=b.options.selectionModel;a=a.evt;a.shiftKey&&"single"!=e.mode?"row"==e.type?(b.scrollRow({rowIndx:d}),b.iRows.extendSelection({rowIndx:d,evt:a})):"cell"==e.type&&(b.scrollCell({rowIndx:d,colIndx:c}),b.iCells.extendSelection({rowIndx:d,colIndx:c,evt:a})):b.setSelection({rowIndx:d,colIndx:c,evt:a,setFirst:!0})};g._bodyKeyPressDown=function(a){var b=this.that,d,h,l=b.rowIndxOffset,g=this.options,q=b.colModel,n=g.selectionModel,u=g.editModel,
m=a.ctrlKey||a.metaKey,k,B,E=f.ui.keyCode,C=a.keyCode;if(u.indices)b.$div_focus.find(".pq-cell-focus").focus();else{if("row"==n.type){h=m?b.iRows.getFocusSelection({old:!0}):b.iRows.getFocusSelection({old:!1});if(null==h)return;k=h.rowIndx;g=k-l;if(null==k)return;if(!1==b._trigger("rowKeyDown",a,{rowData:b.pdata[g],rowIndx:k,rowIndxPage:g}))return!1}else if("cell"==n.type){d=m?b.iCells.getFocusSelection({old:!0}):b.iCells.getFocusSelection({old:!1});if(null==d)return;B=d;k=B.rowIndx;var g=k-l,G=B.dataIndx;
B=b.getColIndx({dataIndx:G});if(null==k||null==B)return;if(!1==b._trigger("cellKeyDown",a,{rowData:b.pdata[g],rowIndx:k,rowIndxPage:g,colIndx:B,dataIndx:G,column:q[B]}))return!1;if(a.cancelBubble)return}else return;if(C==E.LEFT||C==E.RIGHT||C==E.UP||C==E.DOWN){d=e(g,B,b);var D;d&&(D=b.data({rowIndx:k,colIndx:B,data:"pq_merge_nav"}).data);if(C==E.LEFT){if(k=D?D.rowIndx:k,B=this._decrIndx(k-l,B))k=B.rowIndxPage+l,this.select({rowIndx:k,colIndx:B.colIndx,evt:a})}else if(C==E.RIGHT){if(k=D?D.rowIndx:
k,B+=d&&d.colspan?d.colspan-1:0,B=this._incrIndx(k-l,B))k=B.rowIndxPage+l,this.select({rowIndx:k,colIndx:B.colIndx,evt:a})}else C==E.UP?(d?(k=c({rowIndx:k,colIndx:B,that:b}),k=k.rowIndx,g=this._decrRowIndx(k-l),k=g+l,k=c({rowIndx:k,colIndx:B,that:b}),k=k.rowIndx):(g=this._decrRowIndx(g),k=g+l),B=D?D.colIndx:B,null!=g&&this.select({rowIndx:k,colIndx:B,evt:a})):C==E.DOWN&&(g+=d&&d.rowspan&&g+d.rowspan<b.pdata.length?d.rowspan-1:0,B=D?D.colIndx:B,g=this._incrRowIndx(g),null!=g&&(k=g+l,this.select({rowIndx:k,
colIndx:B,evt:a})));a.preventDefault()}else if(C==E.PAGE_DOWN||C==E.SPACE){if(b=this.pageDown(g))g=b.rowIndxPage,null!=g&&(k=g+l,this.select({rowIndx:k,colIndx:B,evt:a}));a.preventDefault()}else if(C==E.PAGE_UP){if(b=this.pageUp(g))g=b.rowIndxPage,null!=g&&(k=g+l,this.select({rowIndx:k,colIndx:B,evt:a}));a.preventDefault()}else C==E.HOME?("row"==n.type||m?(k=b._getFirstVisibleRowIndxPage(b.pdata)+l,this.select({rowIndx:k,colIndx:B,evt:a})):"cell"==n.type&&(B=b._getFirstVisibleColIndx(),this.select({rowIndx:k,
colIndx:B,evt:a})),a.preventDefault()):C==E.END?("row"==n.type||m?(k=b._getLastVisibleRowIndxPage(b.pdata)+l,this.select({rowIndx:k,colIndx:B,evt:a})):"cell"==n.type&&(B=b._getLastVisibleColIndx(),this.select({rowIndx:k,colIndx:B,evt:a})),a.preventDefault()):C==E.ENTER?("row"==n.type?null!=h&&b.editFirstCellInRow({rowIndx:g+l}):null!=d&&(D=b.getCell({rowIndxPage:g,colIndx:B}))&&0<D.length&&(k=g+l,l=b.isEditableRow({rowIndx:k}),D=b.isEditableCell({rowIndx:k,colIndx:B}),l&&D&&b.editCell({rowIndxPage:g,
colIndx:B})),a.preventDefault()):m&&"65"==C?("row"==n.type&&"single"!=n.mode?b.iRows.selectAll({all:n.all}):"cell"==n.type&&"single"!=n.mode&&b.iCells.selectAll({all:n.all}),a.preventDefault()):u.pressToEdit&&32<=C&&127>=C&&!m&&null!=d&&(D=b.getCell({rowIndxPage:g,colIndx:B}))&&0<D.length&&(k=g+l,l=b.isEditableRow({rowIndx:k}),D=b.isEditableCell({rowIndx:k,colIndx:B}),l&&D&&b.editCell({rowIndxPage:g,colIndx:B,select:!0}))}};g.incrPageSize=function(){for(var a=this.that,b=a.$tbl,d=b.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),
b=parseInt(b.css("marginTop")),b=a.iRefresh.getEContHt()-b,c=d.length-1;0<=c;c--){var e=d[c];if(e.offsetTop<b)break}return{rowIndxPage:a.getRowIndx({$tr:f(e)}).rowIndxPage}};g.pageNonVirtual=function(a,b){var d=this.that,c=d.$cont[0].offsetHeight-d._getSBHeight(),e=d.getRow({rowIndxPage:a}),h=0,l=0,g=f(e[0])[b]("tr.pq-grid-row"),q=g.length;if(0<q){do{e=g[l];h+=e.offsetHeight;if(h>=c)break;l++}while(l<q);l=0<l?l-1:l;do if(e=f(g[l]),a=d.getRowIndx({$tr:e}).rowIndxPage,null!=a)break;else l--;while(0<=
l)}return a};g.pageDown=function(a){var b=this.that,d=b.options,c=b.$vscroll.pqScrollBar("option"),e=c.cur_pos,h=c.num_eles,c=c.ratio;if(d.virtualY){if(e<h-1){a=this.incrPageSize().rowIndxPage;var l=b._calcCurPosFromRowIndxPage(a);if(null==l)return;b.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll")}}else null!=a?a=this.pageNonVirtual(a,"nextAll"):1>c&&(d=b.iRefresh.getEContHt(),b=b.iMouseSelection,b.updateTableY(-1*d),b.syncScrollBarVert());return{rowIndxPage:a,curPos:l}};g.pageUp=
function(a){var b=this.that,d=b.options,c=b.$vscroll.pqScrollBar("option"),e=c.cur_pos,c=c.ratio;if(d.virtualY){if(0<e){a=this.decrPageSize().rowIndxPage;var h=b._calcCurPosFromRowIndxPage(a);if(null==h)return;b.$vscroll.pqScrollBar("option","cur_pos",h).pqScrollBar("scroll")}}else null!=a?a=this.pageNonVirtual(a,"prevAll"):0<c&&(d=b.iRefresh.getEContHt(),b=b.iMouseSelection,b.updateTableY(d),b.syncScrollBarVert());return{rowIndxPage:a,curPos:h}};g.decrPageSize=function(){var a=this.that,b=a.$tbl.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),
d=a.options.freezeRows,c=0;if(b.length){var e;d?(e=b.filter("tr.pq-last-frozen-row"),e.length&&(e=e.next())):2<=b.length&&(e=f(b[1]));e&&e.length&&(c=a.getRowIndx({$tr:e}).rowIndxPage,c=c-a.pageSize+3,0>c&&(c=0))}return{rowIndxPage:c}};a._calcNumHiddenFrozens=function(){for(var a=0,b=this.options.freezeCols,d=0;d<b;d++)this.colModel[d].hidden&&a++;return a};a._calcNumHiddenUnFrozens=function(a){var b=0;a=null!=a?a:this.colModel.length;for(var d=this.options.freezeCols;d<a;d++)this.colModel[d].hidden&&
b++;return b};a._getSBHeight=function(){return this.iRefresh.getSBHeight()};a._getSBWidth=function(a){return this.iRefresh.getSBWidth()};a._getFirstVisibleRowIndxPage=function(a){for(var b=0,d=a.length;b<d;b++)if(!a[b].pq_hidden)return b};a._getLastVisibleRowIndxPage=function(a){for(var b=a.length-1;0<=b;b--)if(!a[b].pq_hidden)return b;return null};a._getFirstVisibleColIndx=function(){for(var a=this.colModel,b=a.length,d=0;d<b;d++)if(!a[d].hidden)return d;return null};a._getLastVisibleColIndx=function(){for(var a=
this.colModel,b=a.length-1;0<=b;b--)if(!a[b].hidden)return b;return null};a.getTotalVisibleColumns=function(){for(var a=this.colModel,b=a.length,d=0,c=0;c<b;c++)a[c].hidden||d++;return d};a._calcCurPosFromRowIndxPage=function(a){var b=this.options,d=b.groupModel,c=d?this.dataGM:this.pdata,e=b.freezeRows;if(a<e)return 0;for(var b=0,h=e,l=c.length;e<l;e++){var g=c[e];if(!d||!g.groupSummary&&!g.groupTitle){if(h==a)break;h++}g.pq_hidden||b++}return b>=l?null:b};a._calcCurPosFromColIndx=function(a){var b=
this.colModel,d=this.options.freezeCols;if(a<d)return 0;for(var c=0,e=d,h=b.length;d<h;d++){var l=b[d];if(e==a)break;e++;l.hidden||c++}return c>=h?null:c};var u=function(a,b,d){var c=0,e=this.options.numberCell,h=this.colModel;-1==a&&(e.show&&(c=d?c+(parseInt(e.width)+1):c+e.outerWidth),a=0);if(d)for(;a<b;a++){if((d=h[a])&&!d.hidden){if(!d._width)throw"assert failed";c+=d._width+0}}else for(;a<b;a++)(d=h[a])&&!d.hidden&&(c+=d.outerWidth);return c};f.paramquery.pqgrid.calcWidthCols=u;a.calcHeightFrozenRows=
function(){var a=this.$tbl,b=0;a&&a.length&&(a=f(a[0]).find("tr.pq-last-frozen-row"))&&a.length&&(b=a[0],b=b.offsetTop+b.offsetHeight);return b};a._calcRightEdgeCol=function(a){var b=0,d=0,c=this.colModel,e=this.hidearrHS,h=this.options.numberCell;h.show&&(b+=h.outerWidth,d++);for(h=0;h<=a;h++){var l=c[h];l.hidden||!1!=e[h]||(b+=l.outerWidth,d++)}return{width:b,cols:d}};a.nestedCols=function(a,b,d){var c=a.length,e=[];null==b&&(b=1);for(var h=b,l=0,g=0,q=0;q<c;q++){var f=a[q];if(!0===d||!1===d)f.hidden=
d;if(null!=f.colModel&&0<f.colModel.length){var n=this.nestedCols(f.colModel,b+1,f.hidden),e=e.concat(n.colModel);0<n.colSpan?(n.depth>h&&(h=n.depth),f.colSpan=n.colSpan,l+=n.colSpan):(f.colSpan=0,f.hidden=!0);f.childCount=n.childCount;g+=n.childCount}else f.hidden?f.colSpan=0:(f.colSpan=1,l++),f.childCount=0,g++,e.push(f)}return{depth:h,colModel:e,colSpan:l,width:0,childCount:g}};a.getHeadersCells=function(){for(var a=this.options.colModel,b=this.colModel.length,d=this.depth,c=[],e=0;e<d;e++){c[e]=
[];for(var h=0,l=0,g=0;g<b;g++){var q;if(0==e)q=a[h];else{var f=c[e-1][g];q=f.colModel;if(null==q||0==q.length)q=f;else{for(var f=g-f.leftPos,n=0,u=0,k=0;k<q.length;k++)if(n+=0<q[k].childCount?q[k].childCount:1,f<n){u=k;break}q=q[u]}}f=q.childCount?q.childCount:1;g==l?(q.leftPos=g,c[e][g]=q,l+=f,a[h+1]&&h++):c[e][g]=c[e][g-1]}}return this.headerCells=c};a.getDataType=function(){var a=this.colModel;if(a&&a[0])return"string"==typeof a[0].dataIndx?"JSON":"ARRAY";throw"dataType unknown";};a.assignRowSpan=
function(){for(var a=this.colModel.length,b=this.headerCells,d=this.depth,c=0;c<a;c++)for(var e=0;e<d;e++){var h=b[e][c];if(!(0<c&&h==b[e][c-1]||0<e&&h==b[e-1][c])){for(var l=1,g=e+1;g<d;g++)h==b[g][c]&&l++;h.rowSpan=l}}return b};a._autoGenColumns=function(){var a=this.options,b=a.columnTemplate||{},d=b.dataType,c=b.title,e=b.width,b=a.dataModel.data,h=f.paramquery.validation,l=[];b&&b.length&&f.each(b[0],function(a,b){var g="string";h.isInteger(b)?g=-1<b+-1?"float":"integer":h.isDate(b)?g="date":
h.isFloat(b)&&(g="float");l.push({dataType:d?d:g,dataIndx:a,title:c?c:a,width:e?e:100})});a.colModel=l};a._calcThisColModel=function(){var a=this.options,b=a.columnTemplate,d=a.colModel;d||(this._autoGenColumns(),d=a.colModel);a=this.nestedCols(d);this.colModel=a.colModel;this.depth=a.depth;a=this.colModel;d=a.length;if(b)for(var c=0;c<d;c++){var e=a[c],h=f.extend({},b,e,!0);f.extend(e,h,!0)}this.getHeadersCells();this.assignRowSpan();this._refreshDataIndices()};a._createHeader=function(){this.iHeader.createHeader()};
a.createTable=function(a){a.other=!0;this.iGenerateView.generateView(a)};f.widget("paramquery._pqGrid",f.ui.mouse,a)})(jQuery);
(function(f){function k(a){this.that=a}function m(a,b,d){for(var c=0;b<d;b++)!0!==a[b].hidden&&c++;return c}function e(a){if(a.length)var b=a.css({tableLayout:"auto",width:""}).addClass("pq-no-wrap").removeClass("pq-wrap").children("tbody").children(".pq-row-hidden").children("td").css("width","");return b||f()}var c=f.paramquery._pqGrid.prototype;c.getHeaderColumnFromTD=function(a){var b=a.attr("pq-col-indx");a=a.attr("pq-row-indx");var d;null!=b&&null!=a&&(b=parseInt(b),a=parseInt(a),d=this.headerCells[a][b]);
var c=!0;if(!d||d.colModel&&d.colModel.length)c=!1;return{column:d,colIndx:b,rowIndx:a,leaf:c}};c.flex=function(a){this.iResizeColumns.flex(a)};f.paramquery.cHeader=k;c=k.prototype;c.createHeader=function(){var a=this.that,b=this,d=a.options,c=d.bootstrap,e=d.hwrap,g=a.pqpanes,q=parseInt(d.freezeCols),n=d.numberCell,u=a.colModel,p=d.sortModel,k=a.depth,m=d.virtualX,t=a.initH,s=a.finalH,y=a.headerCells,x=a.$header_o;if(null==s)throw"finalH required for _createHeader";if(!1===d.showHeader)x.empty().css("display",
"none");else{x.css("display","");d=(c.on?c.thead:"")+" pq-grid-header-table ";e=["<table class='"+(e?d+"pq-wrap ":d+"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(1<=k){e.push("<tr class='pq-row-hidden'>");n.show&&e.push("<td style='width:"+n.width+"px;' ></td>");for(d=0;d<=s;d++){if(d<t&&d>=q&&m&&(d=t,d>s))throw"initH>finalH";c=u[d];c.hidden||e.push("<td style='width:"+c.outerWidth+"px;' pq-col-indx="+d+"></td>")}e.push("</tr>")}for(c=0;c<k;c++){e.push("<tr class='pq-grid-title-row'>");0==
c&&n.show&&e.push(["<th pq-col-indx='-1' class='pq-grid-number-col' rowspan='",k,"'><div class='pq-td-div'>",n.title?n.title:"&nbsp;","</div></th>"].join(""));for(d=0;d<=s;d++){if(d<t&&d>=q&&m&&(d=t,d>s))throw"initH>finalH";b.createHeaderCell(c,d,y,e,"pq-grid-col ",q,t,k,p)}e.push("</tr>")}a.ovCreateHeader(e,"pq-grid-col ");e.push("</table>");q=e.join("");x.empty();x[0].innerHTML=g.vH?["<span class='pq-grid-header pq-grid-header-left ui-state-default'><div class='pq-grid-header-inner'>",q,"</div></span><span class='pq-grid-header ui-state-default'><div class='pq-grid-header-inner'>",
q,"</div></span>"].join(""):["<span class='pq-grid-header ui-state-default'><div class='pq-grid-header-inner'>",q,"</div></span>"].join("");x=a.$header=x.children(".pq-grid-header");q=x.children(".pq-grid-header-inner");a.$tbl_header=q.children("table");a.$header_left=f(x[0]);a.$header_left_inner=f(q[0]);g.vH&&(a.$header_right=f(x[1]),a.$header_right_inner=f(q[1]));x.click(function(a){return b._onHeaderClick(a)});b._refreshResizeColumn(t,s,u);a._trigger("refreshHeader",null,null)}};c._onHeaderClick=
function(a){var b=this.that;if(!b.iDragColumns||"stop"==b.iDragColumns.status){var d=f(a.target).closest(".pq-grid-col");if(d.length&&(a.stopImmediatePropagation(),d=b.getHeaderColumnFromTD(d),b=d.colIndx,!1!=d.leaf))return this._onHeaderCellClick(b,a)}};c.createHeaderCell=function(a,b,d,c,e,g,q,f,u){var p=d[a][b],k=this.that.colModel,r=p.colSpan;if(!(p.hidden||0<a&&p==d[a-1][b])){if(0<b&&p==d[a][b-1]){if(b>q)return;a:{d=d[a];for(var t=0;t<d.length;t++)if(d[t]==p){d=t;break a}d=void 0}if(d<g)return;
r-=m(k,d,b)}else g&&b<g&&b+r>g&&(r-=m(k,g,q),k=m(k,b,g),r=Math.max(r,k));d=p.halign;t=p.align;k=p.title;k="function"==typeof k?k({column:p,colIndx:b}):k;k=null!=k?k:p.dataIndx;p.pqtitle=k;null!=d?e+=" pq-align-"+d:null!=t&&(e+=" pq-align-"+t);b==g-1&&1==f&&(e+=" pq-last-frozen-col");b<=g-1?e+=" pq-left-col":b>=q&&(e+=" pq-right-col");(g=p.cls)&&(e=e+" "+g);if(null==p.colModel||0==p.colModel.length)e+=" pq-grid-col-leaf";g=u.space?"pq-space":"";c.push(["<th  ","pq-col-indx="+b," ","pq-row-indx="+a,
"  class='",e,"' rowspan=",p.rowSpan," colspan=",r,"><div class='pq-td-div'>",k,"<span class='pq-col-sort-icon ",g,"'></span>",u.number?"<span class='pq-col-sort-count "+g+"'></span>":"","</div></th>"].join(""))}};c._onHeaderCellClick=function(a,b){var d=this.that,c=d.colModel[a],e=d.options,g=c.dataIndx;!1!==d._trigger("headerCellClick",b,{column:c,colIndx:a,dataIndx:g})&&e.sortModel.on&&!1!=c.sortable&&d.sort({sorter:[{dataIndx:g}],addon:!0,evt:b})};c._refreshResizeColumn=function(a,b,d){var c=
this.that,e=c.options,g=e.filterModel.ficon?!0:!1,q=e.numberCell,e=parseInt(e.freezeCols),f=[],u=[],p=c.pqpanes.vH,k=0,m=0;q.show&&(k=q.outerWidth,q.resizable&&f.push("<div pq-col-indx='-1' style='left:",k-5,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>"));for(q=0;q<=b;q++){if(q<a&&q>=e&&(q=a,q>b))throw"initH>finalH";m=d[q];if(!m.hidden){var t=m.ficon,s=t||null==t&&g,t=f,k=k+m.outerWidth;if(!1!==m.resizable||s)p&&q>=e&&(t=u),m=k-5,t.push("<div pq-col-indx='",q,"' style='left:",m,"px;'",
" class='pq-grid-col-resize-handle'>&nbsp;</div>")}}u.length&&c.$header_right_inner.append(u.join(""));c.$header_left_inner.append(f.join(""))};c.refreshHeaderSortIcons=function(){var a=this.that,b=a.$header;if(b){var d=a.iSort.getSorter(),c=d.length,e=!1,g=a.options.sortModel;b.find(".pq-grid-col-leaf").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active active");b.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");g.number&&1<c&&(e=!0);for(g=0;g<
c;g++){var q=d[g],f=a.getColIndx({dataIndx:q.dataIndx}),u=q.dir,q="active ui-state-active pq-col-sort-"+("up"==u?"asc":"desc"),u="ui-icon ui-icon-triangle-1-"+("up"==u?"n":"s")+" glyphicon glyphicon-arrow-"+u,f=b.find(".pq-grid-col-leaf[pq-col-indx="+f+"]");f.addClass(q);f.find(".pq-col-sort-icon").addClass(u);e&&f.find(".pq-col-sort-count").html(g+1)}}};c=function(a){this.that=a;var b=this;a.$header_o.on({mousedown:function(a){if(!a.pq_composed){var d=f(a.target);b.setDraggables(a);a.pq_composed=
!0;a=f.Event("mousedown",a);d.trigger(a)}},dblclick:function(a){b.doubleClick(a)}},".pq-grid-col-resize-handle");var d=a.options.flex;if(d.on&&d.one){var c=a.widgetEventPrefix.toLowerCase(),e=a.eventNamespace;a.element.one(c+"dataready"+e,function(){f(this).one(c+"refresh"+e,function(a){b.belongs(a)&&b.flex()})})}};f.paramquery.cResizeColumns=c;c=c.prototype=new f.paramquery.cClass;c.doubleClick=function(a){var b=this.that.options,d=b.flex;a=f(a.target);a=parseInt(a.attr("pq-col-indx"));isNaN(a)||
d.on&&this.flex(d.all&&!b.scrollModel.autoFit?{}:{colIndx:[a]})};c.flex=function(a){a=a||{};var b=this.that,d=b.options,c=b.element,h=d.virtualX,g=d.freezeCols,q=d.numberCell,d=a.colIndx,n,u=a.dataIndx;a=null==a.refresh?!0:a.refresh;var p=b.initH,k=b.finalH,m=!1,t=b.colModel,s=b.$tbl,y=b.$tbl_header,x=s&&s.length?f(s[0]).clone():f(),w=b.tables&&b.tables.length?b.tables[0].$tbl:null,w=w?f(w[0]).clone():f(),A=y&&y.length?f(y[0]).clone():f();if(null!=u)for(d=[],y=0,s=u.length;y<s;y++){var z=b.colIndxs[u[y]];
null!=z&&d.push(z)}null!=d&&(d.sort(function(a,b){return a-b}),n=d.length);A.find("tr.pq-grid-header-search-row").remove();u=e(x);s=e(w);z=e(A);x=f("<div class='pq-grid' style='width:1px;height:1px;position:absolute;left:0px;top:0px;'>").append(A).append(w).append(x);x.addClass(c.attr("class"));c.parent().append(x);c=q.show?0:-1;for(y=0;y<=k;y++)if(h&&y<p&&y>=g&&(y=p),q=t[y],!q.hidden){c++;if(d)if(d.length)if(d[0]===y)d.splice(0,1);else continue;else break;var w=u[c],A=z[c],F=s[c],w=Math.max(w?w.offsetWidth:
0,F?F.offsetWidth:0,A?A.offsetWidth:0)-0+1;q._width!==w&&(m=!0,q.width=w,1===n&&(q._resized=!0))}x.remove();m&&a&&b.refresh({source:"flex"})};c.setDraggables=function(a){var b=this,d,c,e;f(a.target).draggable({axis:"x",helper:function(a,d){var c=f(a.target),e=parseInt(c.attr("pq-col-indx"));b._setDragLimits(e);b._getDragHelper(a,d);return c},start:function(a,c){d=c.position.left;e=parseInt(b.$cl[0].style.left)},drag:function(a,q){c=q.position.left;b.$cl[0].style.left=e+(c-d)+"px"},stop:function(a,
c){return b.resizeStop(a,c,d)}})};c._getDragHelper=function(a){var b=this.that,d=parseInt(b.options.freezeCols);a=f(a.target);var c=b.$grid_center;a=parseInt(a.attr("pq-col-indx"));var e=c.outerHeight();this.$cl=f("<div class='pq-grid-drag-bar'></div>").appendTo(c);this.$clleft=f("<div class='pq-grid-drag-bar'></div>").appendTo(c);this.$cl.height(e);this.$clleft.height(e);c=f("[pq-col-indx="+a+"]",b.$header)[0];e=c.offsetLeft;b.pqpanes.vH?a>=d&&(e-=b.$header[1].scrollLeft):(e+=b.$header[0].offsetLeft,
e-=b.$header[0].scrollLeft);this.$clleft.css({left:e});e+=c.offsetWidth;this.$cl.css({left:e})};c._setDragLimits=function(a){if(!(0>a)){var b=this.that,d=b.colModel[a],c=b.$header_left;a>=b.options.freezeCols&&b.pqpanes.vH&&(c=b.$header_right);b=c.find("th[pq-col-indx='"+a+"']").offset().left+d._minWidth;d=b+d._maxWidth-d._minWidth;c.find("div.pq-grid-col-resize-handle[pq-col-indx="+a+"]").draggable("option","containment",[b,0,d,0])}};c.resizeStop=function(a,b,d){var c=this.that,e=c.colModel,g=c.options.numberCell;
this.$clleft.remove();this.$cl.remove();d=b.position.left-d;b=f(b.helper);b=parseInt(b.attr("pq-col-indx"));if(-1==b){var e=null,q=parseInt(g.width);g.width=q+d}else e=e[b],q=parseInt(e.width),e.width=q+d,e._resized=!0;c.refresh();c._trigger("columnResize",a,{colIndx:b,column:e,dataIndx:e?e.dataIndx:null,oldWidth:q,newWidth:e?e.width:g.width})};c=function(a){this.that=a;this.$drag_helper=null;var b=a.options.dragColumns,d=b.topIcon,c=b.bottomIcon,e=this;this.status="stop";this.$arrowTop=f("<div class='pq-arrow-down ui-icon "+
d+"'></div>").appendTo(a.element);this.$arrowBottom=f("<div class='pq-arrow-up ui-icon "+c+"' ></div>").appendTo(a.element);this.hideArrows();if(b&&b.enabled)a.$header_o.on("mousedown",".pq-grid-col",function(a,b){if(!f(a.target).is("input,select,textarea")&&!a.pq_composed){e.setDraggables(a,b);a.pq_composed=!0;var d=f.Event("mousedown",a);f(a.target).trigger(d)}})};f.paramquery.cDragColumns=c;c=c.prototype;c.showFeedback=function(a,b){var d=this.that,c=a[0],e=d.$grid_center[0].offsetTop,g=c.offsetLeft-
c.offsetParent.offsetParent.offsetParent.scrollLeft+(b?0:c.offsetWidth)-8,d=e+d.$header[0].offsetHeight;this.$arrowTop.css({left:g,top:e+c.offsetTop-16,display:""});this.$arrowBottom.css({left:g,top:d,display:""})};c.showArrows=function(){this.$arrowTop.show();this.$arrowBottom.show()};c.hideArrows=function(){this.$arrowTop.hide();this.$arrowBottom.hide()};c.updateDragHelper=function(a){var b=this.that.options.dragColumns,d=b.acceptIcon,b=b.rejectIcon,c=this.$drag_helper;c&&(a?(c.children("span.pq-drag-icon").addClass(d).removeClass(b),
c.removeClass("ui-state-error")):(c.children("span.pq-drag-icon").removeClass(d).addClass(b),c.addClass("ui-state-error")))};c.setDraggables=function(a,b){var d=f(a.currentTarget),c=this.that,e=c.options.dragColumns.rejectIcon,g=this;d.hasClass("ui-draggable")||!1!==c.getHeaderColumnFromTD(d).leaf&&d.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:c.element,revert:"invalid",helper:function(){var a=f(this);g.status="helper";g.setDroppables(a);c.$header.find(".pq-grid-col-resize-handle").hide();
var b=a.attr("pq-col-indx"),d=a.attr("pq-row-indx");a.droppable("destroy");a=f("<div class='pq-col-drag-helper ui-widget-content ui-corner-all panel panel-default' ><span class='pq-drag-icon ui-icon "+e+" glyphicon glyphicon-remove'></span>"+c.headerCells[d][b].pqtitle+"</div>");g.$drag_helper=a;return a[0]},drag:function(a,b){g.status="drag";var d=f(".pq-drop-hover",c.$header);if(0<d.length){g.showArrows();g.updateDragHelper(!0);var e=d.width();a.clientX-d.offset().left+f(document).scrollLeft()<
e/2?(g.leftDrop=!0,g.showFeedback(d,!0)):(g.leftDrop=!1,g.showFeedback(d,!1))}else g.hideArrows(),c.$toolbar.hasClass("pq-drop-hover")?g.updateDragHelper(!0):g.updateDragHelper()},stop:function(a,b){g.status="stop";c.$header.find(".pq-grid-col-resize-handle").show();g.hideArrows()}})};c._columnIndexOf=function(a,b){for(var d=0,c=a.length;d<c;d++)if(a[d]==b)return d;return-1};c.setDroppables=function(a){var b=this.that,d=this,c={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(a,
c){if(!d.dropPending){var e=parseInt(c.draggable.attr("pq-col-indx")),h=parseInt(c.draggable.attr("pq-row-indx")),l=f(this),k=parseInt(l.attr("pq-col-indx")),m=parseInt(l.attr("pq-row-indx")),t=b.options.colModel,s=b.headerCells,y=1<s.length,l=s[m][k],x=h?s[h-1][e].colModel:t,k=m?s[m-1][k].colModel:t,h=d._columnIndexOf(x,s[h][e]),s=d.leftDrop?1:0,w=x.splice(h,1)[0],A=d._columnIndexOf(k,l)+1-s;k.splice(A,0,w);d.dropPending=!0;window.setTimeout(function(){b._calcThisColModel();!1!==b._trigger("columnOrder",
null,{dataIndx:w.dataIndx,column:w,oldcolIndx:e,colIndx:y?b.getColIndx({column:w}):A})&&b.refresh();d.dropPending=!1},0)}}};a=b.$header_left.find(".pq-left-col");var e=b.pqpanes.v||b.pqpanes.vH?b.$header_right.find(".pq-right-col"):b.$header_left.find(".pq-right-col");a=a.add(e);a.each(function(a,b){var d=f(b);d.hasClass("ui-droppable")||d.droppable(c)})}})(jQuery);
(function(f){function k(e){var c=this;this.that=e;this.type="detail";this.refreshComplete=!0;this.detachView=!1;var a=e.widgetEventPrefix.toLowerCase(),b=e.eventNamespace;e.element.on(a+"cellclick"+b,function(a,b){if(c.belongs(a))return c.toggle(a,b)}).on(a+"cellkeydown"+b,function(a,b){if(c.belongs(a)&&a.keyCode==f.ui.keyCode.ENTER)return c.toggle(a,b)}).on(a+"refresh"+b,function(a,b){if(c.belongs(a))return c.aftertable()}).on(a+"beforetableview"+b,function(a,b){if(c.belongs(a))return c.beforeTableView(a,
b)}).on(a+"tablewidthchange"+b,function(a,b){if(c.belongs(a))return c.tableWidthChange(a,b)})}f.paramquery.cHierarchy=k;var m=k.prototype=new f.paramquery.cClass;m.tableWidthChange=function(){if(this.refreshComplete){this.refreshComplete=!1;for(var e=this.that.$tbl.children("tbody").children("tr.pq-detail-child").children("td.pq-detail-child"),c=0,a=e.length;c<a;c++)for(var b=f(e[c]).find(".pq-grid"),d=0,l=b.length;d<l;d++){var h=f(b[d]);h.is(":visible")&&h.pqGrid("onWindowResize")}this.refreshComplete=
!0}};m.aftertable=function(e){var c=this.that,a=c.options.detailModel.init,b=c.pdata;if(this.refreshComplete){this.refreshComplete=!1;e=e?e:c.$tbl.children("tbody").children("tr.pq-detail-child");for(var d=0,l=e.length;d<l;d++){var h=f(e[d]),g=h.attr("pq-row-indx"),q=b[g],g=!1,n=q.pq_detail.child;n||"function"!=typeof a||(g=!0,n=a.call(c.element[0],{rowData:q}),q.pq_detail.child=n,q.pq_detail.height=25);h=h.children("td.pq-detail-child");h.append(n);h=h.find(".pq-grid");n=0;for(q=h.length;n<q;n++){var u=
f(h[n]);g?u.hasClass("pq-pending-refresh")&&u.is(":visible")&&(u.removeClass("pq-pending-refresh"),u.pqGrid("refresh")):u.is(":visible")&&u.pqGrid("onWindowResize")}}this.refreshComplete=!0;this.detachView=!1}};m.beforeTableView=function(e,c){this.detachView||(this.detachInitView(),this.detachView=!0)};m.detachInitView=function(e){var c=this.that.$tbl;if(c&&c.length)for(e=e?e:c.children("tbody").children("tr.pq-detail-child"),c=0;c<e.length;c++)f(e[c]).children("td.pq-detail-child").children().detach()};
m.toggle=function(e,c){var a=this.that,b=c.column,d=c.rowData,l=c.rowIndx,h=this.type;b&&b.type===h&&(b={rowIndx:l,focus:!0},null==d.pq_detail?a.rowExpand(b):!1===d.pq_detail.show?a.rowExpand(b):this.rowCollapse(b))};m.rowExpand=function(e){this.normalize(e);var c=this.that,a=e.rowData,b=e.rowIndx,d=e.rowIndxPage,l=c.options.detailModel;if(null!=a){if(!1===c._trigger("beforeRowExpand",null,e))return!1;null==a.pq_detail?a.pq_detail={show:!0}:!1===a.pq_detail.show&&(a.pq_detail.show=!0);l.cache||this.rowInvalidate(e);
c.refreshRow({rowIndx:b});l=[];c.iGenerateView._generateDetailRow(a,d,c.colModel,l,null,!1);a=c.getRow({rowIndxPage:d});a.after(l.join(""));this.aftertable(a.next());e.focus&&c.getCell({rowIndx:b,dataIndx:"pq_detail"}).attr("tabindex","0").focus();e.scrollRow&&this.scrollRow({rowIndx:b})}};m.rowInvalidate=function(e){e=this.that.getRowData(e);var c=e.pq_detail;if(c=c?c.child:null)c.remove(),e.pq_detail.child=null,e.pq_detail.height=0};m.normalize=function(e){var c=this.that,a=e.rowIndx,b=e.rowIndxPage,
d=c.rowIndxOffset;e.rowIndx=null==a?b+d:a;e.rowIndxPage=null==b?a-d:b;e.rowData=c.getRowData(e)};m.rowCollapse=function(e){this.normalize(e);var c=this.that,a=c.options,b=e.rowData,d=e.rowIndx,l=e.rowIndxPage,h=a.detailModel;null!=b&&null!=b.pq_detail&&!0===b.pq_detail.show&&(h.cache||this.rowInvalidate(e),b.pq_detail.show=!1,a.virtualY?c.refresh():(a=c.getRow({rowIndxPage:l}).next("tr.pq-detail-child"),a.length&&(this.detachInitView(a),a.remove(),c.refreshRow({rowIndx:d})),e.focus&&c.getCell({rowIndx:d,
dataIndx:"pq_detail"}).attr("tabindex","0").focus()),e.scrollRow&&(d=e.rowIndx,this.scrollRow({rowIndx:d})))}})(jQuery);
(function(f){var k=f.paramquery.pqgrid.calcWidthCols,m=function(e){this.that=e};f.paramquery.cRefresh=m;m=m.prototype;m._computeOuterWidths=function(){for(var e=this.that,c=e.options.numberCell,e=e.colModel,a=e.length,b=0;b<a;b++){var d=e[b];d.outerWidth=d._width+0}c.show&&(c.outerWidth=c.width)};m.autoFit=function(){var e=this.that,c=e.colModel,a=c.length,e=k.call(e,-1,a,!0),b=this.contWd-this.getSBWidth();if(e!==b){for(var e=e-b,d,b=[],l=0;l<a;l++){var h=c[l],g=h._percent,f=h._resized;h.hidden||
g||f||(0>e?(g=h._maxWidth-h._width)&&b.push({availWd:-1*g,colIndx:l}):(g=h._width-h._minWidth)&&b.push({availWd:g,colIndx:l}));f&&(d=h,delete h._resized)}b.sort(function(a,b){return a.availWd>b.availWd?1:a.availWd<b.availWd?-1:0});l=0;for(a=b.length;l<a;l++){var h=b[l],g=h.availWd,h=h.colIndx,f=Math.round(e/(a-l)),h=c[h],n;n=h._width;Math.abs(g)>Math.abs(f)?(n-=f,e-=f):(n-=g,e-=g);h.width=h._width=n}0!=e&&d&&(n=d._width-e,n>d._maxWidth?n=d._maxWidth:n<d._minWidth&&(n=d._minWidth),d.width=d._width=
n)}};m.autoLastColumn=function(){var e=this.that,c=e.colModel,a=c.length,b=e.options.freezeCols,d=this.contWd-this.getSBWidth(),l=k.call(e,-1,b,!0),d=d-l,l=!1,e=e._getLastVisibleColIndx();if(null!=e&&(e=c[e],!e._percent)){for(var h=e._width,g,f=e._minWidth,n=e._maxWidth,a=a-1;a>=b;a--){var u=c[a];if(!u.hidden&&(u=u._width+0,d-=u,0>d)){l=!0;g=h+d>=f?h+d:h+u+d;break}}l||(g=h+d);g>n?g=n:g<f&&(g=f);e.width=e._width=g}};m.numericVal=function(e,c){var a;a=-1<(e+"").indexOf("%")?parseInt(e)*c/100:parseInt(e);
return Math.round(a)};m.refreshColumnWidths=function(e){e=e||{};var c=this.that,a=c.options,b=a.numberCell,d="flex"===a.width,l=c.colModel,h=a.scrollModel,g=h.lastColumn,h=h.autoFit,f=this.contWd,n=l.length,u=this.getSBWidth(),k=a._minColWidth,m=a._maxColWidth,r=0;b.show&&(b.width<b.minWidth&&(b.width=b.minWidth),b.outerWidth=b.width+1,r=b.outerWidth);b=d?null:f-u-r;k=Math.floor(this.numericVal(k,b));m=Math.ceil(this.numericVal(m,b));f=0;if(!d&&5>b||isNaN(b)){if(a.debug)throw"availWidth N/A";}else{delete c.percentColumn;
for(u=0;u<n;u++)if(r=l[u],!r.hidden){var t=r.width,s=-1<(t+"").indexOf("%")?!0:null,y=r.minWidth,x=r.maxWidth,y=y?this.numericVal(y,b):k,x=x?this.numericVal(x,b):m;x<y&&(x=y);if(void 0!=t){var w=0;!d&&s?(c.percentColumn=!0,r.resizable=!1,r._percent=!0,t=this.numericVal(t,b)-0,w=Math.floor(t),f+=t-w,1<=f&&(w+=1,f-=1)):t&&(w=parseInt(t));w<y?w=y:!d&&w>x&&(w=x);r._width=w}else r._width=y;s||(r.width=r._width);r._minWidth=y;r._maxWidth=d?1E3:x}!1===d&&!1!==e.refreshWidth&&(h&&this.autoFit(),"auto"===
g&&a.virtualX&&this.autoLastColumn());this._computeOuterWidths()}};m.estRowsInViewPort=function(){var e=Math.ceil(this.contHt/this.rowHt);return this.that.pageSize=e};m._refreshFrozenLine=function(){};m._refreshHideArrHS=function(){for(var e=this.that,c=e.colModel,a=e.hidearrHS,b=e.initH,d=e.finalH,l=parseInt(e.options.freezeCols),e=0;e<l;e++)a[e]=!1;for(e=l;e<b;e++)a[e]=!0;for(e=b;e<=d;e++)a[e]=!1;e=d+1;for(c=c.length;e<c;e++)a[e]=!0};m.setScrollVNumEles=function(e){var c=this.that;e=c.$vscroll;
var a=c.options;if(!a.maxHeight&&"flex"===a.height)return e.pqScrollBar("option","num_eles",0),0;var b=c.iHierarchy?!0:!1,d=e.pqScrollBar("option"),l=parseInt(d.num_eles),d=parseInt(d.cur_pos),l=this.getEContHt(),a=(a.groupModel?c.dataGM:c.pdata)?c.totalVisibleRows:0,h,g=0;c.$tbl&&0<c.$tbl.length&&(h=c.$tbl[c.$tbl.length-1],g=h.scrollHeight,h=f(h));if(0<g){h=h.children().children("tr");d=c=0;for(g=1;g<h.length;g++){var q=h[g],c=c+q.offsetHeight;if(c>=l){b&&f(q).hasClass("pq-detail-child")&&(d=1<d?
d-1:1);break}else b?!1===f(q).hasClass("pq-detail-child")&&d++:d++}l=a-d+1}else l=d+1;l>a&&(l=a);e.pqScrollBar("option","num_eles",l);return l};m._setScrollVLength=function(e){e=this.that;var c=e.options;if("flex"!==c.height||c.maxHeight){var c=this.getSBHeight(),a=this.contHt-c+this.headerHt-2;e.$vscroll.css("bottom",c).pqScrollBar("option","length",a)}};m.setHeaderHeight=function(){var e=this.that,c=e.$header,a,b,d;if(c&&c.length){if(1<c.length){if(a=c[0].offsetHeight,b=c[1].offsetHeight,d=Math.max(a,
b),a!==b){var l=f(c[0]).find(".pq-grid-header-search-row"),h=f(c[1]).find(".pq-grid-header-search-row");l.css("height","");h.css("height","");a=c[0].offsetHeight;b=c[1].offsetHeight;d=Math.max(a,b);a<d?l.height(h[0].offsetHeight):h.height(l[0].offsetHeight)}}else d=a=c[0].offsetHeight;e.$header_o.height(d-2);this.headerHt=d}else e.$header_o.height(0),this.headerHt=0};m.initContHeight=function(){var e=this.that,c=e.options;if("flex"!=c.height||c.maxHeight)this.contHt=this.height-(c.showHeader?this.rowHt:
0)-(c.showTop?e.$top[0].offsetHeight:0)-(c.showBottom?e.$bottom[0].offsetHeight:0)};m.initContWidth=function(){var e=this.that.options;if("flex"!==e.width||e.maxWidth)this.contWd=this.width};m.setContHeight=function(e){e=this.that;var c=this.height-e.$header_o[0].offsetHeight-(e.options.showTop?e.$top[0].offsetHeight:0)-e.$bottom[0].offsetHeight;e.$cont.height(c);this.contHt=c};m.setContAndGridHeightForFlex=function(){var e=this.that;if(this.vscroll)e.$hscroll.css("position","");else{e.$hscroll.css("position",
"relative");var c=e.$cont,a=e.options.cls,b=c.children("."+a.cont_inner_b);c.height("");b.length||(b=c.children("."+a.cont_inner));b.height("");e.element.height("");e.$grid_center.height("")}};m.setContAndGridWidthFromTable=function(){var e=this.that,c=k.call(e,-1,e.colModel.length),e=e.element,a=this.getSBWidth();this.contWd=c+a;e.width(this.contWd+"px")};m.getTotalVisibleRows=function(e,c,a){var b=this.that,d=this.estRowsInViewPort(),l=0,h=a?a.length:0,g=c,f=0,n=0,k=null,p=!1,m=!1,r=b.iHierarchy?
!0:!1,b=b.options,t=b.detailModel.offset,s=0,y=this.rowHt,x=r?this.contHt:void 0;if(null==a||0==h)return{initV:null,finalV:null,tvRows:l,lastFrozenRow:null};for(var w=0,A=h>c?c:h;w<A;w++){var z=a[w],F=z.pq_hidden;F||(k=w,l++,r&&((z=z.pq_detail)&&z.show?(z=z.height||0,z>t&&(z=t),s+=z+y):s+=y))}if(h<c)return{initV:k,finalV:k,tvRows:l,lastFrozenRow:k};if(1E4<h&&null==b.groupModel)return f=e+d,f>=h&&(f=h-1),{initV:e+c,finalV:f,tvRows:h,lastFrozenRow:k};d-=l;w=c;for(A=h;w<A;w++)z=a[w],F=z.pq_hidden,p?
m||(F?f++:n===d?m=!0:(f++,n++)):F?g++:n===e?(p=!0,f=g,n=0):(g++,n++),F||(l++,r&&p&&((z=z.pq_detail)&&z.show?(z=z.height||0,z>t&&(z=t),s+=z+y):s+=y,s>x&&(m=!0)));g>=h&&(g=h-1);f<g&&(f=g);return{initV:g,finalV:f,tvRows:l,lastFrozenRow:k}};m.calcInitFinal=function(){var e=this.that,c=e.options,a=c.virtualY,b=c.freezeRows,d="flex"===c.height,l=c.groupModel?e.dataGM:e.pdata;if(null==l||0===l.length)b=this.getTotalVisibleRows(h,b,l),e.totalVisibleRows=b.tvRows,e.initV=b.initV,e.finalV=b.finalV,e.lastFrozenRow=
b.lastFrozenRow;else if(a){var a=e.$vscroll.pqScrollBar("option"),h=parseInt(a.cur_pos);if(isNaN(h)||0>h)throw"cur_pos NA";e.scrollCurPos=h;b=this.getTotalVisibleRows(h,b,l);e.totalVisibleRows=b.tvRows;e.initV=b.initV;e.lastFrozenRow=b.lastFrozenRow;e.finalV=d&&!c.maxHeight?l.length-1:b.finalV}else b=this.getTotalVisibleRows(0,b,l),e.lastFrozenRow=b.lastFrozenRow,e.totalVisibleRows=b.tvRows,e.initV=0,e.finalV=l.length-1};m.calcInitFinalH=function(){var e=this.that,c=e.options,a=c.virtualX,b=e.colModel,
d=b.length;if(a){for(var l=parseInt(e.$hscroll.pqScrollBar("option","cur_pos")),h=parseInt(c.freezeCols),g="flex"===c.width,f=h,n=0,u=h;u<d;u++)if(b[u].hidden)f++;else if(n===l)break;else f++,n++;f>d-1&&(f=d-1);e.initH=f;if(g||!a)e.finalH=d-1;else{a=k.call(e,-1,h);l=this.getEContWd();for(u=f;u<d;u++)if(f=b[u],!f.hidden){f=f.outerWidth;if(!f&&c.debug)throw"outerwidth N/A";a+=f;if(a>l)break}c=u;c>d-1&&(c=d-1);e.finalH=c}}else e.initH=0,e.finalH=d-1};m._calcOffset=function(e){return(e=/(-|\+)([0-9]+)/.exec(e))&&
3===e.length?parseInt(e[1]+e[2]):0};m.setMax=function(e){var c=this.that,a=c.element;(c=c.options[e])?(c==parseInt(c)&&(c+="px"),a.css(e,c)):a.css(e,"")};m.refreshGridWidthAndHeight=function(){var e=this.that,c=e.options,a,b,d=-1<(c.width+"").indexOf("%")?!0:!1,l=-1<(c.height+"").indexOf("%")?!0:!1,h=-1<(c.maxHeight+"").indexOf("%")?!0:!1,g="flex"==c.height,q=h&&g,n=-1<(c.maxWidth+"").indexOf("%")?!0:!1,k="flex"==c.width,p=n&&k,e=e.element;if(d||l||q||p){var m=e.parent();if(!m.length)return;var r;
m[0]==document.body||"fixed"==e.css("position")?(r=f(window).width(),m=window.innerHeight?window.innerHeight:f(window).height()):(r=m.width(),m=m.height());var t=this._calcOffset,s=d?t(c.width):0,t=l?t(c.height):0;p?a=parseInt(c.maxWidth)*r/100:d&&(a=parseInt(c.width)*r/100+s);q?b=parseInt(c.maxHeight)*m/100:l&&(b=parseInt(c.height)*m/100+t)}a||(k&&c.maxWidth?n||(a=c.maxWidth):d||(a=c.width));b||(g&&c.maxHeight?h||(b=c.maxHeight):l||(b=c.height));parseFloat(a)==a?(a=a<c.minWidth?c.minWidth:a,e.css("width",
a)):"auto"===a&&e.width(a);parseFloat(b)==b&&(b=b<c.minHeight?c.minHeight:b,e.css("height",b));this.width=Math.round(e.width());this.height=Math.round(e.height())};m.decidePanes=function(){var e=this.that,c=e.pqpanes={v:!1,h:!1,vH:!1},a=e.options,e=a.virtualX,b=a.virtualY,d="flex"==a.height&&!a.maxHeight,l="flex"==a.width&&!a.maxWidth,h=a.numberCell,g=a.freezeRows,a=a.freezeCols;!g||d||!a&&!h.show||l?g&&!d?b||(c.h=!0):!a&&!h.show||l||e||(c.v=!0,c.vH=!0):(b||(c.h=!0),e||(c.v=!0,c.vH=!0))};m._storeColumnWidths=
function(e){for(var c=this.that,a=c.options,b=c.colModel,d=a.virtualX,a=a.freezeCols,l=c.initH,c=e?b.length-1:c.finalH,h=[],g=0;g<=c;g++)!e&&d&&g<l&&g>=a&&(g=l),h[g]={outerWidth:b[g].outerWidth};return h};m._isColumnWidthChanged=function(e){for(var c=this.that,a=c.colModel,b=c.options,d=b.virtualX,b=b.freezeCols,l=c.initH,c=c.finalH,h=0;h<=c;h++)if(d&&h<l&&h>=b&&(h=l),a[h].outerWidth!==e[h].outerWidth)return!0;return!1};m.softRefresh=function(){var e=this.that,c=e.options;this.refreshScrollbars();
e.iGenerateView.setPanes();e._saveDims();e.iMouseSelection.syncScrollBarVert();"flex"==c.height&&this.setContAndGridHeightForFlex();"flex"==c.width&&this.setContAndGridWidthFromTable();this._refreshFrozenLine()};m.refreshScrollbars=function(e){e=e||{};var c=this.that,a=c.options,b="flex"===a.height,d="flex"===a.width;if((b||this.contHt)&&(d||this.contWd)&&null!==c.totalVisibleRows){var l=this.setScrollVNumEles(e),l=1<l?!0:!1;if((!b||a.maxHeight)&&l!==this.vscroll)if(this.vscroll=l,a.scrollModel.autoFit||
a.virtualX||d){if(a=this._storeColumnWidths(),this.refreshColumnWidths(),this._isColumnWidthChanged(a)||d)this.ignoreTResize=!0,this._refreshTableWidths(a,{table:!0,header:!0}),delete this.ignoreTResize,this.setHeaderHeight(),this.setContHeight(),c.iGenerateView.setPanes(),l=this.setScrollVNumEles(!0),this.vscroll=1<l?!0:!1}else c.iGenerateView.setPanes();l=this.setScrollHNumEles();this.hscroll=1<l?!0:!1;this._setScrollHLength();this._setScrollVLength(e);this._setScrollHVLength()}};m._setScrollHVLength=
function(){var e=this.that;this.vscroll&&this.hscroll||e.$hvscroll.css("visibility","hidden")};m._setScrollHLength=function(){var e=this.that,c=e.$hscroll,a=e.$hvscroll;e.options.scrollModel.horizontal?(c.css("visibility",""),a.css("visibility",""),e=this.contWd,a=this.getSBWidth(),c.css("right",0===a?0:""),c.pqScrollBar("option","length",e-a)):(c.css("visibility","hidden"),a.css("visibility","hidden"))};m.estVscroll=function(){var e=this.that,c=!0;null==e.totalVisibleRows||null==this.contHt?c=!1:
e.totalVisibleRows*this.rowHt<this.contHt&&(c=!1);this.vscroll=c};m.getSBWidth=function(){null==this.vscroll&&this.estVscroll();return this.vscroll?17:0};m.estHscroll=function(){var e=this.that;if(null==this.contWd)throw"failed";var c=!1;1<this.calcColsOutsideCont(e.colModel)+1&&(c=!0);this.hscroll=c};m.getSBHeight=function(){if("flex"===this.that.options.width)return 0;null==this.hscroll&&this.estHscroll();return this.hscroll?17:0};m.getEContHt=function(){if(null==this.contHt)throw"contHt N/A";return this.contHt-
this.getSBHeight()};m.getEContWd=function(){if(null==this.contWd)throw"contWd N/A";return this.contWd-this.getSBWidth()};m.calcColsOutsideCont=function(e){var c=this.that.options,a=c.numberCell,c=c.freezeCols,b=this.contWd-this.getSBWidth(),d=0;a.show&&(d+=a.outerWidth);for(a=0;a<e.length;a++){var l=e[a];l.hidden||(d+=l.outerWidth)}var h=0,g=0,l=Math.round(d);l>b&&g++;for(a=c;a<e.length;a++)if(l=e[a],!l.hidden)if(h+=l.outerWidth,l=d-h,l>b)g++;else break;return g};m.setScrollHNumEles=function(){var e=
this.that,c=e.options,a=e.colModel,b=c.scrollModel,d=0;if("flex"!==c.width||c.maxWidth)d="fullScroll"===b.lastColumn?a.length-c.freezeCols-e._calcNumHiddenUnFrozens():this.calcColsOutsideCont(a)+1;e.$hscroll.pqScrollBar("option","num_eles",d);return d};m.init=function(){var e=this.that,c=e.options;this.hscroll=this.vscroll=this.contHt=this.contWd=null;e.initH=e.initV=e.finalH=e.finalV=null;e.totalVisibleRows=e.lastFrozenRow=null;this.rowHt=c.rowHeight;this.headerHt=0;this.height=null};m.refresh=function(e){e=
e||{};var c=this.that,a=e.header,b=e.table,d=e.pager,l=c.iGenerateView,h=c.element;if(h[0].offsetWidth){c.iMouseSelection.resetMargins();this.init();h=c.options;this.decidePanes();h.collapsible._collapsed=!1;this.setMax("maxHeight");this.refreshGridWidthAndHeight();this.initContHeight();this.initContWidth();this.calcInitFinal();if(!1===a||!1===b)var g=this._storeColumnWidths(!0);this.refreshColumnWidths();this.calcInitFinalH();this._refreshHideArrHS();!1!==a?c._createHeader():this._isColumnWidthChanged(g)&&
this._refreshTableWidths(g,{header:!0});c._refreshHeaderSortIcons();!1!==d&&c._refreshPager();this.setHeaderHeight();this.setContHeight();!1!==b?l.generateView({source:e.source}):(this._refreshTableWidths(g,{table:!0}),l.setPanes());c._saveDims();l.scrollView();this.refreshScrollbars();"flex"==h.height&&this.setContAndGridHeightForFlex();"flex"==h.width&&this.setContAndGridWidthFromTable();this._refreshFrozenLine();c._createCollapse();h.dataModel.postDataOnce=void 0}else h.addClass("pq-pending-refresh")};
m.refreshVscroll=function(e){e=this.that;var c=e.options;c.virtualY&&!c.scrollModel.smooth&&(e.scrollMode=!0,this.calcInitFinal(),e.iGenerateView.generateView(),e._saveDims(),e.iGenerateView.scrollView(),1>=this.setScrollVNumEles()&&this.refreshScrollbars())};m._refreshTableWidths=function(e,c){var a=this.that,b=a.colModel,d=a.$tbl_header,l=c.header&&d,h=a.$tbl,g=c.table&&h,f=a.options,n=f.freezeCols,f=f.virtualX,k=a.initH,p=a.finalH,d=l?d.children().children(".pq-row-hidden"):null,m=l?a.$header.find(".pq-grid-col-resize-handle"):
null,h=g&&h?h.children().children(".pq-row-hidden"):null,r,t=!1,s=0;g&&a.tables.length&&(g=a.tables[0].$tbl.children().children(".pq-row-hidden"),h=h?h.add(g):g);for(g=0;g<=p;g++){f&&g<k&&g>=n&&(g=k);var y=b[g],x=e[g];y.hidden||(x=x.outerWidth,y=y.outerWidth,y!==x&&(l&&(r=d.find("td[pq-col-indx="+g+"]"),r.width(y)),h&&(r=h.find("td[pq-col-indx="+g+"]"),r.length&&(t=!0,r.width(y)))),s+=y-x,l&&0!==s&&(x=m.filter("[pq-col-indx="+g+"]"),y=parseInt(x.css("left")),x.css("left",y+s)))}t&&a._trigger("tableWidthChange");
a._saveDims()}})(jQuery);
(function(f){var k={getFocusElement:function(){var a=document.activeElement;if(a){var a=f(a),d=a.closest(".pq-grid");if(d.length)return d[0]==this.element[0]?{$ae:a,$grid:d}:{$ae:a,$childGrid:d}}},rowExpand:function(a){this.iHierarchy.rowExpand(a)},rowInvalidate:function(a){this.iHierarchy.rowInvalidate(a)},rowCollapse:function(a){this.iHierarchy.rowCollapse(a)},saveState:function(a){a=a||{};var d=this.options,c=d.dataModel,e=this.element[0].id,d=JSON.stringify({colModel:d.colModel,height:d.height,
width:d.width,groupModel:d.groupModel,pageModel:d.pageModel,sortModel:d.sortModel,filter:c.dataUF&&c.dataUF.length?!0:!1});!1!==a.save&&"undefined"!==typeof Storage&&localStorage.setItem("pq-grid"+(e?e:""),d);return d},loadState:function(a){a=a||{};if("undefined"===typeof Storage)return!1;var d=this.element[0].id;if(d=a.state||localStorage.getItem("pq-grid"+(d?d:"")))"string"==typeof d&&(d=JSON.parse(d));else return!1;for(var c=this.colModel,e=d.colModel,e=this.nestedCols(e).colModel,g=0,q=e.length;g<
q;g++){var n=e[g],k=n.dataIndx;a:{for(var p=0,m=c.length;p<m;p++){var r=c[p];if(k==r.dataIndx){k=r;break a}}k=void 0}f.extend(!0,k,n);f.extend(!0,n,k)}this.option({colModel:e,height:d.height,width:d.width,sortModel:d.sortModel,pageModel:d.pageModel,groupModel:d.groupModel});!1!==a.refresh&&this.refreshDataAndView();return!0}},m=function(a){function d(d,c,e){a.filter({data:[{dataIndx:d,value:c,value2:e}]})}this.that=a;var c=this;this.dataHS={};var e=a.widgetEventPrefix.toLowerCase(),g=a.eventNamespace;
a.element.on(e+"headerkeydown"+g,function(a,b){if(c.belongs(a)){var d=f(a.originalEvent.target);return d.hasClass("pq-grid-hd-search-field")?c.onKeyDown(a,b,d):!0}});a.element.on(e+"createheader"+g,function(a,b){if(c.belongs(a))return c._onCreateHeader()});this.changeListener={change:function(a,b){d(b.dataIndx,b.value,b.value2)}};this.keyupListener={keyup:function(a,b){d(b.dataIndx,b.value,b.value2)}};this.clickListener={click:function(a,b){d(b.dataIndx,b.value)}}},e=m.prototype=new f.paramquery.cClass;
e.get$Ele=function(a,d){var c=this.that,e=c.options.freezeCols,g=f(c.$tbl_header[0]),q=".pq-grid-hd-search-field[name='"+d+"']",c=f(c.$tbl_header[2==c.$tbl_header.length?1:0]);return a>=e?c.find(q):g.find(q)};e.onKeyDown=function(a,d,c){d=this.that;if(a.keyCode===f.ui.keyCode.TAB){var e=c.attr("name"),g=d.getColIndx({dataIndx:e}),q=d.colModel,n,k=a.shiftKey,p=q[g];if("between"==p.filter.condition&&(d.scrollColumn({colIndx:g}),e=this.get$Ele(g,e),e[0]==c[0]?k||(n=e[1]):k&&(n=e[0]),n))return n.focus(),
a.preventDefault(),!1;do{k?g--:g++;if(0>g||g>=q.length)break;p=q[g];c=p.filter;if(!p.hidden&&c){d.scrollColumn({colIndx:g});e=p.dataIndx;n=this.get$Ele(g,e);"between"==c.condition&&(n=k?f(n[1]):f(n[0]));if(n)return n.focus(),a.preventDefault(),!1;break}}while(1)}else return!0};e._bindFocus=function(){function a(b){b=f(b.target).closest(".pq-grid-hd-search-field").attr("name");if(d.scrollColumn({dataIndx:b})){var e=d.getColIndx({dataIndx:b});c.get$Ele(e,b).focus()}}for(var d=this.that,c=this,e=d.$header.find(".pq-grid-header-search-row"),
g=0;g<e.length;g++)f(e[g]).on("focusin",a)};e._onCreateHeader=function(){var a=this.that,d=a.options;if(d.filterModel.header){this._bindFocus();var c=a.colModel,e=d.freezeCols,g=d.virtualX,q=d.virtualXHeader,d=!1===q?a.initHH:a.initH,q=!1===q?a.finalHH:a.finalH,n=a.$tbl_header,k=f(n[0]),p=f(n[1]),m="input,select";if(1<n.length){k.find(m).css("visibility","hidden");for(var r=0;r<e;r++){var t=c[r],m="*[name='"+t.dataIndx+"']";k.find(m).css("visibility","visible");p.find(m).css("visibility","hidden")}}for(r=
0;r<=q;r++){if(r<d&&r>=e&&g&&(r=d,r>q))throw"initH>finalH";t=c[r];if(!t.hidden){var s=t.filter;if(s){var m=t.dataIndx,y=k;r>=e&&1<n.length&&(y=p);y=y.find("*[name='"+m+"']");if(0!=y.length){var x=s.type,w=s.value,A=s.value2;"checkbox"==x&&"triple"==s.subtype?y.pqval({val:w}):"select"==x&&null!=w&&y.val(w);(x=s.init)&&x.call(y,{dataIndx:m,column:t});if(t=s.listeners)for(s=0;s<t.length;s++){x=t[s];"string"==typeof x&&(x=this[x+"Listener"]);for(var z in x)(function(d,c,e){d.bind(z,function(h){var l=
a.getColumn({dataIndx:e}),g=l.filter;"checkbox"==g.type?w="triple"==g.subtype?d.pqval({incr:!0}):d.is(":checked")?!0:!1:"between"==g.condition?(w=f(d[0]).val(),A=f(d[1]).val()):w=d.val();return c.call(this,h,{column:l,dataIndx:e,value:w,value2:A})})})(y,x[z],m)}}}}}}};e.createDOM=function(a,d){var c=this.that,e=c.options,g=e.virtualX,q=e.virtualXHeader,n=!1===q?c.initHH:c.initH,q=!1===q?c.finalHH:c.finalH,k=e.freezeCols,p=c.colModel,m=e.numberCell,e=function(a,b){return["<div class='pq-from-div'>",
a,"</div><span class='pq-from-to-center'>-</span><div class='pq-to-div'>",b,"</div>"].join("")};a.push("<tr class='pq-grid-header-search-row'>");m.show&&a.push("<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='1'><div class='pq-td-div'>&nbsp;</div></td>");for(m=0;m<=q;m++){if(m<n&&m>=k&&g&&(m=n,m>q))throw"initH>finalH";var r=p[m];if(!r.hidden){var t=d,s=r.halign;s||(s=r.align);"right"==s?t+=" pq-align-right":"center"==s&&(t+=" pq-align-center");(s=r.cls)&&(t=t+" "+s);if(s=r.filter){var y=
r.dataIndx,x=s.type,w=s.value,A=s.condition,z=s.cls,z="pq-grid-hd-search-field "+(z?z:""),F=s.style,F=F?F:"",B=s.attr,B=B?B:"",E="";if("between"==A)var C=s.value2,C=null!=C?C:"";"textbox"===x?(w=w?w:"",z+=" ui-corner-all pq-search-txt",E="between"==A?e(this._input(y,w,z+" pq-from",F,B),this._input(y,C,z+" pq-to",F,B)):this._input(y,w,z,F,B)):"textarea"===x?(w=w?w:"",z+=" ui-corner-all pq-search-txt",E="between"==A?e(this._textarea(y,w,z+" pq-from",F,B),this._textarea(y,C,z+" pq-to",F,B)):this._textarea(y,
w,z,F,B)):"select"===x?s.cache?E=s.cache:(x=s.options,"function"===typeof x&&(x=x.call(c.element[0],{column:r,value:w,dataIndx:y,cls:z,style:F,attr:B})),z+=" ui-corner-all",r=["name='",y,"' class='",z,"' style='",F,"' ",B].join(""),E=f.paramquery.select({options:x,attr:r,prepend:s.prepend,valueIndx:s.valueIndx,labelIndx:s.labelIndx,groupIndx:s.groupIndx}),s.cache=E):"checkbox"==x?E=["<input ",null==w||!1==w?"":"checked=checked"," name='",y,"' type=checkbox class='"+z+"' style='"+F+"' "+B+"/>"].join(""):
"string"==typeof x?E=x:"function"==typeof x&&(E=x.call(c.element[0],{width:r.outerWidth,value:w,value2:C,column:r,dataIndx:y,cls:z,attr:B,style:F}));a.push(["<td class='",t,"'><div class='pq-td-div' >",E,"</div></td>"].join(""))}else a.push(["<td class='",t,"'><div class='pq-td-div' >&nbsp;</div></td>"].join(""))}}a.push("</tr>")};e._input=function(a,d,c,e,g){return['<input value="',d,"\" name='",a,"' type=text style='"+e+"' class='"+c+"' "+g+" />"].join("")};e._textarea=function(a,d,c,e,g){return["<textarea name='",
a,"' style='"+e+"' class='"+c+"' "+g+" >",d,"</textarea>"].join("")};f.paramquery.select=function(a){var d=a.options,c=a.groupIndx,e=a.labelIndx,g=a.valueIndx,f=null!=e&&null!=g,n=null!=c,k=a.prepend,m=a.dataMap,v,r,t;a=["<select ",a.attr," >"];if(k)for(var s in k)a.push('<option value="',s,'">',k[s],"</option>");if(d&&d.length){for(var k=0,y=d.length;k<y;k++){var x=d[k];if(f){var w=x[g],A=x.pq_disabled?'disabled="disabled" ':"",z=x.pq_selected?'selected="selected" ':"";if(null!=w){if(m){v={};for(t=
0;t<m.length;t++){var F=m[t];v[F]=x[F]}v="data-map='"+JSON.stringify(v)+"'"}else v="";t=v;n&&(F=x.pq_disabled_group?'disabled="disabled" ':"",v=x[c],r!=v&&(null!=r&&a.push("</optgroup>"),a.push('<optgroup label="',v,'" ',F," >"),r=v));e==g?a.push("<option ",z,A,t,">",w,"</option>"):a.push("<option ",z,A,t,' value="',w,'">',x[e],"</option>")}}else if("object"==typeof x)for(s in x)a.push('<option value="',s,'">',x[s],"</option>");else a.push("<option>",x,"</option>")}n&&a.push("</optgroup>")}a.push("</select>");
return a.join("")};f.fn.pqval=function(a){if(a){if(a.incr)return a=this.data("pq_value"),this.prop("indeterminate",!1),a?(a=!1,this.prop("checked",!1)):!1===a?(a=null,this.prop("indeterminate",!0),this.prop("checked",!1)):(a=!0,this.prop("checked",!0)),this.data("pq_value",a),a;a=a.val;this.data("pq_value",a);this.prop("indeterminate",!1);null==a?(this.prop("indeterminate",!0),this.prop("checked",!1)):a?this.prop("checked",!0):this.prop("checked",!1);return this}return this.data("pq_value")};var c=
{_generateTitleRow:function(a,d,c,e){var g=this.that.options.numberCell,f=d.groupTitle,n=d.level,k=d.GMRowIndx,m=a.title,v=a.icon,v=(v=v?v[n]:null)&&v.length&&2==v.length&&"function"===typeof v.push?v:["ui-icon-minus glyphicon glyphicon-minus","ui-icon-plus glyphicon glyphicon-plus"];if(m&&null!=m[n]){m=m[n];if(!1===m)return;"function"==typeof m?f=m(d):(f=m.replace("{0}",f),f=f.replace("{1}",d.items))}else f=f+" - "+d.items+" item(s)";e="pq-group-row pq-grid-row"+(e?" pq-last-frozen-row":"");(a=a.titleCls)&&
(a=a[n])&&(e+=" "+a);c.push(["<tr class='",e,"' title=\"",d.groupTitle,"\" level='",n,"' GMRowIndx='",k,"'>"].join(""));g.show&&c.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");g=v[0];d.collapsed&&(g=v[1]);c.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",16*n,"px;'>","<span class='ui-icon ",g,"'></span>",f,"</div></td>");c.push("</tr>")},_generateSummaryRow:function(a,d,c,e,g){var f=d.level,n=d.rowData,k="pq-summary-row pq-grid-row"+
(g?" pq-last-frozen-row":"");(a=a.summaryCls)&&(a=a[f])&&(k+=" "+a);a=this.that;var m=a.options;g=m.virtualX;var v=a.initH,r=a.finalH,t=m.freezeCols,s=m.numberCell,m=m.columnBorders;e.push("<tr class='"+k+"'>");s.show&&e.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");for(k=0;k<=r;k++){if(k<v&&k>=t&&g&&(k=v,k>r))throw"initH>finalH";var s=c[k],y=s.dataIndx;if(!s.hidden){var x="pq-grid-cell ";"right"==s.align?x+=" pq-align-right":"center"==s.align&&(x+=" pq-align-center");k==t-
1&&m&&(x+=" pq-last-frozen-col");s.cls&&(x=x+" "+s.cls);var w=n[y],A;w&&(A=s.summary.title)&&(A=A[f])&&("function"==typeof A?(d.dataIndx=y,d.cellData=w,w=A.call(a.element[0],d)):w=A.replace("{0}",w));w=null==w?"&nbsp;":w;s=["<td class='",x,"' style='' >",w,"</td>"].join("");e.push(s)}}e.push("</tr>");return e},_generateDetailRow:function(a,d,c,e,g,f){c="pq-grid-row pq-detail-child";f&&(c+=" pq-last-frozen-row");var n=this.that.options;f=n.numberCell;var k="pq-grid-cell ";if(!n.wrap||g)k+="pq-wrap-text ";
n.stripeRows&&d/2==parseInt(d/2)&&(c+=" pq-grid-oddRow");a.pq_rowselect&&(c+=" pq-row-select ui-state-highlight");a=a.pq_rowcls;null!=a&&(c+=" "+a);e.push("<tr pq-row-indx='"+d+"' class='"+c+"' >");f.show&&e.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");e.push("<td class='"+k+" pq-detail-child' colSpan='20'></td>");e.push("</tr>");return e}},a=function(a){this.that=a},e=a.prototype;e._refreshDataFromDataModel=function(){this._groupData();this.initcollapsed()};e.bindEvents=function(){var a=
this;this.that.$cont.on("click","tr.pq-group-row",function(d){return a.onClickGroupRow(d)})};e.showHideRows=function(a,d,c){for(var e=[],g=this.that.dataGM,f=g.length;a<f;a++){var n=g[a],k=n;if(k.groupSummary)if(n.level<d)break;else n.pq_hidden=c;else if(k.groupTitle)if(n.collapsed&&e.push({indx:a,level:n.level}),n.level<=d)break;else n.pq_hidden=c;else n.pq_hidden=c}return e};e.onClickGroupRow=function(a){var d=f(a.currentTarget);a=this.that;var c=parseInt(d.attr("level")),d=parseInt(d.attr("GMRowIndx")),
e=!0,e=a.dataGM[d];e=e.collapsed?e.collapsed=!1:e.collapsed=!0;if(e)this.showHideRows(d+1,c,!0);else for(d=this.showHideRows(d+1,c,!1),e=0;e<d.length;e++){var g=d[e].indx,c=d[e].level;this.showHideRows(g+1,c,!0)}a.refresh()};e.initcollapsed=function(){var a=this.that.dataGM;if(a)for(var d=0,c=a.length;d<c;d++){var e=a[d];if(void 0!==e.groupTitle){var g=e.level;e.collapsed&&this.showHideRows(d+1,g,!0)}}};e.max=function(a,d){var c;"integer"==d||"float"==d?(c=Math.max.apply(Math,a),"float"===d&&(c=c.toFixed(2))):
(a="date"==d?a.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return a-b}):a.sort(),c=a[a.length-1]);return c};e.min=function(a,d){var c;"integer"==d||"float"==d?(c=Math.min.apply(Math,a),"float"===d&&(c=c.toFixed(2))):(a="date"==d?a.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return a-b}):a.sort(),c=a[0]);return c};e.count=function(a){return a.length};e.sum=function(a,d){var c=0,e;e="float"===d?parseFloat:"integer"===d?parseInt:function(a){return a};for(var g=0,f=a.length;g<f;g++)c+=e(a[g]);
"float"===d&&(c=c.toFixed(2));return c};e._groupData=function(){for(var a=this.that,d=a.pdata,c=a.options,e=c.groupModel,g=c.pageModel,c=a.colModel,g=g.type?(g.curPage-1)*g.rPP:0,q=c.length,n=e.dataIndx,k=n.length,m=e.collapsed,v=[],r=0;r<k;r++){v[r]=!1;for(var t=0;t<q;t++){var s=c[t],y=s.summary;if(y&&(y=y.type)&&"function"==typeof y.push&&y[r]){v[r]=!0;break}}}if(e&&d&&0<d.length){for(var e=[],t=[],x=[],w=[],A=[],r=0;r<k;r++)w[r]=null,x[r]="",A[r]={};for(var z=0,F=d.length;z<=F;z++){for(var B=d[z],
s=!1,E=null,r=0;r<k;r++)x[r]=z<F?f.trim(B[n[r]]):"",w[r]!=x[r]&&(s=!0),s&&null==E&&(E=r);if(s){for(s=0;s<k;s++)w[s]=x[s];if(0<z){for(r=k-1;r>=E;r--)if(v[r]){for(var C=[],G=0;G<q;G++)if(s=c[G],y=(y=s.summary)?y.type?y.type[r]:null:null){var D=s.dataIndx,H="",H="function"==typeof y?y(A[r][D],s.dataType):this[y](A[r][D],s.dataType);C[D]=H}e.push({groupSummary:!0,level:r,prevRowData:d[z-1],rowData:C})}for(s=E;s<k;s++)e[t[s]].items=A[s][c[0].dataIndx].length}if(z==F)break;for(r=k-1;r>=E;r--)for(y=0;y<
q;y++)s=c[y],A[r][s.dataIndx]=[];for(s=E;s<k;s++)e.push({groupTitle:x[s],level:s,nextRowData:B,GMRowIndx:e.length,collapsed:m&&null!=m[s]?m[s]:!1}),t[s]=e.length-1}if(z==F)break;B.rowIndx=z+g;B.pq_hidden=!1;e.push(B);for(E=0;E<q;E++)for(s=c[E],D=s.dataIndx,r=0;r<k;r++)A[r][D].push(B[D])}a.dataGM=e}else a.dataGM=null};k.options={cls:{cont_inner:"pq-grid-cont-inner",cont_inner_b:"pq-grid-cont-inner-b"},flex:{on:!0,one:!1,all:!0},detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se glyphicon glyphicon-minus",
collapseIcon:"ui-icon-triangle-1-e glyphicon glyphicon-plus"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check glyphicon-ok",rejectIcon:"ui-icon-closethick glyphicon-remove",topIcon:"ui-icon-circle-arrow-s glyphicon glyphicon-circle-arrow-down",bottomIcon:"ui-icon-circle-arrow-n glyphicon glyphicon-circle-arrow-up"},track:null,mergeModel:{on:!1},sortModel:{on:!0,type:"local",number:!0,single:!0,cancel:!0,sorter:[]},filterModel:{on:!0,type:"local",mode:"AND",header:!1}};k._create=function(){f.extend(f.paramquery.cGenerateView.prototype,
c);var b=f.paramquery,d=this.options;this._queueATriggers={};this._queueBTriggers={};this.iHistory=new b.cHistory(this);this.iGroupView=new a(this);b.cMerge&&(this.iMerge=new b.cMerge(this));this.iFilterData=new b.cFilterData(this);this.iHeaderSearch=new m(this);this.iUCData=new b.cUCData(this);this.iMouseSelection=new b.cMouseSelection(this);this._super();this.iGroupView.bindEvents();this.iDragColumns=new b.cDragColumns(this);this._createToolbar();"remote"===d.dataModel.location&&this.refresh({table:!0});
this.refreshDataAndView({header:!0})};k._createToolbar=function(){var a=this.options,d=a.toolbar;if(d){var c=d.cls,e=d.style,g=d.attr,d=d.items,c=f("<div class='"+(c?c:"")+"' style='"+(e?e:"")+"' "+(g?g:"")+" ></div>").appendTo(f(".pq-grid-top",this.element));c.pqToolbar({items:d,gridInstance:this,bootstrap:a.bootstrap});a.showToolbar||c.css("display","none");this.$toolbar=c}};k.isLeftOrRight=function(a){return a>this.freezeCols?"right":"left"};k.ovCreateHeader=function(a,d){this.options.filterModel.header&&
this.iHeaderSearch.createDOM(a,d)};k._createHeader=function(){this._super();this.options.showHeader&&this._trigger("createHeader")};k.filter=function(a){var d=this,c=this.options,e=void 0===a.apply?!0:a.apply,g=void 0===a.sort?!0:a.sort,q=c.dataModel,c=c.filterModel;if(void 0!=a){var n="replace"==a.oper?!0:!1;a=a.data;for(var k=this.colModel,k=e?k:f.extend(!0,[],k),m=0,v=k.length,r=a.length,t=0;t<v;t++){for(var s=k[t],y=!1,x=0;x<r&&m!=r;x++){var w=a[x];if(w.dataIndx==s.dataIndx){y=!0;m++;var x=s.filter,
A=w.condition,z=w.value;x?x.on=!0:x=s.filter={on:!0};A&&(x.condition=A);A=x.condition;x.value=z;if("between"==A)x.value2=w.value2;else if("range"==A){w=[];if(z)if("string"==typeof z){var A=x.options,F=z.indexOf('"'),B=z.lastIndexOf('"'),z=z.substr(F,B+1),z=JSON.parse("["+z+"]");if(A)for(F=0,B=A.length;F<B;F++){var E=A[F];-1!=f.inArray(E,z)&&w.push(E)}else w=z.split(",s*")}else"function"==typeof z.push&&(w=z);x.value=w}break}}n&&!y&&s.filter&&(s.filter.on=!1)}}var C={header:!1,apply:e,sort:g,CM:k};
if("remote"==q.location&&"local"!=c.type)this.remoteRequest({apply:e,CM:k,callback:function(){return d._onDataAvailable(C)}});else return C.source="filter",d._onDataAvailable(C)};k._initTypeColumns=function(){for(var a=this.colModel,d=0,c=a.length;d<c;d++){var e=a[d],g=e.type;"checkBoxSelection"===g?new f.paramquery.cCheckBoxColumn(this,e):"detail"===g&&(e.dataIndx="pq_detail",this.iHierarchy=new f.paramquery.cHierarchy(this))}};k.refreshHeader=function(){this._createHeader();this.iGenerateView.setPanes();
this._refreshHeaderSortIcons()};k.refreshDataFromDataModel=function(){this._super();this.options.groupModel&&this.iGroupView._refreshDataFromDataModel()};k._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()};k.getLargestRowCol=function(a){for(var d=0;d<a.length;d++);};k.bringCellToView=function(a){this._bringCellToView(a)};k._setUrl=function(a){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=a?a:"")}}};k.pageData=function(){return this.pdata};k.getData=function(a){var d=
a.dataIndx,c=d.length;a=a.data;var e=this.options.dataModel,g=e.data,e=e.dataUF,f=[],n=function(a){for(var b=0,e=a.length;b<e;b++){for(var h=a[b],g={},n=0;n<c;n++){var k=d[n];g[k]=h[k]}f.push(g)}};a?n(a):(g&&n(g),e&&n(e));a=[];for(g=0;g<c;g++)e=d[g],n=this.getColumn({dataIndx:e}),a.push({dataIndx:e,dir:"up",dataType:n.dataType,sortType:n.sortType});f=this.iSort._sortLocalData(a,f);a=[];g=void 0;for(e=0;e<f.length;e++){var n=f[e],k=JSON.stringify(n);k!==g&&(a.push(n),g=k)}return a};k._onDataAvailable=
function(a){a=a||{};var d=this.options,c=null==a.apply?!0:a.apply,e=a.source,g=a.sort,f=[],f=d.filterModel,n=d.dataModel,d=d.sortModel,k=n.location;!1!==c&&this._trigger("dataAvailable",a.evt,{dataModel:n,source:e});f=f&&f.on&&("local"==k&&"remote"!=f.type||"remote"==k&&"local"==f.type)?this.iFilterData.filterLocalData(a).data:n.data;"local"==d.type&&!1!==g&&(c?this.sort({refresh:!1}):f=this.iSort.sortLocalData(f));if(!1===c)return f;n.data=f;this.refreshView(a)};k.sort=function(a){a=a||{};var d=
this,c=this.options,e=c.dataModel.data,g=c.sortModel.type;if(e&&e.length||"local"!=g){var f=c.editModel,c=this.iSort,k=c.getSorter(),m,p=a.evt,v=null==a.single?c.readSingle():a.single;m=c.readCancel();a.sorter?a.addon?(a.single=v,a.cancel=m,m=c.refreshSorter(a)):m=a.sorter:m=c.readSorter();if(m.length||k.length)f.indices&&d.blurEditor({force:!0}),f={dataIndx:m.length?m[0].dataIndx:null,oldSorter:k,sorter:m,source:a.source,single:v},!1===d._trigger("beforeSort",p,f)?c.cancelSort():(c.resumeSort(),
"local"==g&&c.saveOrder(),c.setSorter(m),c.setSingle(v),c.writeSorter(m),c.writeSingle(v),"local"==g?(c.sortLocalData(e),this._queueATriggers.sort={evt:p,ui:f},!1!==a.refresh&&this.refreshView()):"remote"==g&&(this._queueATriggers.sort={evt:p,ui:f},a.initByRemote||this.remoteRequest({initBySort:!0,callback:function(){d._onDataAvailable()}})))}};f.widget("paramquery.pqGrid",f.paramquery._pqGrid,k);f.paramquery.pqGrid.regional={};f.paramquery.pqGrid.regional.en=k._regional})(jQuery);
(function(f){var k=f.paramquery._pqGrid.prototype;f.paramquery=f.paramquery||{};f.paramquery.pqgrid=f.paramquery.pqgrid||{};k.exportExcel=function(e){e.format="xls";return m.call(this,e)};k.exportCsv=function(e){e.format="csv";return m.call(this,e)};k.exportXml=function(e){e.format="xml";return m.call(this,e)};k.exportHtml=function(e){e.format="html";return m.call(this,e)};var m=function(e){var c=this,a=void 0===e.urlPost?e.url:e.urlPost,b=e.url,d=null==e.sheetName?"pqGrid":e.sheetName,l=e.format,
h=function(){for(var a=c.colModel,b=a.length,d=c.options.dataModel.data,e=d.length,h=[],l=[],f=[],k=0;k<b;k++){var m=a[k];!1!==m.copy&&(m=m.title.replace(/\"/g,'""'),l.push('"'+m+'"'))}h.push(l.join(","));for(k=0;k<e;k++){for(var l=d[k],y=0;y<b;y++)m=a[y],!1!==m.copy&&(m=l[m.dataIndx]+"",m=m.replace(/\"/g,'""'),f.push('"'+m+'"'));h.push(f.join(","));f=[]}return h.join("\n")};e="xls"==l?function(){for(var a=c.colModel,b=a.length,e=c.options.dataModel.data,h=e.length,l,f=[],k=[],m=0;m<b;m++){var s=
a[m];!1!==s.copy&&(l=s._width,l||(l=parseInt(s.width))||(l=100),k.push('<Column ss:AutoFitWidth="1"  ss:Width="'+l+'" />'))}k.push("<Row>");for(m=0;m<b;m++)s=a[m],!1!==s.copy&&k.push('<Cell><Data ss:Type="String">'+s.title+"</Data></Cell>");k.push("</Row>");k=k.join("\n");for(m=0;m<h;m++){l=e[m];f.push("<Row>");for(var y=0;y<b;y++)s=a[y],!1!==s.copy&&f.push('<Cell><Data ss:Type="String"><![CDATA['+l[s.dataIndx]+"]]\x3e</Data></Cell>");f.push("</Row>")}f=f.join("\n");return['<?xml version="1.0"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n xmlns:o="urn:schemas-microsoft-com:office:office"\n xmlns:x="urn:schemas-microsoft-com:office:excel"\n xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\n xmlns:html="http://www.w3.org/TR/REC-html40">\n<Worksheet ss:Name="',
d,'">\n<Table>',k,f,"</Table>\n</Worksheet>\n</Workbook>"].join("\n")}():"xml"==l?getXMLContent():"html"==l?getHTMLContent(e):h();f.ajax({url:a,type:"POST",cache:!1,data:{extension:"xls"==l?"xml":l,excel:e},success:function(a){a=b+((0<b.indexOf("?")?"&":"?")+"filename="+a);f(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+a+"></iframe>")}})}})(jQuery);
(function(f){var k=f.paramquery.pqGrid.prototype.options,m={on:!1,dirtyClass:"pq-cell-dirty"};k.trackModel=k.trackModel||m;k=(f.paramquery.cUCData=function(e){this.that=e;this.udata=[];this.ddata=[];this.adata=[];this.options=e.options;var c=this,a=e.eventNamespace,b=e.widgetEventPrefix.toLowerCase();e.element.on(b+"dataavailable"+a,function(a,b){c.belongs(a)&&"filter"!=b.source&&(c.udata=[],c.ddata=[],c.adata=[])})}).prototype=new f.paramquery.cClass;k.add=function(e){var c=this.that,a=this.adata,
b=this.ddata;e=e.rowData;for(var d=this.options.trackModel.dirtyClass,l=c.getRecId({rowData:e}),h=0,g=a.length;h<g;h++){var f=a[h];if(null!=l&&f.recId==l)throw"primary key violation";if(f.rowData==e)throw"same data can't be added twice.";}h=0;for(g=b.length;h<g;h++)if(e==b[h].rowData){b.splice(h,1);return}var b=[],k;for(k in e)b.push(k);c.removeClass({rowData:e,dataIndx:b,cls:d});e={recId:l,rowData:e};a.push(e)};k.update=function(e){var c=this.that,a=this.options.trackModel.dirtyClass,b=e.rowData||
c.getRowData(e),d=c.getRecId({rowData:b}),l=e.dataIndx,h=e.refresh,g=c.columns,k=f.paramquery.getValueFromDataType;e=e.row;var n=this.udata,m=n.slice(0),p=!1;if(null!=d){for(var v=0,r=n.length;v<r;v++){var t=n[v],s=t.oldRow;if(t.rowData==b){p=!0;for(l in e)n=g[l].dataType,r=e[l],r=k(r,n),t=s[l],t=k(t,n),s.hasOwnProperty(l)&&t===r?(n={rowData:b,dataIndx:l,refresh:h,cls:a},c.removeClass(n),delete s[l]):(n={rowData:b,dataIndx:l,refresh:h,cls:a},c.addClass(n),s.hasOwnProperty(l)||(s[l]=b[l]));f.isEmptyObject(s)&&
m.splice(v,1);break}}if(!p){s={};for(l in e)s[l]=b[l],n={rowData:b,dataIndx:l,refresh:h,cls:a},c.addClass(n);n={rowData:b,recId:d,oldRow:s};m.push(n)}this.udata=m}};k["delete"]=function(e){var c=this.that,a=e.rowIndx,b=e.rowIndxPage,d=c.rowIndxOffset,a=null==a?b+d:a,b="remote"==c.options.pageModel.type?null==b?a-d:b:a,d=this.adata,l=this.ddata;e=c.getRowData(e);for(var c=0,h=d.length;c<h;c++)if(d[c].rowData==e){d.splice(c,1);return}l.push({indx:b,rowData:e,rowIndx:a})};k.isDirty=function(e){var c=
this.udata,a=this.adata,b=this.ddata,d=!1;if(e=this.that.getRowData(e))for(a=0;a<c.length;a++){if(e==c[a].rowData){d=!0;break}}else if(c.length||a.length||b.length)d=!0;return d};k.getChangesValue=function(){for(var e=this.udata,c=this.adata,a=this.ddata,b={updateList:[],addList:[],deleteList:[]},d=[],l=[],h=[],g=[],k=[],n=0,m=a.length;n<m;n++){var p=a[n],p=p.rowData,v={};g.push(p);for(var r in p)0!=r.indexOf("pq_")&&(v[r]=p[r]);k.push(v)}for(n=0;n<e.length;n++)if(p=e[n],p=p.rowData,-1==f.inArray(p,
g)&&-1==f.inArray(p,d)){v={};for(r in p)0!=r.indexOf("pq_")&&(v[r]=p[r]);d.push(p);l.push(v)}for(n=0;n<c.length;n++){p=c[n];p=p.rowData;v={};for(r in p)0!=r.indexOf("pq_")&&(v[r]=p[r]);h.push(v)}b.updateList=l;b.addList=h;b.deleteList=k;return b};k.getChanges=function(){for(var e=this.udata,c=this.adata,a=this.ddata,b={updateList:[],addList:[],deleteList:[]},d=[],l=[],h=[],g=0,k=a.length;g<k;g++){var n=a[g],n=n.rowData;h.push(n)}g=0;for(k=e.length;g<k;g++)n=e[g],n=n.rowData,-1==f.inArray(n,h)&&-1==
f.inArray(n,d)&&d.push(n);g=0;for(k=c.length;g<k;g++)n=c[g],n=n.rowData,l.push(n);b.updateList=d;b.addList=l;b.deleteList=h;return b};k.getChangesRaw=function(){var e=this.adata,c=this.ddata,a={updateList:[],addList:[],deleteList:[]};a.updateList=this.udata;a.addList=e;a.deleteList=c;return a};k.commitAdd=function(e,c){for(var a=this.that.colModel,b=a.length,d=this.adata,l=f.inArray,h=d.length,g=f.paramquery.getValueFromDataType,k=[],n=e.length,m=[],p=0;p<n;p++)for(var v=e[p],r=0;r<h;r++){var t=d[r].rowData,
s=!0;if(-1==l(t,m)){for(var y=0;y<b;y++){var x=a[y],w=x.dataType,A=x.dataIndx;if(!x.hidden&&A!=c&&(x=t[A],x=g(x,w),A=v[A],A=g(A,w),x!==A)){s=!1;break}}if(s){r={};s={};r[c]=v[c];s[c]=t[c];k.push({type:"update",rowData:t,oldRow:s,newRow:r});m.push(t);break}}}a=[];for(r=0;r<h;r++)t=d[r].rowData,-1==l(t,m)&&a.push(d[r]);this.adata=a;return k};k.commitUpdate=function(e,c){for(var a=this.that,b=this.options.trackModel.dirtyClass,d=a.colModel,l=d.length,h=this.udata,g=h.length,k=e.length,n=[],m=0;m<g;m++){var p=
h[m],v=p.rowData,p=p.oldRow;if(-1==f.inArray(v,n))for(var r=0;r<k;r++)if(v[c]==e[r][c]){n.push(v);for(var t=0;t<l;t++)var s=d[t].dataIndx;for(s in p)a.removeClass({rowData:v,dataIndx:s,cls:b})}}a=[];for(m=0;m<g;m++)v=h[m].rowData,-1==f.inArray(v,n)&&a.push(h[m]);this.udata=a;return[]};k.commitDelete=function(e,c){for(var a=this.ddata,b=a.length,d=e.length,l=[],h=0;h<b;h++)for(var g=a[h].rowData,k=0;k<d;k++)g[c]==e[k][c]&&l.push(g);d=[];for(h=0;h<b;h++)g=a[h].rowData,-1==f.inArray(g,l)&&d.push(a[h]);
this.ddata=d};k.commitUpdateAll=function(){for(var e=this.that,c=this.options.trackModel.dirtyClass,a=this.udata,b=0,d=a.length;b<d;b++){var l=a[b],h=l.oldRow,l=l.rowData,g;for(g in h)e.removeClass({rowData:l,dataIndx:g,cls:c})}this.udata=[]};k.commitAddAll=function(){this.adata=[]};k.commitDeleteAll=function(){this.ddata=[]};k.commit=function(e){var c=this.that,a=e?e.history:null,a=null==a?!1:a,b=[],b=[],d=[],l=c.options.dataModel.recIndx;if(null==e)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();
else{var h=e.type;e=e.rows;"add"==h?e?b=this.commitAdd(e,l):this.commitAddAll():"update"==h?e?d=this.commitUpdate(e,l):this.commitUpdateAll():"delete"==h&&(e?this.commitDelete(e,l):this.commitDeleteAll())}b=b.concat(d);b.length&&(c._digestData({source:"commit",checkEditable:!1,track:!1,history:a,rowList:b}),c.refreshView())};k.rollbackAdd=function(e,c){for(var a=this.adata,b=[],d=0,l=a.length;d<l;d++)b.push({type:"delete",rowData:a[d].rowData});this.adata=[];return b};k.rollbackDelete=function(e,
c){for(var a=this.ddata,b=[],d=a.length-1;0<=d;d--){var l=a[d];b.push({type:"add",rowIndx:l.rowIndx,newRow:l.rowData})}this.ddata=[];return b};k.rollbackUpdate=function(e,c){for(var a=this.that,b=this.options.trackModel.dirtyClass,d=this.udata,l=[],h=0,g=d.length;h<g;h++){var f=d[h],k=f.rowData,m={},p=f.oldRow;if(null!=f.recId){var f=[],v;for(v in p)m[v]=k[v],f.push(v);a.removeClass({rowData:k,dataIndx:f,cls:b,refresh:!1});l.push({type:"update",rowData:k,newRow:p,oldRow:m})}}this.udata=[];return l};
k.rollback=function(e){var c=this.that,a=c.options.pageModel,b=e&&null!=e.refresh?e.refresh:!0;e=e&&null!=e.type?e.type:null;var d=[],d=[],l=[],h=[],g=c.options.dataModel.data;if(null==e||"update"==e)l=this.rollbackUpdate(a,g);if(null==e||"delete"==e)d=this.rollbackDelete(a,g);if(null==e||"add"==e)h=this.rollbackAdd(a,g);d=d.concat(h,l);c._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:d});b&&c.refreshView()};k=f.paramquery.pqGrid.prototype;k.getChanges=
function(e){this.blurEditor({force:!0});if(e&&(e=e.format)){if("byVal"==e)return this.iUCData.getChangesValue();if("raw"==e)return this.iUCData.getChangesRaw()}return this.iUCData.getChanges()};k.rollback=function(e){this.blurEditor({force:!0});this.iUCData.rollback(e)};k.isDirty=function(e){return this.iUCData.isDirty(e)};k.commit=function(e){this.iUCData.commit(e)};k._getRowIndx=function(){var e=this.selection({type:"row",method:"getSelection"});if(e&&0<e.length){var e=e[0].rowIndx,c=this.options.pageModel,
a=e-this.rowIndxOffset,b=c.rPP;if(c.type){if(0<=a&&a<b)return e}else return e}else return null};k.updateRow=function(e){var c=e.rowIndx,a=e.row,b=e.rowData||this.getRowData({rowIndx:c});if(!b)return!1;var d={},l;for(l in a){var h=this.columns[l];h&&(d[l]=this.iGenerateView.readCell(b,h))}if(!1===this._digestData({source:e.source||"update",history:e.history,checkEditable:e.checkEditable,track:e.track,allowInvalid:e.allowInvalid,rowList:[{newRow:a,oldRow:d,rowData:b,rowIndx:c,type:"update"}]}))return!1;
!1!==e.refresh&&this.refreshRow({rowIndx:c})};k.updateElseAdd=function(e){var c=e.row;null==this.getRowData({rowIndx:e.rowIndx})?(e.rowData=c,this.addRow(e)):this.updateRow(e)};k._fillForm=function(e){var c=this.colModel,a=this.rowIndxOffset,b=null==e.rowIndxPage?e.rowIndx-a:e.rowIndxPage;e=null==e.rowIndx?b+a:e.rowIndx;this.rowData=b=this.options.dataModel.data["remote"==this.options.pageModel.type?b:e];this.$crudDialog.dialog("option","title","Edit Record ("+(e+1)+")");e=this.$crudForm;for(a=0;a<
c.length;a++){var d=c[a].dataIndx,l=b[d];e.find("*[name='"+d+"']").val(l)}};k.getRecId=function(e){e.dataIndx=this.options.dataModel.recIndx;e=this.getCellData(e);return null==e?null:e};k.getCellData=function(e){var c=e.rowData||this.getRowData(e);e=e.dataIndx;return c?c[e]:null};k.getRowData=function(e){if(!e)return null;var c=e.rowData;if(null!=c)return c;var a=this.options,c=a.dataModel,a=a.pageModel.type,b=c.recIndx,d=e.recId,c=c.data;if(null!=d)for(e=0,a=c.length;e<a;e++){var l=c[e];if(l[b]==
d)return l}else return b=e.rowIndx,e=e.rowIndxPage,d=this.rowIndxOffset,b=null!=b?b:e+d,e="remote"==a?null!=e?e:b-d:b,l=c?c[e]:null;return null};k.deleteRow=function(e){var c=e.rowIndx,a=e.rowIndxPage,b=this.rowIndxOffset,c=null!=a?a+b:c;null!=c&&(a=e.rowData||this.getRowData({rowIndx:c}),this._digestData({source:e.source||"delete",history:e.history,track:e.track,rowList:[{rowIndx:c,rowData:a,oldRow:a,type:"delete"}]}),!1!==e.refresh&&this.refreshView())};k.addRow=function(e){var c=e.rowData||e.row,
a=e.rowIndx,b=e.rowIndxPage,d=this.rowIndxOffset,a=null!=b?b+d:a,b=this.options.dataModel,d=b.data;if(null==c)return null;null==d&&(b.data=[],d=b.data);if(!1===this._digestData({source:e.source||"add",history:e.history,track:e.track,checkEditable:e.checkEditable,rowList:[{newRow:c,rowIndx:a,type:"add"}]}))return!1;!1!==e.refresh&&this.refreshView();return null==a?d.length-1:a}})(jQuery);
(function(f){f.widget("paramquery.pqToolbar",{options:{items:[],gridInstance:null},_create:function(){var k=this.options,m=k.bootstrap,e=k.gridInstance,c=e.colModel,k=k.items,a=this.element;a.closest(".pq-grid");a.addClass("pq-toolbar");for(var b=0,d=k.length;b<d;b++){var l=k[b],h=l.type,g=l.icon,q=l.options,n=l.label,u=l.listener,p=u?[u]:l.listeners,u=l.cls,u="ui-corner-all "+(u?u:""),v=l.style,v=v?'style="'+v+'"':"",r=l.attr,r=r?r:"",t;"textbox"==h?t=f("<input type='text' class='"+u+"' "+r+" "+
v+">").appendTo(a):"checkbox"==h?t=f("<input type='checkbox' class='"+u+"' "+r+" "+v+">").appendTo(a):"separator"==h?f("<span class='pq-separator '"+u+"' "+r+" "+v+"></span>").appendTo(a):"button"==h?(h=m.on,t="",h&&(t=g?"<span class='glyphicon "+g+"'></span>":"",u="btn "+u),t=f("<button type='button' class='"+u+"' "+r+" "+v+">"+t+n+"</button>").appendTo(a),q=l.options?l.options:{},f.extend(q,{text:n?!0:!1,icons:{primary:h?"":g}}),t.button(q)):"select"==h?(q=l.options?l.options:[],"function"===typeof q&&
(q=q.call(e.element[0],{colModel:c})),t=f.paramquery.select({options:q,attr:" class='"+u+"' "+r+" "+v,prepend:l.prepend,groupIndx:l.groupIndx,valueIndx:l.valueIndx,labelIndx:l.labelIndx}),t=f(t).appendTo(a)):"string"==typeof h?t=f(h).appendTo(a):"function"==typeof h&&(t=h.call(e.element[0],{colModel:c,cls:u}),t=f(t).appendTo(a));if(p)for(l=0;l<p.length;l++){var u=p[l],s;for(s in u)t.bind(s,u[s])}}},_destroy:function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},_disable:function(){null==
this.$disable&&(this.$disable=f("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},_enable:function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},_setOption:function(f,m){"disabled"==f&&(!0==m?this._disable():this._enable())}})})(jQuery);
(function(f){var k=function(){this.focusSelection=null},m=k.prototype;m.triggerSelectChange=function(a){var b=this.that;if(b.options.selectionModel.fireSelectChange){var d=b.iRows.getSelection(),c=b.iCells.getSelection(),e=a.evt;a=a.ui;d={rows:d,cells:c};a=null==a?d:f.extend(d,a);b._trigger("selectChange",e,a)}};m.getOldRowSel=function(){var a=this.that,b;if((b=this.focusSelection)&&this.isSelected(b))return a=a.getRowIndx(b),a.rowData=b.rowData,a};m.getOldCellSel=function(){var a=this.that,b;if((b=
this.focusSelection)&&this.isSelected(b)){var d=b.rowData,a=a.getRowIndx({rowData:d});a.rowData=d;a.dataIndx=b.dataIndx;return a}};m.getNewRowSel=function(){var a=this.that,b=document.activeElement?f(document.activeElement):null;if(b&&b.hasClass("pq-grid-row")&&b.closest(".pq-grid")[0]==a.element[0])return a=a.getRowIndx({$tr:b}),a.$tr=b,a};m.getNewCellSel=function(){var a=this.that,b=document.activeElement?f(document.activeElement):null;if(b&&b.hasClass("pq-grid-cell")&&b.closest(".pq-grid")[0]==
a.element[0])return a=a.getCellIndices({$td:b}),a.$td=b,a};m.getFocusSelection=function(a){if(this instanceof e)return a&&!0===a.old?this.getOldRowSel():this.getNewRowSel();if(this instanceof c)return a&&!0===a.old?this.getOldCellSel():this.getNewCellSel()};m.getFirstSelection=function(){var a=this.firstSelection;if(a&&this.isSelected(a))return a;this.refresh();a=this.selection;if(a.length)return this.firstSelection=a[0],a[0]};m.getLastSelection=function(){var a=this.lastSelection;if(a){var b=a.rowData,
d=this.that.getRowData({rowIndx:rowIndx});return b==d&&this.isSelected(a)?a:!1}return null};m.getLastSelectionCurPage=function(){var a=this.lastSelection;if(a&&this.isSelected(a)){var b=a.rowIndx,d=this.that.options.pageModel;if(d.type){var c=d.curPage;return Math.ceil((b+1)/d.rPP)==c?a:null}return a}return null};m.getSelection=function(){this.refresh();return this.selection};m.getSelectionCurPage=function(){var a=this.that,b=this.getSelection(),d=[],c=a.options.pageModel;if(c.type){for(var a=c.curPage,
c=c.rPP,e=0;e<b.length;e++){var g=b[e];Math.ceil((g.rowIndx+1)/c)==a&&d.push(g)}return d}return b};m.inViewRow=function(a){var b=this.that,d=this.options,c=b.rowIndxOffset,e=b.initV,g=b.finalV;if(a<d.freezeRows)return!0;if(d.groupModel){if((b=b.dataGM)&&b.length)for(;e<=g;e++)if(d=b[e].rowIndx-c,null!=d&&d==a)return!0;return!1}return a>=e&&a<=g};m.setDirty=function(){};var e=function(a){this.that=a;this.options=a.options;this.selection=[]};f.paramquery.cRows=e;var c=function(a){this.options=a.options;
this.that=a;this.selection=[]};f.paramquery.cCells=c;m=c.prototype=new k;k=e.prototype=new k;k.extendSelection=function(a){var b=this.that,d=a.rowIndx,c=b.options.selectionModel.mode;a=a.evt;var e=this.getFirstSelection();null==e?b.setSelection({rowIndx:d}):"single"!=c&&(c=b=e.rowIndx,e=d,b>d&&(c=d,e=b),this.selectRange({initRowIndx:c,finalRowIndx:e,evt:a}),this.add({rowIndx:d}))};k.refresh=function(){this.selection=[];var a=this.that,b=a.options,d="remote"==b.pageModel.type?!0:!1,a=a.rowIndxOffset,
c=[];if(b=b.dataModel.data){for(var e=0,g=b.length;e<g;e++){var f=b[e];f.pq_rowselect&&c.push({rowIndx:d?e+a:e,rowData:f})}this.selection=c}};k.replace=function(a){var b=a.rowIndx,d=null==a.offset?this.that.getRowIndxOffset():a.offset;a.offset=d;a.rowIndxPage=b-d;this.removeAll({raiseEvent:!0});this.add(a)};k.indexOf=function(a){this.refresh();a=a.rowIndx;for(var b=this.selection,d=0;d<b.length;d++)if(b[d].rowIndx==a)return d;return-1};k.isSelected=function(a){var b=this.that;return(a=a.rowData||
b.getRowData(a))?null==a.pq_rowselect?!1:a.pq_rowselect:null};k._boundRow=function(a){var b=a.rowIndxPage,d=this.that;a=null==a.$tr?d.getRow({rowIndxPage:b}):a.$tr;if(null==a||0==a.length)return!1;a.addClass("pq-row-select ui-state-highlight");return a};k.selectRange=function(a){var b=a.initRowIndx,d=a.finalRowIndx;a=a.evt;for(var c=this.getSelection().slice(0),e=[],g=0;g<c.length;g++){var f=c[g],k=f.rowIndx;(k<b||k>d)&&e.push({rowIndx:k,rowData:f.rowData})}this.remove({rows:e,evt:a});e=[];b>d&&(c=
b,b=d,d=c);for(k=b;k<=d;k++)e.push({rowIndx:k,evt:a});this.add({rows:e,evt:a})};m._addToData=function(a){var b=a.dataIndx;a=this.that.getRowData(a);a.pq_cellselect||(a.pq_cellselect={});a.pq_cellselect[b]=!0};m.extendSelection=function(a){var b=this.that,d=this.getFirstSelection(),c=a.rowIndx,e=a.colIndx,g=b.options.selectionModel.mode;a=a.evt;if(null==d)b.setSelection({rowIndx:c,colIndx:e});else{var f=d.rowIndx,b=b.getColIndx({dataIndx:d.dataIndx}),d=f,k=c,m=b,p=e;f>c&&(d=c,k=f);"range"==g?(f>c&&
(m=e,p=b),c==f&&e<b&&(m=e,p=b),this.selectRange({initRowIndx:d,initColIndx:m,finalRowIndx:k,finalColIndx:p,evt:a}),this.add({rowIndx:c,colIndx:e})):"block"==g&&(b>e&&(m=e,p=b),this.selectBlock({initRowIndx:d,initColIndx:m,finalRowIndx:k,finalColIndx:p,evt:a}),this.add({rowIndx:c,colIndx:e}))}};m._removeFromData=function(a){var b=a.rowData;b&&b.pq_cellselect&&delete b.pq_cellselect[a.dataIndx]};m.removeAll=function(){this.refresh();var a=this.selection.slice(0);this.remove({cells:a});this.lastSelection=
null};k.removeAll=function(a){if(a&&null!=a.page)throw"objP.page not supported in removeAll";var b=this.that,d=a&&null!=a.all?a.all:!0;this.refresh();a=this.selection.slice(0);if(d)this.remove({rows:a}),this.lastSelection=null;else{for(var d=[],c=b.rowIndxOffset,b=(b=b.pdata)?b.length:0,e=0,g=a.length;e<g;e++){var f=a[e],k=f.rowIndx-c;if(0<=k)if(k<b)d.push(f);else break}this.remove({rows:d})}};m.isSelected=function(a){var b=this.that,d=a.rowData||b.getRowData(a),c=a.dataIndx;a=a.colIndx;if(null==
a&&null==c||null==d)return null;c=null==c?b.colModel[a].dataIndx:c;return d.pq_cellselect&&d.pq_cellselect[c]?!0:!1};m.refresh=function(){this.selection=[];var a=this.that,b=a.options.dataModel.data,d=[],c="remote"==a.options.pageModel.type?!0:!1,a=a.rowIndxOffset,e=this.that.colModel,g=e.length;if(b){for(var f=[],k=0;k<g;k++){var m=e[k].dataIndx;f[k]=m}for(var k=0,p=b.length;k<p;k++){var v=b[k],r=v.pq_cellselect;if(r)for(var t=c?k+a:k,s=0;s<g;s++)m=f[s],r[m]&&d.push({rowIndx:t,rowData:v,dataIndx:m,
colIndx:s,column:e[s]})}this.selection=d}};m.replace=function(a){var b=a.rowIndx,d=null==a.offset?this.that.getRowIndxOffset():a.offset;a.rowIndxPage=b-d;a.offset=d;this.removeAll({raiseEvent:!0});this.add(a)};m.inViewCell=function(a,b){var d=this.that,c=this.options.freezeCols;return this.inViewRow(a)?b<c||b>=d.initH&&b<=d.finalH:!1};m._add=function(a){var b=this.that,d=a.rowIndx,c=a.rowIndxPage,e=a.rowData||b.getRowData(a),g=b.rowIndxOffset,f,d=null==d?c+g:d,c=null==c?d-g:c,g=a.colIndx,k=a.dataIndx,
g=null==g?b.getColIndx({dataIndx:k}):g,m=b.colModel[g],k=null==k?m.dataIndx:k,p=a.evt,v=this.isSelected({rowData:e,dataIndx:k});if(null==v)return!1;var r=this.inViewCell(c,g);if(!1===v){if(r){var t=b.getCell({rowIndxPage:c,colIndx:g});t&&t.addClass("pq-state-select ui-state-highlight")}this._addToData({rowData:e,dataIndx:k});!1!==a.trigger&&b._trigger("cellSelect",p,{rowIndx:d,rowIndxPage:c,colIndx:g,dataIndx:k,column:m,rowData:e});f=!0}this.lastSelection={rowIndx:d,dataIndx:k,rowData:e};!1!==a.focus&&
r&&(t&&t.length||(t=b.getCell({rowIndxPage:c,dataIndx:k})),t&&t.length&&(t.attr("tabindex","0"),t.focus(),this.focusSelection={rowData:e,rowIndx:d,dataIndx:k}));a.setFirst&&(this.firstSelection={rowIndx:d,rowData:e,dataIndx:k});if(f)return{rowIndx:d,rowData:e,dataIndx:k,colIndx:g,column:m}};k._add=function(a){var b=this.that,d,c=a.rowIndx,e=a.rowIndxPage,g=b.rowIndxOffset,c=null==c?e+g:c,e=null==e?c-g:e,k=null==k?b.getRowData(a):k,g=a.$tr,m=a.evt,u=this.isSelected({rowData:k});a.rowIndxPage=e;if(null==
u)return!1;var p=this.inViewRow(e);!1===u&&(p&&(g=this._boundRow(a)),k.pq_rowselect=!0,!1!==a.trigger&&b._trigger("rowSelect",m,{rowIndx:c,rowIndxPage:e,rowData:k,$tr:g}),d=!0);this.lastSelection={rowIndx:c,rowData:k};!1!==a.focus&&p&&(g&&g.length||(g=b.getRow({rowIndxPage:e})),g&&(g=f(g[0]),g.attr("tabindex","0"),g.focus(),this.focusSelection={rowData:k,rowIndx:c}));a.setFirst&&(this.firstSelection={rowIndx:c,rowData:k});if(d)return{rowIndx:c,rowData:k}};m.add=function(a){var b=this.that,c=a.evt,
e=a.cells,h=!1,g=[];if(e&&"function"==typeof e.push){a=0;for(var f=e.length;a<f;a++)h=e[a],h.trigger=!1,(h=this._add(h))&&g.push(h);g.length&&(h=!0,b._trigger("cellSelect",c,{cells:g}))}else h=this._add(a);h&&this.triggerSelectChange({evt:c})};k.add=function(a){var b=this.that,c=a.evt,e=a.rows,h=!1,g=[];if(e&&"function"==typeof e.push){a=0;for(var f=e.length;a<f;a++)h=e[a],h.trigger=!1,(h=this._add(h))&&g.push(h);g.length&&(h=!0,b._trigger("rowSelect",c,{rows:g}))}else h=this._add(a);h&&this.triggerSelectChange({evt:c})};
m._remove=function(a){var b=this.that,c=a.rowIndx,e=a.rowIndxPage,h=b.rowIndxOffset,c=null==c?e+h:c,e=null==e?c-h:e,h=a.rowData||b.getRowData(a),g=a.colIndx,f=a.dataIndx,g=null==g?b.getColIndx({dataIndx:f}):g,k=a.column,k=null==k?b.colModel[g]:k,f=null==f?k.dataIndx:f,m=a.evt;if(this.isSelected({rowData:h,dataIndx:f}))return this.inViewCell(e,g)&&(e=b.getCell({rowIndxPage:e,colIndx:g,all:!0}))&&(e.removeClass("pq-state-select ui-state-highlight"),e.removeAttr("tabindex")),this._removeFromData({rowData:h,
dataIndx:f}),!1!==a.trigger&&b._trigger("cellUnSelect",m,{rowIndx:c,colIndx:g,dataIndx:f,rowData:h}),{rowIndx:c,rowData:h,dataIndx:f,colIndx:g,column:k}};k._remove=function(a){var b=this.that,c=a.rowIndx,e=a.rowIndxPage,h=b.rowIndxOffset,c=null==c?e+h:c,e=null==e?c-h:e,h=a.rowData,h=null==h?b.getRowData(a):h,g=a.$tr,f=a.evt;if(this.isSelected({rowData:h}))return this.inViewRow(e)&&(g=b.getRow({rowIndxPage:e}))&&(g.removeClass("pq-row-select ui-state-highlight"),g.removeAttr("tabindex")),h.pq_rowselect=
!1,!1!==a.trigger&&b._trigger("rowUnSelect",f,{rowIndx:c,rowData:h,$tr:g}),{rowIndx:c,rowData:h}};m.remove=function(a){var b=a.cells,c=a.evt,e=!1;if(b&&"function"==typeof b.push){a=[];for(var h=0,g=b.length;h<g;h++)e=b[h],e.trigger=!1,(e=this._remove(e))&&a.push(e);a.length&&(e=!0,this.that._trigger("cellUnSelect",c,{cells:a}))}else e=this._remove(a);e&&this.triggerSelectChange({evt:c})};k.remove=function(a){var b=a.rows,c=a.evt,e=!1;if(b&&"function"==typeof b.push){a=[];for(var h=0,g=b.length;h<
g;h++)e=b[h],e.trigger=!1,(e=this._remove(e))&&a.push(e);a.length&&(e=!0,this.that._trigger("rowUnSelect",c,{rows:a}))}else e=this._remove(a);e&&this.triggerSelectChange({evt:c})};m.indexOf=function(a){this.refresh();var b=a.rowIndx,c=this.that,c=null==a.dataIndx?c.colModel[a.colIndx].dataIndx:a.dataIndx;a.dataIndx=c;a=this.selection;for(var e=0;e<a.length;e++){var h=a[e];if(h.rowIndx==b&&h.dataIndx==c)return e}return-1};m.selectAll=function(a){var b=this.that,c=a&&a.all?!0:!1;a=c?this.options.dataModel.data:
b.pdata;var e=b.rowIndxOffset,h=b.colModel,g=h.length,f=[],b=function(a,b){for(var c=0;c<g;c++){var d=h[c];d.hidden||f.push({rowIndx:b,rowData:a,colIndx:c,dataIndx:d.dataIndx,focus:!1})}};if(a){for(var k=0,m=a.length;k<m;k++)var p=a[k];if(c)for(c="remote"==this.options.pageModel.type?!0:!1,k=0,m=a.length;k<m;k++){var p=a[k],v=k;c&&(v=k+e);b(p,v)}else for(k=0,m=a.length;k<m;k++)p=a[k],v=k+e,b(p,v);this.add({cells:f})}};k.selectAll=function(a){var b=this.that,c=a&&a.all?!0:!1,b=c?this.options.dataModel.data:
b.pdata;a=[];if(b){if(c)for(var c="remote"==this.options.pageModel.type?!0:!1,e=0,h=b.length;e<h;e++){var g={rowData:b[e],focus:!1};c?g.rowIndxPage=e:g.rowIndx=e;a.push(g)}else for(e=0,h=b.length;e<h;e++)a.push({rowIndxPage:e,rowData:b[e],focus:!1});this.add({rows:a})}};m.selectRange=function(a){var b=this.that,c=a.initRowIndx,e=a.initColIndx,h=a.finalRowIndx;a=a.finalColIndx;for(var g=b.colModel,f=g.length,k=this.getSelection().slice(0),m=[],p=0;p<k.length;p++){var v=k[p],r=v.rowIndx,t=v.dataIndx,
v=b.getColIndx({dataIndx:t});r<c||r>h?m.push({rowIndx:r,colIndx:v,dataIndx:t}):r==c&&v<e?m.push({rowIndx:r,colIndx:v,dataIndx:t}):r==h&&v>a&&m.push({rowIndx:r,colIndx:v,dataIndx:t})}this.remove({cells:m});m=[];for(v=0;v<f;v++)if(b=g[v],!b.hidden){t=b.dataIndx;r=c;do{if(!(r==c&&v<e))if(r==h&&v>a)break;else m.push({rowIndx:r,colIndx:v,dataIndx:t,focus:!1});r++}while(r<=h)}this.add({cells:m})};m.selectBlock=function(a){var b=this.that,c=a.initRowIndx,e=a.initColIndx,h=a.finalRowIndx,g=a.finalColIndx;
a=a.evt;for(var f=this.getSelection().slice(0),k=b.colModel,m=[],p=0;p<f.length;p++){var v=f[p],r=v.rowIndx,v=v.dataIndx,t=b.getColIndx({dataIndx:v});t<e||t>g?m.push({rowIndx:r,colIndx:t,dataIndx:v}):(r<c||r>h)&&m.push({rowIndx:r,colIndx:t,dataIndx:v})}this.remove({cells:m});m=[];for(t=e;t<=g;t++)if(b=k[t],v=b.dataIndx,!b.hidden){r=c;do m.push({rowIndx:r,colIndx:t,dataIndx:v,focus:!1}),r++;while(r<=h)}this.add({cells:m,evt:a})}})(jQuery);
(function(f){var k=(f.paramquery.cCheckBoxColumn=function(k,e){var c=this;this.that=k;this.options=k.options;this.column=e;e.cb=f.extend({},{all:!1,header:!0,select:!0},e.cb);this.dataIndx=e.dataIndx;var a=k.widgetEventPrefix.toLowerCase(),b=k.element,d=k.eventNamespace;b.on(a+"dataavailable"+d,function(a,b){if(c.belongs(a))return c._onDataAvailable(a,b)});b.on(a+"cellclick"+d,function(a,b){if(c.belongs(a))return c.cellClick(a,b)});e.cb.reverse&&(b.on(a+"rowselect"+d,function(a,b){if(c.belongs(a))return c.rowSelect(a,
b)}),b.on(a+"rowunselect"+d,function(a,b){if(c.belongs(a))return c.rowUnSelect(a,b)}));b.on(a+"cellkeydown"+d,function(a,b){if(c.belongs(a))return c.cellKeyDown(a,b)});b.on(a+"refresh"+d+" "+a+"refreshrow"+d,function(a,b){if(c.belongs(a))return c.refreshHeader(a,b)})}).prototype=new f.paramquery.cClass;k.hasHeaderChkBox=function(){return this.column.cb.header};k.setValCBox=function(){if(this.hasHeaderChkBox()){for(var f=this.that,e=this.options,c=this.dataIndx,f=this.column.cb.all?e.dataModel.data:
f.pdata,e=null,a=0,b=0,d=0,l=f.length;d<l;d++)f[d][c]?a++:b++;a==l?e=!0:b==l&&(e=!1);this.$inp.pqval({val:e})}};k.onHeaderClick=function(k){var e=this.that,c=f(k.currentTarget).find("input"),a=this.column,b=a.dataIndx,d=e.getColIndx({dataIndx:b}),l=a.cb,h=l.all?e.options.dataModel.data:e.pdata,a={column:a,dataIndx:b,source:"header"},g=f(k.target).is("input")?!0:!1,q=c.is(":checked"),n=q;g||(n=!q);if(n){if(!1===e._trigger("beforeCheck",k,a))return!1;g||c.pqval({val:!0});c=0;for(g=h.length;c<g;c++)q=
h[c],q[b]=!0;e.$tbl.children().children().children("[pq-col-indx="+d+"]").find("input").prop("checked",!0);!1!==e._trigger("check",k,a)&&l.select&&this.selectAllRows()}else{if(!1===e._trigger("beforeunCheck",k,a))return!1;g||c.pqval({val:!1});c=0;for(g=h.length;c<g;c++)q=h[c],q[b]=!1;e.$tbl.children().children().children("[pq-col-indx="+d+"]").find("input").prop("checked",!1);!1!==e._trigger("unCheck",k,a)&&l.select&&this.unSelectAllRows()}};k.refreshHeader=function(f,e){if(this.hasHeaderChkBox()){var c=
this.that;if(c.pdata){var a=this;if(c=c.getCellHeader({dataIndx:this.dataIndx}))c.html("<input type='checkbox'/>"),this.$inp=c.find("input"),c.click(function(b){return a.onHeaderClick(b)}),this.setValCBox()}}};k.selectAllRows=function(){this.that.iRows.selectAll({all:this.column.cb.all})};k.unSelectAllRows=function(){this.that.iRows.removeAll({all:this.column.cb.all})};k._onDataAvailable=function(){var f=this.that,e=this.options,c=e.dataModel.data,e="remote"==e.pageModel.type?f.rowIndxOffset:0,a=
this.column,b=a.cb,d=a.dataIndx;if(null!=d&&c){for(var l=[],h=0,g=c.length;h<g;h++){var k=c[h];k[d]&&l.push({rowIndx:h+e,rowData:k})}if(!1!==f._trigger("check",null,{rows:l,column:a,dataIndx:d,source:"dataAvailable"})&&b.select)for(h=0;h<g;h++)k=c[h],k[d]&&(k.pq_rowselect=!0)}};k.cellClick=function(f,e){if(e.dataIndx===this.dataIndx)return this.raiseEvent(f,e)};k.rowSelect=function(f,e){var c=this.that,a=e.rows,b=e.rowData,d=this.dataIndx;if(a)for(var l=0,h=a.length;l<h;l++){var b=a[l],g=b.rowIndx,
b=b.rowData;b[d]=!0;c.refreshCell({rowIndx:g,dataIndx:d})}else b&&(b[d]=!0,g=e.rowIndx,c.refreshCell({rowIndx:g,dataIndx:d}));this.setValCBox()};k.rowUnSelect=function(f,e){var c=this.that,a=e.rows,b=e.rowData,d=this.dataIndx;if(a)for(var l=0,h=a.length;l<h;l++){var b=a[l],g=b.rowIndx,b=b.rowData;b[d]=!1;c.refreshCell({rowIndx:g,dataIndx:d})}else b&&(b[d]=!1,g=e.rowIndx,c.refreshCell({rowIndx:g,dataIndx:d}));this.setValCBox()};k.raiseEvent=function(k,e){var c=this.that,a=e.rowData,b=this.column.cb,
d=f(k.originalEvent.target).is("input")?!0:!1,l=e.rowIndx,h=e.dataIndx;if(a[h]){if(!1===c._trigger("beforeunCheck",k,e))return!1;a[h]=!1;d||(a=c.getCell(e).find("input"),a.pqval({val:!1}));!1!==c._trigger("unCheck",k,e)&&b.select&&c.iRows.remove({rowIndx:l})}else{if(!1===c._trigger("beforeCheck",k,e))return!1;a[h]=!0;d||(a=c.getCell(e).find("input"),a.pqval({val:!0}));!1!==c._trigger("check",k,e)&&b.select&&c.iRows.add({rowIndx:l})}this.setValCBox();if(!d)return!1};k.cellKeyDown=function(f,e){if(e.dataIndx=
this.dataIndx)if(13==f.keyCode||32==f.keyCode)return this.raiseEvent(f,e)}})(jQuery);
(function(){for(var f=0,k=["moz","webkit"],m=0;!window.requestAnimationFrame&&m<k.length;m++)window.requestAnimationFrame=window[k[m]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[k[m]+"CancelAnimationFrame"]||window[k[m]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var c=(new Date).getTime(),c=Math.max(0,16-(c-f));return window.setTimeout(function(){f=(new Date).getTime();e()},c)});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(e){clearTimeout(e)})})();
(function(f){function k(c){this.that=c;var a=this,b=c.element,d=c.widgetEventPrefix.toLowerCase(),e=c.eventNamespace;this.borderBottomExtra=this.borderBottom=this.borderLeftExtra=this.borderLeft=this.borderTopExtra=this.borderTop=this.borderRightExtra=this.borderRight=this.scrollLeft=this.scrollTop=0;this.maxBorder=5E3;this.rowht=c.options.rowHeight;this.colwd=60;b.on(d+"contmousedown"+e,function(b,c){if(a.belongs(b))return a._onContMouseDown(b,c)}).on(d+"mousedrag"+e,function(b,c){if(a.belongs(b)&&
a.swipedown)return a._onMouseDrag(b,c)}).on(d+"mousestop"+e,function(b,c){return a._onMouseStop(b,c)}).on(d+"mousepqup"+e,function(b,c){return a._onMousePQUp(b,c)}).on(d+"rowmousedown"+e,function(b,c){if(a.belongs(b))return a._onRowMouseDown(b,c)}).on(d+"cellmousedown"+e,function(b,c){if(a.belongs(b))return a._onCellMouseDown(b,c)}).on(d+"beforetableview"+e,function(b,c){if(a.belongs(b))return a._beforeTableView(b,c)}).on(d+"refresh"+e,function(b,c){if(a.belongs(b))return a._onRefresh(b,c)}).on(d+
"cellmouseenter"+e,function(b,c){if(a.belongs(b))return a._onCellMouseEnter(b,c)}).on(d+"rowmouseenter"+e,function(b,c){if(a.belongs(b))return a._onRowMouseEnter(b,c)})}var m=f.paramquery.pqgrid.calcWidthCols;f.paramquery.cMouseSelection=k;var e=k.prototype=new f.paramquery.cClass;e._beforeTableView=function(c,a){var b=this.that,d=b.getFocusElement();this.lastFocus=null;d&&d.$grid&&(d=d.$ae,d.hasClass("pq-grid-row")?this.lastFocus=b=b.getRowIndx({$tr:d}):d.hasClass("pq-grid-cell")&&(this.lastFocus=
b=b.getCellIndices({$td:d})))};e.inViewPort=function(c){var a=this.that.iRefresh,b=a.getEContHt(),a=a.getEContWd()+1;c=c[0];var d=this.scrollLeft;if(b>=c.offsetTop+c.offsetHeight+this.marginTop)if("TD"==c.nodeName.toUpperCase()){if(a>=c.offsetLeft+c.offsetWidth+d)return!0}else return!0};e._onRefresh=function(c,a){var b=this.that,d=this.lastFocus;d&&(b=null!=d.dataIndx?b.getCell(d):b.getRow(d))&&b.length&&b.attr("tabindex","0").focus()};e._onCellMouseDown=function(c,a){var b=this.that,d=a.rowIndx,
e=a.colIndx,h=b.options.selectionModel,g=h.mode;if("cell"==h.type&&null!=e)return c.shiftKey?(b.iCells.extendSelection({rowIndx:d,colIndx:e,mode:g,evt:c}),c.preventDefault()):(c.ctrlKey||c.metaKey)&&"single"!=g?b.iCells.isSelected({rowIndx:d,colIndx:e})?b.iCells.remove({rowIndx:d,colIndx:e}):b.iCells.add({rowIndx:d,colIndx:e}):h.addon?b.iCells.isSelected({rowIndx:d,colIndx:e})?b.iCells.remove({rowIndx:d,colIndx:e}):(b.iCells.add({rowIndx:d,colIndx:e}),this.mousedown={r1:d,c1:e}):(this.mousedown={r1:d,
c1:e},b.setSelection(null),b.iCells.add({rowIndx:d,colIndx:e,setFirst:!0})),!0};e._onCellMouseEnter=function(c,a){var b=this.that;if("cell"==b.options.selectionModel.type&&this.mousedown){var d=this.mousedown,e=d.c1,h=a.rowIndx,g=a.colIndx;if(d.r1!=h||e!=g)if(d.r2!=h||d.c2!=g)this.mousedown.r2=h,this.mousedown.c2=g,b.scrollCell({rowIndx:h,colIndx:g}),b.iCells.extendSelection({rowIndx:h,colIndx:g,evt:c})}};e._onRowMouseEnter=function(c,a){var b=this.that;if("row"==b.options.selectionModel.type&&this.mousedown){var d=
a.rowIndx;this.mousedown.r1!=d&&this.mousedown.r2!=d&&(this.mousedown.r2=d,b.scrollRow({rowIndx:d}),b.iRows.extendSelection({rowIndx:d,evt:c}))}};e._onRowMouseDown=function(c,a){var b=this.that,d=a.rowIndx,e=b.options.selectionModel,h=e.mode;if("row"==e.type&&null!=d)return c.shiftKey?(b.iRows.extendSelection({rowIndx:d,evt:c}),c.preventDefault()):(c.ctrlKey||c.metaKey)&&"single"!=h?b.iRows.isSelected({rowIndx:d})?b.iRows.remove({rowIndx:d}):b.iRows.add({rowIndx:d}):(this.mousedown={r1:d,y1:c.pageY,
x1:c.pageX},b.setSelection(null),b.iRows.add({rowIndx:d,setFirst:!0})),!0};e._onContMouseDown=function(c,a){this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown={x:c.pageX,y:c.pageY});return!0};e._onMousePQUp=function(c,a){this.mousedown=null};e._stopSwipe=function(c){c&&(this.swipedownPrev=this.swipedown=null);window.clearInterval(this.intID);window.cancelAnimationFrame(this.intID);this.intID=null};e._onMouseStop=function(c,a){var b=this,d=this.that;if(this.swipedownPrev){var e=d.options.swipeModel,
d=this.swipedownPrev,h=d.ts,g=(new Date).getTime()-h,f=c.pageX,k=c.pageY,m=f-d.x,p=k-d.y;if(Math.sqrt(m*m+p*p)/g>e.ratio){var v=0,r=e.repeat;b._stopSwipe();var t=function(){v+=e.speed;r--;b._onMouseDrag({pageX:f+v*m/g,pageY:k+v*p/g});0<r?b.intID=window.requestAnimationFrame(t):b._stopSwipe(!0)};t()}else b.swipedown=null,b.swipedownPrev=null}};e._onMouseDrag=function(c,a){var b=this.that.options;if(this.swipedown){var d=this.swipedown,e=d.x,h=d.y,g=c.pageX,f=c.pageY;this.swipedownPrev={x:e,y:h,ts:(new Date).getTime()};
var k=b.scrollModel.smooth;if(!b.virtualY||k)this.scrollVertSmooth(h,f),this.syncScrollBarVert();b.virtualX&&!k||"flex"===b.width||(this.scrollHorSmooth(e,g),this.syncScrollBarHor());d.x=g;d.y=f}return!0};e.updateTableY=function(c){if(0==c)return!1;var a=this.that,b=this.getTableForVertScroll(),a=a.iRefresh.getEContHt();if(!b||!b.length)return!1;var d=b.data("offsetHeight")-1,e=this.scrollTop-c;this.setScrollTop(0>e?0:0>c&&0<a-d+e?d-a:e,b,a);return!0};e.setScrollTop=function(c,a,b){0<=c&&(this.scrollTop=
c=Math.round(c),a.parent("div").scrollTop(c))};e.getScrollLeft=function(c){return this.scrollLeft};e.getScrollTop=function(c){return this.scrollTop};e.setScrollLeft=function(c,a,b,d){0<=c&&(this.scrollLeft=c=Math.round(c),b=b?b.parent():f(),b=b.add(a?a.parent("div"):f()),b.scrollLeft(c))};e.scrollVertSmooth=function(c,a){c!=a&&this.updateTableY(a-c)};e.scrollHorSmooth=function(c,a){if(c!=a){var b=this.that,d=b.options,e=a-c,h=this.getTableForHorScroll(),g=this.getTableHeaderForHorScroll(),b=b.iRefresh.getEContWd();
if(h||g){var f=h?h:g,d=d.virtualX?this.getScrollWidth(f):f.data("scrollWidth"),e=this.scrollLeft-e;this.setScrollLeft(0>e?0:0>d-b-e?d-b:e,h,g,b)}}};e.syncViewWithScrollBarVert=function(c){if(null!=c){var a=this.that,b=this.getTableForVertScroll();if(b&&b.length){var d=a.options;d.editModel.indices&&a.blurEditor({force:!0});var e=b.data("offsetHeight"),a=a.iRefresh.getEContHt();c*=e-a;if((!e||!a)&&d.debug)throw"_syncViewWithScrollBarVert !scrollHt || !contHt";0>c&&(c=0);this.setScrollTop(c,b,a)}}};
e.syncViewWithScrollBarHor=function(c){if(null!=c){var a=this.that,b=this.getTableForHorScroll(),d=this.getTableHeaderForHorScroll();if(b||d){var e=a.options;e.editModel.indices&&a.blurEditor({force:!0});var h=b?b:d,e=e.virtualX?this.getScrollWidth(h):h.data("scrollWidth"),a=a.iRefresh.getEContWd();c*=e-a;e&&a&&(0>c&&(c=0),this.setScrollLeft(c,b,d,a))}}};e.resetMargins=function(){this.scrollTop=this.scrollLeft=0};e.syncHeaderViewWithScrollBarHor=function(c){if(null!=c){var a=this.that,b=this.getTableHeaderForHorScroll();
if(b){var d=a.options,e=d.freezeCols;d.editModel.indices&&a.blurEditor({force:!0});var d=b.data("scrollWidth"),h=a.iRefresh.getEContWd();c=m.call(a,e,c+e);d&&h&&(0>c&&(c=0),b.css("marginLeft",-c))}}};e.syncScrollBarVert=function(){var c=this.that,a=this.getTableForVertScroll();if(a&&a.length){var a=a.data("offsetHeight"),b=c.iRefresh.getEContHt(),a=this.scrollTop/(a-b);0<=a&&1>=a&&c.$vscroll.hasClass("pq-sb-vert")&&c.$vscroll.pqScrollBar("option","ratio",a)}};e.syncScrollBarHor=function(){var c=this.that,
a=c.options,b=this.getTableForHorScroll(),d=this.getTableHeaderForHorScroll();if(b||d)b=b?b:d,a=a.virtualX?this.getScrollWidth(b):b.data("scrollWidth"),b=c.iRefresh.getEContWd(),a=this.scrollLeft/(a-b),0<=a&&1>=a&&c.$hscroll.hasClass("pq-sb-horiz")&&c.$hscroll.pqScrollBar("option","ratio",a)};e.getTableForVertScroll=function(){var c=this.that,a=c.pqpanes;if((c=c.$tbl)&&c.length)return a.h&&a.v?c=f([c[2],c[3]]):a.v?c=f([c[0],c[1]]):a.h&&(c=f(c[1])),c};e.getTableForHorScroll=function(){var c=this.that,
a=c.pqpanes,b=[],d=c.$tbl;if(d&&d.length)return a.h&&a.v?b.push(d[1],d[3]):a.v?b.push(d[1]):a.h?b.push(d[0],d[1]):b.push(d[0]),c.tables.length&&(c=c.tables[0].$tbl,a.v?b.push(c[1]):b.push(c[0])),f(b)};e.getTableHeaderForHorScroll=function(){var c=this.that,a=c.pqpanes;if((c=c.$tbl_header)&&c.length)return c=a.vH?f(c[1]):f(c[0]),c.parent()};e.scrollRowNonVirtual=function(c){var a=this.that,b=a.options,d=c.rowIndxPage,e=c.rowIndx;c=a.iRefresh.getEContHt();d=null==d?e-a.rowIndxOffset:d;b=parseInt(b.freezeRows);
if(!(d<b)){var b=a.get$Tbl(d),h=a.getRow({rowIndxPage:d})[0];h&&(a=b[0].offsetTop+1,d=h.offsetHeight,e=this.getScrollTop(),h=h.offsetTop,0>a+h-e?(a=a+h+-1,this.setScrollTop(0>a?0:a,b,c),this.syncScrollBarVert()):h+d-e>c&&(this.setScrollTop(d+h-c,b,c),this.syncScrollBarVert()))}};e.scrollColumnNonVirtual=function(c){var a=this.that,b=c.colIndx,b=null==b?a.getColIndx({dataIndx:c.dataIndx}):b,d=a.options.freezeCols;if(!(b<d)){c=a._calcRightEdgeCol(b).width;var b=a._calcRightEdgeCol(b-1).width,d=a._calcRightEdgeCol(d-
1).width,e=this.getTableForHorScroll(),h=this.getTableHeaderForHorScroll(),a=a.iRefresh.getEContWd(),g=this.scrollLeft;c-g>a?(this.setScrollLeft(c-a,e,h,a),this.syncScrollBarHor()):b-d<g&&(this.setScrollLeft(b-d,e,h,a),this.syncScrollBarHor())}}})(jQuery);
(function(f){var k=null,m=!1,e="",c=f.paramquery.pqGrid.prototype,a=c.options,b={on:!0,header:!0,zIndex:1E4},d={on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"};c.copy=function(){k=new l(this);k.copy();k=null};c.paste=function(){k=new l(this);k.paste();k=null};a.pasteModel=a.pasteModel||d;a.copyModel=a.copyModel||b;var l=function(a,b){var c;this.that=a;b&&b.hasClass("pq-grid-row")?(this.rowIndx=a.getRowIndx({$tr:b}).rowIndx,this.dataIndx=null):b&&b.hasClass("pq-grid-cell")?
(c=a.getCellIndices({$td:b}),this.rowIndx=c.rowIndx,this.dataIndx=c.dataIndx):this.dataIndx=this.rowIndx=null},c=l.prototype;c.createClipBoard=function(){var a=f("#pq-grid-excel-div"),a=this.that.options.copyModel,b=f("#pq-grid-excel");0==b.length&&(a=f("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+a.zIndex+";'/>").appendTo(document.body),b=f("<textarea id='pq-grid-excel' autocomplete='off'  style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(a),
b.css({opacity:0}));b.select()};c.destroyClipBoard=function(){var a=this.that,b,c=a.iCells.getFocusSelection({old:!0});c?b=a.getCell({rowIndx:c.rowIndx,dataIndx:c.dataIndx}):(c=a.iRows.getFocusSelection({old:!0}))&&(b=a.getRow({rowIndx:c.rowIndx}));var c=f(window).scrollTop(),d=f(window).scrollLeft();b?b.attr("tabindex",0).focus():a.$cont.focus();a=f(window).scrollTop();b=f(window).scrollLeft();c==a&&d==b||window.scrollTo(d,c)};c.clearClipBoard=function(){f("#pq-grid-excel").val("")};c.copy=function(){var a=
f("#pq-grid-excel"),b=this.that,c=b.colModel,d=c.length,k=b.iGenerateView.readCell,l=[],m=[];if(b.options.copyModel.on){for(var l=b.iRows.getSelection(),r=0,t=l.length;r<t;r++){for(var s=l[r],y=s.rowData,x=[],w=0;w<d;w++)s=c[w],!1!==s.copy&&x.push(k(y,s));w=x.join("\t");m.push(w)}l=b.iCells.getSelection();c=b=null;x=[];r=0;for(t=l.length;r<t;r++)s=l[r],b=s.rowIndx,y=s.rowData,s=s.column,!1!==s.copy&&(null!=c&&b!=c?(w=x.join("\t"),x=[],m.push(w),c=b):null==c&&(c=b),x.push(k(y,s)));m.push(x.join("\t"));
w=m.join("\n");a.length&&(a.val(w),a.select());e=w}};c.paste=function(){var a=this.that,b=f("#pq-grid-excel"),c=b.length?b.val():e,c=c.replace(/\n$/,""),b=c.split("\n"),d=b.length,k,l=a.colModel,m=a.iGenerateView.readCell,r=a.options.pasteModel,t="row",s=l.length;if(r.on&&0!=c.length&&0!=d){c={rows:b};if(!1===a._trigger("beforePaste",null,c))return!1;var c=r.type,y,x,w,A,z=a.iRows.getSelectionCurPage();z&&z.length||(t="cell",z=a.iCells.getSelectionCurPage());z&&z.length?(y=z[0].rowIndx,w=z[z.length-
1].rowIndx,"cell"==t&&(x=a.getColIndx({dataIndx:z[0].dataIndx}),A=a.getColIndx({dataIndx:z[z.length-1].dataIndx}))):A=x=w=y=0;var F,B;"replace"==c?(F=y,B=w-y+1<d?"extend":"repeat"):"append"==c?(F=w+1,B="extend"):"prepend"==c&&(F=y,B="extend");var E;y="extend"==B?d:w-y+1;var C;w=0;for(var z=[],G=d=0;G<y;G++){var D=b[w],H=G+F,I="replace"==c?a.getRowData({rowIndx:H}):null,M=I?{}:null,K={};void 0===D&&"repeat"===B&&(w=0,D=b[w]);w++;var P=D.split("\t");if(!k)if("cell"==t){k=P.length;E=A-x+1<P.length?"extend":
"repeat";k="extend"==E?k:A-x+1;if(isNaN(k))throw"lenH NaN. assert failed.";k+x>s&&(k=s-x)}else k=s,x=0;var N=0,U=0,D=0;C=k;for(U=0;U<C;U++){var L=l[U+x],J=P[N],Q=L.dataIndx;L.hidden?"extend"==E&&C+x<s&&C++:(void 0===J&&"repeat"===E&&(N=0,J=P[N]),N++,K[Q]=J,M&&(M[Q]=m(I,L)))}!1==f.isEmptyObject(K)&&(P="update",null==I&&(P="add"),z.push({newRow:K,rowIndx:H,rowData:I,oldRow:M,type:P}),d++)}c={rowList:z,source:"paste",allowInvalid:r.allowInvalid,validate:r.validate};a._digestData(c);r.select&&("cell"==
t?a.iCells.selectBlock({initRowIndx:F,finalRowIndx:F+d-1,initColIndx:x,finalColIndx:"extend"==E?x+k-1+D:A}):a.iRows.selectRange({initRowIndx:F,finalRowIndx:F+d-1}));a.refreshView();c={rows:b};a._trigger("paste",null,c)}};f(document).unbind(".pqExcel").bind("keydown.pqExcel",function(a){if(a.ctrlKey||a.metaKey){var b=f(a.target);if(b.hasClass("pq-grid-row")||b.hasClass("pq-grid-cell")||b.is("#pq-grid-excel")||b.is("div.pq-grid-cont")){var c=b.closest(".pq-grid");if(k||b.length&&c.length){if(!k){try{var d=
c.pqGrid("getInstance").grid}catch(e){return!0}k=new l(d,b);k.createClipBoard()}"67"==a.keyCode||"99"==a.keyCode?k.copy():"86"==a.keyCode||"118"==a.keyCode?(m=!0,k.clearClipBoard(),window.setTimeout(function(){k&&(k.paste(),k.destroyClipBoard(),k=null);m=!1},0)):(b=f("#pq-grid-excel"),b.length&&document.activeElement==b[0]&&k.that._onKeyPressDown(a))}}}}).bind("keyup.pqExcel",function(a){var b=a.keyCode;m||!k||a.ctrlKey||a.metaKey||-1==f.inArray(b,[17,91,93,224])||(k.destroyClipBoard(),k=null)})})(jQuery);
(function(f){var k=f.paramquery.pqGrid.prototype.options,m={on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};k.historyModel=k.historyModel||m;k=(f.paramquery.cHistory=function(e){var c=this;this.that=e;this.options=e.options;this.records=[];this.id=this.counter=0;var a=e.eventNamespace,b=e.widgetEventPrefix.toLowerCase();e.element.on(b+"keydown"+a,function(a,b){if(c.belongs(a))return c._onKeyDown(a,b)});e.element.on(b+"dataavailable"+a,function(a,b){c.belongs(a)&&"filter"!=b.source&&c.reset()})}).prototype=
new f.paramquery.cClass;k._onKeyDown=function(e,c){var a=e.ctrlKey||e.metaKey;if(a&&"90"==e.keyCode)return this.undo(),!1;if(a&&"89"==e.keyCode)return this.redo(),!1};k.resetUndo=function(){if(0==this.counter)return!1;this.counter=0;this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})};k.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[];this.id=this.counter=0;this.that._trigger("history",
null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})};k.increment=function(){var e=this.records,c=e.length;this.id=c?e[c-1].id+1:0};k.push=function(e){var c=this.canRedo(),a=this.records,b=this.counter;a.length>b&&a.splice(b,a.length-b);a[b]=f.extend({id:this.id},e);this.counter++;e=this.that;var d,k;1==this.counter&&(d=!0);c&&this.counter==a.length&&(k=!1);e._trigger("history",null,{type:"add",canUndo:d,canRedo:k,num_undo:this.counter,num_redo:0})};k.canUndo=function(){return 0<this.counter?
!0:!1};k.canRedo=function(){return this.counter<this.records.length?!0:!1};k.undo=function(){var e=this.canRedo(),c=this.that,a=this.options.historyModel,b=this.records;if(0<this.counter)this.counter--;else return!1;for(var b=b[this.counter].rowList,d=[],f=0,h=b.length;f<h;f++){var g=b[f],k=g.newRow,m=g.rowData,u=g.type,p=g.oldRow,g=g.rowIndx;"update"==u?(g=c.getRowIndx({rowData:m}).rowIndx,d.push({type:u,rowIndx:g,rowData:m,oldRow:k,newRow:p})):"add"==u?d.push({type:"delete",rowData:k}):"delete"==
u&&d.push({type:"add",rowIndx:g,newRow:m})}c._digestData({history:!1,source:"undo",checkEditable:a.checkEditable,checkEditableAdd:a.checkEditableAdd,allowInvalid:a.allowInvalid,rowList:d});c.refreshView();var v,r;!1===e&&(v=!0);0==this.counter&&(r=!1);c._trigger("history",null,{canUndo:r,canRedo:v,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter});return!0};k.redo=function(){var e=this.canUndo(),c=this.that,a=this.options.historyModel,b=this.counter,d=this.records;if(b==
d.length)return!1;for(var b=d[b].rowList,f=[],h=0,g=b.length;h<g;h++){var k=b[h],m=k.newRow,u=k.rowData,p=k.type,v=k.oldRow,k=k.rowIndx;"update"==p?(k=c.getRowIndx({rowData:u}).rowIndx,f.push({type:p,rowIndx:k,rowData:u,oldRow:v,newRow:m})):"add"==p?f.push({type:"add",rowIndx:k,newRow:m}):"delete"==p&&f.push({type:"delete",rowData:u})}c._digestData({history:!1,source:"redo",checkEditable:a.checkEditable,checkEditableAdd:a.checkEditableAdd,allowInvalid:a.allowInvalid,rowList:f});c.refreshView();this.counter<
d.length&&this.counter++;var r,t;!1==e&&(r=!0);this.counter==this.records.length&&(t=!1);c._trigger("history",null,{canUndo:r,canRedo:t,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter});return!0};f.paramquery.pqGrid.prototype.history=function(e){return this.iHistory[e.method](e)}})(jQuery);
(function(f){var k=f.ui.autocomplete.prototype,m=k._renderMenu,e=k._renderItem;k._renderMenu=function(c,a){m.call(this,c,a);var b=this.options.selectItem;if(b&&b.on){var b=b.cls,b=void 0===b?"ui-state-highlight":b,d=this.element.val();d&&b&&f("a",c).filter(function(){return f(this).text()===d}).addClass(b)}};k._renderItem=function(c,a){var b=e.call(this,c,a),d=this.options.highlightText;if(d&&d.on){var f=this.element.val();if(f){var f=new RegExp("("+f+")","i"),h=a.label;if(f.test(h)){var g=d.style,
d=d.cls,h=h.replace(f,"<span style='"+(void 0===g?"font-weight:bold;":g)+"' class='"+(void 0===d?"":d)+"'>$1</span>");b.find("a").html(h)}}}return b};f.widget("paramquery.pqTooltip",f.ui.tooltip,{options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var c=f(this),a=c.closest(".pq-grid").pqGrid("getInstance").grid,b=a.getCellIndices({$td:c});return(a=a.data({rowIndx:b.rowIndx,dataIndx:b.dataIndx,data:"pq_valid"}).data)?(c=a.icon,a=a.msg,(""==
c?"":"<span class='ui-icon "+c+" pq-tooltip-icon'></span>")+(null!=a?a:"")):c.attr("title")}},_create:function(){this._super();var c=this.element,a=this.eventNamespace;c.on("pqtooltipopen"+a,function(a,c){var e=f(a.target),h=f(a.originalEvent.target);h.on("remove",function(a){e.pqTooltip("close",a,!0)});c.tooltip.css("zIndex",h.zIndex()+5);if(e.is(".pq-grid")){var g=e.pqGrid("getCellIndices",{$td:h}),k=g.dataIndx,m;(m=e.pqGrid("getRowData",{rowIndx:g.rowIndx}))&&(m=m.pq_celldata)&&(m=m[k])&&(m=m.pq_valid)&&
(k=m,g=k.style,c.tooltip.addClass(k.cls),k=c.tooltip.attr("style"),c.tooltip.attr("style",k+";"+g));e.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(a,b){a.currentTarget=h[0];e.pqTooltip("close",a,!0)})}});c.on("pqtooltipclose"+a,function(a,c){var e=f(a.target);f(a.originalEvent.target).off("remove");e.is(".pq-grid")&&e.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})}})})(jQuery);
(function(f){f.paramquery.filter=function(){var e={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",
TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}};return{conditions:e,getAllConditions:function(){var c=[],a;for(a in e)c.push(a);return c}(),getConditions:function(c){var a=[],b;for(b in e)e[b][c]&&
a.push(b);return a},getTRConditions:function(){var c=[],a;for(a in e)e[a].TR&&c.push(a);return c}(),getWTRConditions:function(){var c=[],a;for(a in e)e[a].TR||c.push(a);return c}()}}();f.paramquery.filter.rules={};f.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",
great:"Great Than",gte:"Greater than or equal"};var k=function(e){this.that=e};f.paramquery.cFilterData=k;var m=k.prototype;k.conditions={equal:function(e,c){if(e==c)return!0},contain:function(e,c){if(-1!=e.indexOf(c))return!0},notcontain:function(e,c){if(-1==e.indexOf(c))return!0},empty:function(e){if(0==e.length)return!0},notempty:function(e){if(0<e.length)return!0},begin:function(e,c){if(0==(e+"").indexOf(c))return!0},notbegin:function(e,c){if(0!=e.indexOf(c))return!0},end:function(e,c){var a=
e.lastIndexOf(c);if(-1!=a&&a+c.length==e.length)return!0},notend:function(e,c){var a=e.lastIndexOf(c);if(-1==a||a+c.length!=e.length)return!0},regexp:function(e,c){if(c.test(e))return c.lastIndex=0,!0},notequal:function(e,c){if(e!=c)return!0},great:function(e,c){if(e>c)return!0},gte:function(e,c){if(e>=c)return!0},between:function(e,c,a){if(e>=c&&e<=a)return!0},range:function(e,c){if(-1!=f.inArray(e,c))return!0},less:function(e,c){if(e<c)return!0},lte:function(e,c){if(e<=c)return!0}};k.convert=function(e,
c){e=null==e?"":e;"string"==c?e=f.trim(e).toUpperCase():"date"==c?e=Date.parse(e):"integer"==c?e=parseInt(e):"float"==c?e=parseFloat(e):"bool"==c&&(e=String(e).toLowerCase());return e};m.isMatchCellSingle=function(e,c){var a=e.dataType,b=e.value,d=e.value2,f=e.cbFn,h=c[e.dataIndx],h="regexp"==e.condition?null==h?"":h:k.convert(h,a);return f(h,b,d)?!0:!1};m.isMatchRow=function(e,c,a){if(0==c.length)return!0;for(var b=0;b<c.length;b++){var d=this.isMatchCell(c[b],e);if("OR"==a&&d)return!0;if("AND"==
a&&!d)return!1}if("AND"==a)return!0;if("OR"==a)return!1};m.getQueryStringFilter=function(){var e=this.that,c=e.options,a=c.stringify,c=c.filterModel,b=c.mode,e=this.getFilterData({CM:e.colModel,location:"remote"}),d="";c&&c.on&&e&&(e.length?(c={mode:b,data:e},d=!1===a?c:JSON.stringify(c)):d="");return d};m.filterLocalData=function(e){e=e||{};var c=this.that,a=e.apply;e=this.getFilterData({CM:!1===a?e.CM:c.colModel});var b=c.options,d=b.dataModel,f=c.iSort,h=d.data,g=d.dataUF,k=b.filterModel,m=k.multiple,
b=k?k.mode:null;h||(h=d.data=[]);g||(g=d.dataUF=[]);!1===a&&(h=h.slice());if(g.length)h.push.apply(h,g),0==f.readSorter().length&&f.sortLocalData(h),g=d.dataUF=[];else if(e.length)f.saveOrder();else return{data:h,dataUF:g};this.isMatchCell=m?this.isMatchCellMultiple:this.isMatchCellSingle;if(k.on&&b&&e&&e.length&&h.length)for(d=h.length-1;0<=d;d--)this.isMatchRow(h[d],e,b)||g.push(h.splice(d,1)[0]);!1!==a&&(c._queueATriggers.filter={ui:{type:"local",filter:e}});return{data:h,dataUF:g}};m.getFilterData=
function(e){var c=e.CM;if(!c)throw"CM N/A";var a=c.length,b=e.location;e=this.that.options.filterModel.multiple;for(var d=f.paramquery.filter.getAllConditions,k=f.paramquery.filter.getTRConditions,h=[],g=f.paramquery.cFilterData,m=function(a,b,c){return"function"==typeof a?!0:"between"==a?null!=b&&""!==b||null!=c&&""!==c?!0:!1:-1!=f.inArray(a,d)?null!=b&&""!==b||-1==f.inArray(a,k)?!0:!1:!0},n=function(a,c){return"remote"==b?(null==a?"":a).toString():g.convert(a,c)},u=0;u<a;u++){var p=c[u],v=p.dataIndx,
r=p.dataType,r=r&&"function"!=typeof r?r:"string",t=p.filter;if(e){if((t=p.filterModel)&&t.on){for(var s=[],y=t.mode,x=t.filters,p=0;p<x.length;p++){var t=x[p],w=t.value,A=t.condition;m(A,w)&&(w=n(w,r),s.push({value:w,condition:A}))}h.push({dataIndx:v,mode:y,dataType:r,filters:s})}}else if(t&&t.on&&(w=t.value,s=t.value2,A=t.condition,m(A,w,s))){if("between"==A)""===w||null==w?(A="lte",w=n(s,r)):""===s||null==s?(A="gte",w=n(w,r)):(w=n(w,r),s=n(s,r));else if("regexp"==A)if("remote"==b)w=w.toString();
else{if("string"==typeof w)try{var z=t.modifiers,z=z?z:"gi",w=new RegExp(w,z)}catch(F){w=/.*/}}else if("range"==A)if(null==w)continue;else if("string"==typeof w)w=n(w,r),w=w.split(/\s*,\s*/);else{if(w&&"function"==typeof w.push){if(0==w.length)continue;w=w.slice();p=0;for(t=w.length;p<t;p++)w[p]=n(w[p],r)}}else w=n(w,r);h.push({dataIndx:v,value:w,value2:s,condition:A,dataType:r,cbFn:"remote"==b?"":"function"==typeof A?A:g.conditions[A]})}}return h}})(jQuery);
(function(f){f=(f.paramquery.cSort=function(f){this.that=f;this.sorters=[];this.cancel=!1}).prototype;f.cancelSort=function(){this.cancel=!0};f.resumeSort=function(){this.cancel=!1};f.readSorter=function(){var f=this.that.options,m=f.groupModel,e=m?m.dataIndx:null,c=m?m.dir:null,a=[];if(m&&e)for(m=0;m<e.length;m++)a.push({dataIndx:e[m],dir:c&&c[m]?c[m]:"up"});e=f.sortModel;f=e.sorter;e=e.single;f&&f.length&&(e&&(f=[f[0]]),a=a.concat(f));return a};f.setSingle=function(f){this.single=f};f.getSingle=
function(){return this.single};f.readSingle=function(){return this.that.options.sortModel.single};f.writeSingle=function(f){this.that.options.sortModel.single=f};f.setCancel=function(f){this.cancel=f};f.getCancel=function(){return this.cancel};f.readCancel=function(){return this.that.options.sortModel.cancel};f.writeCancel=function(f){this.that.options.sortModel.cancel=f};f.writeSorter=function(f){var m=this.that.options,e=m.sortModel,c=m.groupModel,m=c?c.dataIndx:null,a=c?c.dir:null;if(m){a||(c.dir=
[]);for(c=0;c<m.length;c++){var b=f[c];if(m[c]!=b.dataIndx)throw"gDataIndx!=sorter.dataIndx";a[c]=b.dir}f.splice(0,m.length)}e.sorter=f};f.refreshSorter=function(f){f=f||{};var m=f.sorter,e=m[0].dataIndx,c=m[0].dir,a=f.single,m=f.cancel,b=this.that.options.groupModel,d=b?b.dataIndx:null,l=d?d.length:0,h=-1;f=this.readSorter();if(null==a)throw"sort single N/A";if(b)for(b=0;b<d.length;b++)d[b]==e&&(h=b);-1<h?f[h].dir="up"===f[h].dir?"down":"up":null!=e&&(a?f[l]&&f[l].dataIndx==e?(e=f[l].dir,e="up"===
e?"down":m&&"down"===e?"":"up",""===e?f.length--:f[l].dir=e):f[l]={dataIndx:e,dir:c?c:"up"}:(l=this.inSorters(f,e),-1<l?(e=f[l].dir,"up"==e?f[l].dir="down":m&&"down"==e?f.splice(l,1):1==f.length?f[l].dir="up":f.splice(l,1)):f.push({dataIndx:e,dir:"up"})));return f};f.saveOrder=function(f){var m=this.that.options.dataModel;f=m.data;if(!(!f||!f.length||m.dataUF&&m.dataUF.length||this.getSorter().length&&null!=f[0].pq_order))for(var m=0,e=f.length;m<e;m++)f[m].pq_order=m};f.getQueryStringSort=function(){if(this.cancel)return"";
var f=this.sorters,m=this.that.options.stringify;return f.length?!1===m?f:JSON.stringify(f):""};f.getSorter=function(){return this.sorters};f.setSorter=function(f){this.sorters=f.slice(0)};f.inSorters=function(f,m){for(var e=-1,c=0;c<f.length;c++)if(f[c].dataIndx==m){e=c;break}return e};f.sortLocalData=function(f){for(var m=this.that,e=m.colModel,c=this.sorters,a=0;a<c.length;a++){var b=c[a],d=m.getColIndx({dataIndx:b.dataIndx}),d=e[d],l=d.sortType;b.dataType=d.dataType;b.sortType=l}c.length||(c=
[{dataIndx:"pq_order",dir:"up",dataType:"integer"}]);return this._sortLocalData(c,f)};f._sortLocalData=function(f,m){function e(a,b,c,d){a=a[c];b=b[c];a=a?parseInt(a,10):0;b=b?parseInt(b,10):0;return(a-b)*d}function c(a,b,c,d){a=a[c];b=b[c];a=a?Date.parse(a):0;b=b?Date.parse(b):0;return(a-b)*d}function a(a,b,c,d){a=(a[c]+"").replace(/,/g,"");b=(b[c]+"").replace(/,/g,"");a=a?parseFloat(a):0;b=b?parseFloat(b):0;return(a-b)*d}function b(a,b,c,d){a=a[c];b=b[c];a=a?a:"";b=b?b:"";c=0;a>b?c=1:a<b&&(c=-1);
return c*d}function d(a,b,c,d){a=a[c];b=b[c];a=a?a.toUpperCase():"";b=b?b.toUpperCase():"";c=0;a>b?c=1:a<b&&(c=-1);return c*d}function l(a,b,c,d){a=a[c];b=b[c];c=0;if(a&&!b||!1===a&&null===b)c=1;else if(b&&!a||!1===b&&null===a)c=-1;return c*d}if(null==m||0==m.length)return[];if(!f||!f.length)return m;var h=this.that,g=h.columns,q=h.iGenerateView.readCell;(function(){for(var h=[],u=[],p=[],v=f.length,r=0;r<v;r++){var t=f[r],s=t.dataIndx,y="up"==t.dir?1:-1,x=t.sortType,t=t.dataType;u[r]=s;p[r]=y;h[r]=
"integer"==t?e:"float"==t?a:"function"==typeof t?function(a){return function(b,c,d,e){return a(b[d],c[d])*e}}(t):x?function(a){return function(b,c,d,e){return a(b,c,d)*e}}(x):"date"==t?c:"stringi"==t?d:"bool"==t?l:b;if((y=g[s])&&y.nested)for(r=0,x=m.length;r<x;r++)t=m[r],t[s]=q(t,y)}m=m.sort(function(a,b){for(var c=0,d=0;d<v&&(c=h[d](a,b,u[d],p[d]),0==c);d++);return c})})();return m}})(jQuery);
