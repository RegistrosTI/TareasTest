/**
 * ParamQuery Pro v3.0.0
 * 
 * Copyright (c) 2012-2015 Paramvir Dhindsa (http://paramquery.com)
 * Released under Commercial license
 * http://paramquery.com/pro/license
 * 
 */
(function(f){var m=f.paramquery=f.paramquery||{};f.paramquery.pqgrid=f.paramquery.pqgrid||{};m.xmlToArray=function(h,c){var e=c.itemParent,a=c.itemNames,b=[];f(h).find(e).each(function(d,c){var e=f(c),g=[];f(a).each(function(a,b){g.push(e.find(b).text().replace(/\r|\n|\t/g,""))});b.push(g)});return b};m.xmlToJson=function(h,c){var e=c.itemParent,a=c.itemNames,b=[];f(h).find(e).each(function(d,c){for(var e=f(c),g={},q=0,p=a.length;q<p;q++){var h=a[q];g[h]=e.find(h).text().replace(/\r|\n|\t/g,"")}b.push(g)});
return b};m.tableToArray=function(h){var c=[],e=[];h=f(h).children("tbody").children("tr");var a=h.length?f(h[0]):f(),b=1<h.length?f(h[1]):f();a.children("th,td").each(function(a,e){var l=f(e),g=l.html(),l=l.width(),q="left";if(b.length)var p=b.find("td:eq("+a+")").attr("align"),q=p?p:q;c.push({title:g,width:l,dataType:"string",align:q,dataIndx:a})});h.each(function(a,b){if(0!=a){var c=[];f(b).children("td").each(function(a,b){c.push(f.trim(f(b).html()))});e.push(c)}});return{data:e,colModel:c}};
m.formatCurrency=function(f){if(isNaN(f))return f;f=Math.round(100*f)/100;f+="";-1==f.indexOf(".")?f+=".00":f.indexOf(".")+2==f.length&&(f+="0");var c=f.length,e=f.substring(0,c-3);f=f.substring(c-3,c);for(var e=e.match(/\d/g).reverse(),c=[],a=0;a<e.length;a++)0<a&&0==a%3&&c.push(","),c.push(e[a]);c=c.reverse();e=c.join("");return e+f};m.validation={is:function(f,c){if("string"==f||!f)return!0;f=f.substring(0,1).toUpperCase()+f.substring(1,f.length);return this["is"+f](c)},isFloat:function(f){var c=
parseFloat(f);return isNaN(c)||c!=f?!1:!0},isInteger:function(f){var c=parseInt(f);return isNaN(c)||c!=f?!1:!0},isDate:function(f){f=Date.parse(f);return isNaN(f)?!1:!0}}})(jQuery);
(function(f){function m(a,b,d){return a?f("<span tabindex='0' rel='tooltip' data-placement='top' title='"+b+"' class='panel panel-default "+d+"'></span>"):f("<span class='pq-ui-button ui-widget-header' tabindex='0' rel='tooltip' title='"+b+"'><span class='ui-icon ui-icon-"+d+"'></span></span>")}function h(a,b){a.bind("click keydown",function(a){if("keydown"!=a.type||a.keyCode==f.ui.keyCode.ENTER)return b.call(this,a)})}function c(a,b,d){b[d?"addClass":"removeClass"]("disabled").css("pointer-events",
d?"none":"").attr("tabindex",d?"":"0")}var e={options:{bootstrap:{on:!1,pager:"panel panel-default",nextIcon:"glyphicon glyphicon-forward",prevIcon:"glyphicon glyphicon-backward",firstIcon:"glyphicon glyphicon-step-backward",lastIcon:"glyphicon glyphicon-step-forward",refreshIcon:"glyphicon glyphicon-refresh"},curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},_regional:{strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",
strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"}};f.extend(e.options,e._regional);e._create=function(){var a=this,b=this.options,d=b.bootstrap,c=d.on;this.element.addClass("pq-pager "+(c?d.pager:""));this.first=m(c,b.strFirstPage,c?d.firstIcon:"seek-first").appendTo(this.element);h(this.first,function(b){1<a.options.curPage&&a._onChange(b,1)});this.prev=m(c,b.strPrevPage,c?d.prevIcon:"seek-prev").appendTo(this.element);
h(this.prev,function(b){1<a.options.curPage&&a._onChange(b,a.options.curPage-1)});f("<span class='pq-separator'></span>").appendTo(this.element);this.pageHolder=f("<span class='pq-page-placeholder'></span>").appendTo(this.element);f("<span class='pq-separator'></span>").appendTo(this.element);this.next=m(c,b.strNextPage,c?d.nextIcon:"seek-next").appendTo(this.element);h(this.next,function(b){a.options.curPage<a.options.totalPages&&a._onChange(b,a.options.curPage+1)});this.last=m(c,b.strLastPage,c?
d.lastIcon:"seek-end").appendTo(this.element);h(this.last,function(b){a.options.curPage!==a.options.totalPages&&a._onChange(b,a.options.totalPages)});f("<span class='pq-separator'></span>").appendTo(this.element);this.rPPHolder=f("<span class='pq-page-placeholder'></span>").appendTo(this.element);this.$refresh=m(c,b.strRefresh,c?d.refreshIcon:"refresh").appendTo(this.element);h(this.$refresh,function(b){if(!1===a._trigger("beforeRefresh",b))return!1;a._trigger("refresh",b)});f("<span class='pq-separator'></span>").appendTo(this.element);
this.$msg=f("<span class='pq-pager-msg'></span>").appendTo(this.element);this._refresh()};e._refreshPage=function(){var a=this;this.pageHolder.empty();for(var b=this.options,d=b.strPage.split(" "),c=[],e=0,g=d.length;e<g;e++){var q=d[e];"{0}"==q?c.push("<input type='text' tabindex='0' class='ui-corner-all' />"):"{1}"==q?c.push("<span class='total'></span>"):c.push("<span>",q,"</span>")}d=c.join("");d=f(d).appendTo(this.pageHolder);this.page=d.filter("input").bind("change",function(c){var d=f(this),
n=d.val();if(isNaN(n)||1>n)return d.val(b.curPage),!1;n=parseInt(n);if(n>b.totalPages||!1===a._onChange(c,n))return d.val(b.curPage),!1});this.$total=d.filter("span.total")};e._onChange=function(a,b){if(!1===this._trigger("beforeChange",a,{curPage:b})||!1===this._trigger("change",a,{curPage:b}))return!1;this.option({curPage:b})};e._refresh=function(){this._refreshPage();var a=this,b=this.options;this.rPPHolder.empty();if(b.strRpp){var d=b.rPPOptions,e=b.strRpp;if(-1!=e.indexOf("{0}")){for(var l=["<select class='ui-corner-all'>"],
g=0,q=d.length;g<q;g++){var p=d[g];l.push('<option value="',p,'">',p,"</option>")}l.push("</select>");d=l.join("");e=e.replace("{0}","</span>"+d);e="<span>"+e+"<span class='pq-separator'></span>"}else e="<span>"+e+"</span><span class='pq-separator'></span>";this.$rPP=f(e).appendTo(this.rPPHolder).filter("select").val(b.rPP).change(function(b){var n=f(this),u=n.val();if(!1===a._trigger("beforeChange",b,{rPP:u}))return n.val(a.options.rPP),!1;!1!==a._trigger("change",b,{rPP:u})&&(a.options.rPP=u)})}e=
b.bootstrap.on;d=b.curPage>=b.totalPages;c(e,this.next,d);c(e,this.last,d);d=1>=b.curPage;c(e,this.first,d);c(e,this.prev,d);this.page.val(b.curPage);this.$total.text(b.totalPages);0<this.options.totalRecords?(e=b.rPP,d=b.curPage,l=b.totalRecords,g=d*e,g>l&&(g=l),b=b.strDisplay,b=b.replace("{0}",(d-1)*e+1),b=b.replace("{1}",g),b=b.replace("{2}",l),this.$msg.html(b)):this.$msg.html("")};e._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()};e._setOption=function(a,b){if("curPage"==
a||"totalPages"==a)b=parseInt(b);this._super.call(this,a,b)};e._setOptions=function(){this._super.apply(this,arguments);this._refresh()};f.widget("paramquery.pqPager",e);f.paramquery.pqPager.regional={};f.paramquery.pqPager.regional.en=e._regional})(jQuery);
(function(f){function m(f,c){return f?"<div class='"+c+"'></div>":"<div class='ui-icon ui-icon-"+c+"'></div>"}f.widget("paramquery.pqScrollBar",{options:{length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",bootstrap:{on:!1,slider:"btn btn-default",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",left:"glyphicon glyphicon-chevron-left",right:"glyphicon glyphicon-chevron-right"},theme:!1},_destroy:function(){f(document).off("."+this.eventNamespace);
this.element.removeClass("pq-sb pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty();this.element.removeData()},_create:function(){this._createLayout()},_createLayout:function(){var h=this,c=this.options,e=c.bootstrap,a=e.on,b=c.direction,d=this.eventNamespace,k=c.theme,l=this.element.empty();"vertical"==b?(l.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb pq-sb-vert"),k?(l.addClass("pq-sb-vert-t"),
l[0].innerHTML=["<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'>",m(a,a?e.up:"triangle-1-n"),"</div><div class='pq-sb-slider ui-corner-all ui-state-default ",a?e.slider:"","'></div><div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'>",m(a,a?e.down:"triangle-1-s"),"</div>"].join("")):(l.addClass("pq-sb-vert-wt"),l[0].innerHTML="<div class='top-btn pq-sb-btn'></div><div class='pq-sb-slider'><div class='vert-slider-top'></div><div class='vert-slider-bg'></div><div class='vert-slider-center'></div><div class='vert-slider-bg'></div><div class='vert-slider-bottom'></div></div><div class='bottom-btn pq-sb-btn'></div>")):
(l.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb pq-sb-horiz"),k?(l.addClass("pq-sb-horiz-t"),l[0].innerHTML=["<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'>",m(a,a?e.left:"triangle-1-w"),"</div><div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all ",a?e.slider:"","'></div><div class='right-btn pq-sb-btn ui-state-default ui-corner-right'>",m(a,a?e.right:"triangle-1-e"),"</div>"].join("")):(l.addClass("pq-sb-horiz-wt"),l.width(this.width),l[0].innerHTML=
"<div class='left-btn pq-sb-btn'></div><div class='pq-sb-slider pq-sb-slider-h'><span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span></div><div class='right-btn pq-sb-btn'></div>"));l.disableSelection().unbind(".pq-scrollbar").on("mousedown.pq-scrollbar",function(a){if(!c.disabled&&!h.$slider.is(":hidden"))if(f(document).off("."+d).on("mouseup."+d,function(n){h._mouseup(n)}),
"vertical"==b){var e=a.pageY,k=h.element.offset().top,l=k+c.length,n=h.$slider,u=n.offset().top,r=n.height(),t=u+r;e<u&&e>k+17?h.mousedownInterval=window.setInterval(function(){e>=n.offset().top?(window.clearInterval(h.mousedownInterval),h.mousedownInterval=null):h._pageUp(a)},0):e>t&&e<l-17&&(h.mousedownInterval=window.setInterval(function(){e<=n.offset().top+r?(window.clearInterval(h.mousedownInterval),h.mousedownInterval=null):h._pageDown(a)},0))}else{var s=a.pageX,k=h.element.offset().left,l=
k+c.length,u=h.$slider.offset().left,t=u+h.$slider.width();s<u&&s>k+17?(h.$slider.css("left",s-h.element.offset().left),h._updateCurPosAndTrigger(a)):s>t&&s<l-17&&(h.$slider.css("left",s-h.element.offset().left-h.$slider.width()),h._updateCurPosAndTrigger(a))}});e=this.$slider=f("div.pq-sb-slider",this.element);k&&e.attr("tabindex","0");this._bindSliderEvents(e);this.$top_btn=f("div.top-btn,div.left-btn",this.element).click(function(a){if(!h.options.disabled)return h.decr_cur_pos(a),a.preventDefault(),
!1}).mousedown(function(a){h.options.disabled||(h.mousedownTimeout=window.setTimeout(function(){h.mousedownInterval=window.setInterval(function(){h.decr_cur_pos(a)},0)},h.options.timeout))}).bind("mouseup mouseout",function(a){h._mouseup(a)});this.$bottom_btn=f("div.bottom-btn,div.right-btn",this.element).click(function(a){if(!h.options.disabled)return h.incr_cur_pos(a),a.preventDefault(),!1}).mousedown(function(a){h.options.disabled||(h.mousedownTimeout=window.setTimeout(function(){h.mousedownInterval=
window.setInterval(function(){h.incr_cur_pos(a)},0)},h.options.timeout))}).bind("mouseup mouseout",function(a){h._mouseup(a)});this.refresh()},_bindSliderEvents:function(h){var c=this,e="x";"vertical"==this.options.direction&&(e="y");h.draggable({axis:e,helper:function(a,b){c._setDragLimits();return this},start:function(a){c.topWhileDrag=null;c.dragging=!0},drag:function(a){c.dragging=!0;var b=c.options.pace;"optimum"==b?c._setNormalPace(a):"fast"==b&&c._updateCurPosAndTrigger(a)},stop:function(a){"fast"!=
c.options.pace&&c._updateCurPosAndTrigger(a);c.dragging=!1;c.refresh()}}).on("keydown.pq-scrollbar",function(a){var b=a.keyCode,d=c.options,e=d.cur_pos,l=d.ratio,g=d.num_eles,q=f.ui.keyCode;null==c.keydownTimeout&&(c.keydownTimeout=window.setTimeout(function(){b==q.DOWN||b==q.RIGHT?c.incr_cur_pos(a):b==q.UP||b==q.LEFT?c.decr_cur_pos(a):b==q.HOME?d.steps?0<e&&(d.cur_pos=0,c.updateSliderPos(),c.scroll(a)):0<l&&(d.ratio=0,c.updateSliderPos(),c.drag(a)):b==q.END?d.steps?e<g&&(d.cur_pos=g,c.updateSliderPos(),
c.scroll(a)):1>l&&(d.ratio=1,c.updateSliderPos(),c.drag(a)):"vertical"==d.direction&&(b==q.PAGE_DOWN?c._pageDown(a):b==q.PAGE_UP&&c._pageUp(a));c.keydownTimeout=null},0));if(b==q.DOWN||b==q.RIGHT||b==q.UP||b==q.LEFT||b==q.PAGE_DOWN||b==q.PAGE_UP||b==q.HOME||b==q.END)return a.preventDefault(),!1})},decr_cur_pos:function(f){var c=this.options;if(c.steps)0<c.cur_pos&&(c.cur_pos--,this.updateSliderPos(),this.scroll(f));else if(0<c.ratio){var e=c.ratio-1/(c.num_eles-1);0>e&&(e=0);c.ratio=e;this.updateSliderPos();
this.drag(f)}},incr_cur_pos:function(f){var c=this.options;if(c.steps)c.cur_pos<c.num_eles-1&&c.cur_pos++,this.updateSliderPos(),this.scroll(f);else{if(1>c.ratio){var e=c.ratio+1/(c.num_eles-1);1<e&&(e=1);c.ratio=e}this.updateSliderPos();this.drag(f)}},_mouseup:function(f){this.options.disabled||(window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),this.mousedownInterval=null)},_setDragLimits:function(){var f=this.options;if("vertical"==
f.direction){var c=this.element.offset().top+17,f=c+f.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,c,0,f])}else c=this.element.offset().left+17,f=c+f.length-34-this.slider_length,this.$slider.draggable("option","containment",[c,0,f,0])},refresh:function(){var f=this.options,c=this.element;1>=f.num_eles?c.css("display","none"):(c.css("display",""),this._validateCurPos(),this.dragging||(c["vertical"===f.direction?"height":"width"](f.length),this._setSliderBgLength(),
4>this.scroll_space||1>=f.num_eles?this.$slider.css("display","none"):this.$slider.css("display","")),this.updateSliderPos())},_setSliderBgLength:function(){var h=this.options,c=h.theme,e=this.$slider,a=h.length,a=Math.round(((a-34)*a/(40*h.num_eles+a)-14)/2);1>a&&(a=1);var b=14+2*a;this.scroll_space=h.length-34-b;if(b!==this.slider_length)if(this.slider_length=b,h="vertical"===h.direction?{dim:"height",cls:".vert-slider-bg"}:{dim:"width",cls:".horiz-slider-bg"},c)e[h.dim](b-2);else f(h.cls,this.element)[h.dim](a),
e[h.dim](b)},_updateCurPosAndTrigger:function(f,c){var e=this.options,a=e.direction,b=this.$slider;null==c&&(c=parseInt(b[0].style["vertical"===a?"top":"left"]));a=(c-17)/(e.length-34-this.slider_length);if(e.steps){if(a*=e.num_eles-1,a=Math.round(a),e.cur_pos!=a){if(this.dragging){if(null!=this.topWhileDrag&&(this.topWhileDrag<c&&e.cur_pos>a||this.topWhileDrag>c&&e.cur_pos<a))return;this.topWhileDrag=c}this.options.cur_pos=a;this.scroll(f)}}else e.ratio=a,this.drag(f)},_setNormalPace:function(f){this.timer&&
(window.clearInterval(this.timer),this.timer=null);var c=this,e=this.options.direction;c.timer=window.setInterval(function(){var a=parseInt(c.$slider[0].style["vertical"===e?"top":"left"]);c.prev_top===a&&(c._updateCurPosAndTrigger(f,a),window.clearInterval(c.timer),c.timer=null);c.prev_top=a},20)},_validateCurPos:function(){var f=this.options;f.cur_pos>=f.num_eles&&(f.cur_pos=f.num_eles-1);0>f.cur_pos&&(f.cur_pos=0)},_updateSliderPosRatio:function(){var f=this.options,c=f.direction,e=f.ratio,a=this.$slider,
f=f.length-34-this.slider_length;if(null==e)throw"updateSliderPosRatio ratio N/A";e=e*f+17;"vertical"==c?a.css("top",e):a.css("left",e)},_updateSliderPosCurPos:function(){var f=this.options,c=this.scroll_space*f.cur_pos/(f.num_eles-1);"vertical"==f.direction?this.$slider.css("top",17+c):this.$slider.css("left",17+c)},updateSliderPos:function(){var f=this.options;if(void 0===f.steps)throw"updateSliderPos. steps N/A";f.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()},scroll:function(f){var c=
this.options;this._trigger("scroll",f,{cur_pos:c.cur_pos,num_eles:c.num_eles})},drag:function(f){this._trigger("drag",f,{ratio:this.options.ratio})},_pageDown:function(f){this._trigger("pageDown",f,null)},_pageUp:function(f){this._trigger("pageUp",f,null)},_setOption:function(f,c){"disabled"==f?(this._super(f,c),!0==c?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==f?(this._super(f,c),this._createLayout()):"ratio"==f?0<=c&&1>=c&&this._super(f,c):this._super(f,c)},_setOptions:function(){this._super.apply(this,
arguments);this.refresh()}})})(jQuery);
(function(f){f.paramquery=f.paramquery||{};f.paramquery.onResize=function(m,h){var c=f(m);"static"===c.css("position")&&c.css("position","relative");var e=f('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(c);e[0].data="about:blank";e.css("opacity","0");for(var a=0;a<c.length;a++)f(e[a].contentWindow).on("resize",function(a){h()})}})(jQuery);
(function(f){function m(n){return"<span class='panel panel-default glyphicon glyphicon-"+n+"' ></span>"}function h(n){return"<span class='ui-widget-header pq-ui-button'><span class='ui-icon ui-icon-"+n+"'></span></span>"}function c(n,a,b){var d=b.attr({rowIndxPage:n,colIndx:a,attr:"rowspan"}).attr,c=b.attr({rowIndxPage:n,colIndx:a,attr:"colspan"}).attr;return 1<d||1<c?{rowspan:d,colspan:c}:(n=b.attr({rowIndxPage:n,colIndx:a,attr:"style"}).attr)&&"none"==n.display?!0:!1}function e(n){var a=n.that,
b=n.rowIndx;if(n.select&&b<=a.initV||b>a.pdata.length)return n;n=n.colIndx;var d=a.attr({rowIndx:b,colIndx:n,attr:"data-ref"}).attr;return d&&null!=d.rowIndx?e({rowIndx:d.rowIndx,colIndx:n,that:a}):{rowIndx:b,colIndx:n}}var a=function(){};a.prototype.belongs=function(n){if(n.target==this.that.element[0])return!0};f.paramquery.cClass=a;var b=function(n){this.that=n;this.options=n.options;this.offset=null};f.paramquery.cGenerateView=b;a=b.prototype;a.generateView=function(n){n=n||{};var a=this.that,
b=a.options,d=b.scrollModel.smooth,c="flex"===b.width,e="flex"===b.height,k=b.cls,l=k.cont_inner,k=k.cont_inner_b,g,q,p=a.initH,v=a.finalH,h=b.groupModel,m=a.pqpanes;if(n.$cont)g=this._generateTables(null,null,n),g=g.replace("%style%",""),h=n.$cont,h.empty(),h[0].innerHTML=m.v?["<div class='",l,"'>",g,"</div><div class='",l,"'>",g,"</div>"].join(""):["<div class='",l,"'>",g,"</div>"].join(""),b=h.children("div").children("table"),a.tables[0]={$tbl:b,$cont:h};else{g=a.initV;q=a.finalV;var G=h?a.dataGM:
a.pdata,h=a.$cont;null!=b.editModel.indices&&a.blurEditor({force:!0});p={pageData:G,initV:g,finalV:q,initH:p,finalH:v,source:n.source};a._trigger("beforeTableView",null,p);g=this._generateTables(g,q,n);h.empty();0===a.totalVisibleRows?h.append("<div class='"+l+" pq-grid-norows' >"+b.strNoRows+"</div>"):(n=e||c?"style='position:relative;'":"",c="",b.virtualY&&d&&(c="style='"+a.iMouseSelection.getBorderStyle(!0)+"'"),g=g.replace("%style%",c),h[0].innerHTML=m.h&&m.v?["<div class='",l,"'>",g,"</div><div class='",
l,"'>",g,"</div><div class='",l," ",k,"'>",g,"</div><div class='",l," ",k,"'>",g,"</div>"].join(""):m.v?["<div class='",l,"' ",n," >",g,"</div><div class='",l,"' >",g,"</div>"].join(""):m.h?["<div class='",l,"' style='position:static;' >",g,"</div><div class='",l," ",k,"' style='position:static;' >",g,"</div>"].join(""):["<div class='",l,"' ",n," >",g,"</div>"].join(""));a.$tbl=h.children("div").children("table");if(b.scrollModel.flexContent&&a.$tbl[0])f.paramquery.onResize(a.$tbl[0],function(){var n=
a.iRefresh;n.ignoreTResize||n.softRefresh()});this.setPaneEvents();a._trigger("refresh",null,p)}this.setPanes()};a.scrollView=function(){var n=this.that,a=this.options,b=a.virtualY;a.virtualX||"flex"===a.width||n.$hscroll.pqScrollBar("drag");b||n.$vscroll.pqScrollBar("drag")};a.setPaneEvents=function(){var n=this.that,a=n.pqpanes,b=n.$cont.children("div"),d=n.iMouseSelection;if((n=n.$tbl)&&n.length)if(a.h&&a.v){var a=f(b[0]),n=f(b[1]),c=f(b[2]),b=f(b[3]);a.on("scroll",function(n){this.scrollLeft=
this.scrollTop=0});n.on("scroll",function(n){this.scrollTop=0;this.scrollLeft=d.getScrollLeft(!0)});c.on("scroll",function(n){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=0});b.on("scroll",function(n){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)})}else if(a.v)a=f(b[0]),b=f(b[1]),a.on("scroll",function(n){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=0}),b.on("scroll",function(n){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)});else if(a.h)a=
f(b[0]),b=f(b[1]),a.on("scroll",function(n){this.scrollTop=0;this.scrollLeft=d.getScrollLeft(!0)}),b.on("scroll",function(n){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)});else b.on("scroll",function(n){this.scrollTop=d.getScrollTop(!0);this.scrollLeft=d.getScrollLeft(!0)})};a.setPanes=function(){var n=this.that,a=n.pqpanes,b=n.$cont.children("div"),d=n.iRefresh,c=n.$tbl,e=n.options,k=parseInt(e.freezeCols),l=n.initH,g=v.call(n,-1,k)+1,q="flex"===e.width?"":d.getEContWd();
if(n.tables.length){var p=n.tables[0].$tbl,h=n.tables[0].$cont,m=p.parent("div");a.v?(f(m[0]).css({width:g}),f(m[1]).css({left:g,width:q-g}),f(p[1]).css({left:-1*g})):f(m[0]).css({width:q});h.height(p[0].scrollHeight-1);d.setContHeight()}if(c&&c.length)if(d=d.getEContHt(),a.h&&a.v){var k=f(b[0]),l=f(b[1]),p=f(c[1]),h=f(b[2]),m=f(c[2]),b=f(b[3]),C=f(c[3]),c=n.calcHeightFrozenRows();k.css({width:g,height:c});l.css({left:g,width:q-g,height:c});p.css({left:-1*g});h.css({width:g,top:c,height:d-c});m.css({marginTop:-(c+
1)});b.css({left:g,width:q-g,top:c,height:d-c});C.css({marginTop:-(c+1),left:-1*g})}else a.v?(p=f(b[0]),b=f(b[1]),c=f(c[1]),v.call(n,k,l),p.css({width:g,height:d}),b.css({left:g,width:q-g,height:d}),c.css({left:-1*g})):a.h?(k=f(b[0]),b=f(b[1]),l=f(c[1]),c=n.calcHeightFrozenRows(),k.css({height:c,width:q}),b.css({width:q,top:c,height:d-c}),l.css({marginTop:-(c+1)})):b.css({width:q,height:d});e.showHeader&&(a.vH?(n.$header_left.css({width:g}),n.$header_right.css({left:g,width:q-g}),n.$header_right_inner.css({left:-g})):
n.$header_left.css({width:q}))};a._generateTables=function(n,a,b){b=b||{};var d=this.that,c=d.colModel,e=d.options,k=e.bootstrap,l=e.virtualX,g=d.initH,f=d.finalH,q=e.numberCell,p=e.columnBorders,v=e.rowBorders,h=e.wrap,m=e.groupModel,D=e.freezeCols,e=parseInt(e.freezeRows),H=!1,I=0,M=b.other;a=M?b.data.length-1:a;var K=m?!0:!1;b=M?b.data:K?d.dataGM:d.pdata;var N=d.rowIndxOffset;if(M||null!=n&&null!=a){H=(k.on?k.tbody:"")+" pq-grid-table ";p&&(H+="pq-td-border-right ");v&&(H+="pq-td-border-bottom ");
p=["<table %style% class='"+(h?H+"pq-wrap ":H+"pq-no-wrap ")+"' >"];p.push("<tr class='pq-row-hidden'>");q.show&&(I=q.width,p.push("<td style='width:"+I+"px;' ></td>"));for(H=0;H<=f;H++){if(H<g&&H>=D&&(l||M)&&(H=g,H>f))throw"initH>finalH";I=c[H];I.hidden||(I=I.outerWidth,p.push("<td style='width:",I,"px;' pq-col-indx='",H,"'></td>"))}p.push("</tr>");this.offsetRow=null;for(I=0;I<=a;I++)I<n&&I>=e&&(I=n),l=b[I],g=K?l.rowIndx-N:I,l&&l.pq_hidden||(H=d.lastFrozenRow===g,m&&null!=l.groupTitle?this._generateTitleRow(m,
l,p,H):m&&l.groupSummary?this._generateSummaryRow(m,l,c,p,H):(f=l.pq_detail&&l.pq_detail.show,this._generateRow(l,g,c,p,M,H,f),f&&this._generateDetailRow(l,g,c,p,M,H)));d.scrollMode=!1;p.push("</table>");return p.join("")}};a.readCell=function(n,a){var b=a.dataIndx;if(a.nested){for(var d=n,b=b.split("."),c=0,e=b.length;c<e&&(d=d[b[c]],d);c++);return d}return n[b]};a.saveCell=function(n,a,b){var d=a.dataIndx;if(a.nested){a=d.split(".");for(var d=n,c=0,e=a.length;c<e;c++){var l=a[c];c==e-1?d[l]=b:d=
n[l]=n[l]||{}}}else n[d]=b};a._renderCell=function(n,a){var b=this.options,d=n.rowData,c=n.column,e=c.type,c=this.readCell(d,c);if(d){void 0!=a?b=a:"checkBoxSelection"==e?b="<input type='checkbox' "+(c?"checked='checked'":"")+" />":"detail"==e?(b=b.detailModel,b="<div class='ui-icon "+(c&&c.show?b.expandIcon:b.collapseIcon)+"'></div>"):b=c;if(""===b||void 0==b)b="&nbsp;";return b}};a.renderCell=function(n){var a=this.that,b=this.options,d=n.rowData,c=n.rowIndx,e=n.rowIndxPage,l=n.column,k=n.colIndx,
g=l.dataIndx,f=b.freezeCols,p=b.columnBorders,v="pq-col-indx='"+k+"'",h=!1,m="pq-grid-cell ";"right"==l.align?m+=" pq-align-right":"center"==l.align&&(m+=" pq-align-center");k==f-1&&p&&(m+=" pq-last-frozen-col");(f=l.cls)&&(m=m+" "+f);(f=d.pq_cellselect)&&(h=f[g]);h&&(m+=" pq-state-select ui-state-highlight");var G;l.render&&(G=l.render.call(a.element[0],{data:a.pdata,dataModel:b.dataModel,rowData:d,cellData:d[g],rowIndxPage:e,rowIndx:c,colIndx:k,column:l,dataIndx:g}));(b=d.pq_cellcls)&&(b=b[g])&&
(m+=" "+b);if(d=d.pq_cellattr)if(g=d[g]){var a=q(g,a.initV==e),D;for(D in a)v+=" "+D+'="'+a[D]+'"'}return["<td class='",m,"' ",v," >",this._renderCell(n,G),"</td>"].join("")};a.refreshRow=function(n,a,b){var d=this.that,c=d.pdata[n];this._generateRow(c,n,a,b,null,d.lastFrozenRow===n,c.pq_detail&&c.pq_detail.show)};a._generateRow=function(n,a,b,d,c,e,l){var k="pq-grid-row";e&&(k+=" pq-last-frozen-row");l&&(k+=" pq-detail-master");var g=this.that,f=this.options,p=f.rowInit;e=f.freezeCols;var v=f.numberCell;
l=f.virtualX;var h=g.initH,m=g.finalH,G=this.offset;p&&p.call(g.element[0],{rowData:n,rowIndx:a+G});f.stripeRows&&a/2==parseInt(a/2)&&(k+=" pq-grid-oddRow");n.pq_rowselect&&(k+=" pq-row-select ui-state-highlight");g=n.pq_rowcls;null!=g&&(k+=" "+g);f=n.pq_rowattr;g="";if(f){var f=q(f),D;for(D in f)g+=" "+D+'="'+f[D]+'"'}d.push("<tr pq-row-indx='",a,"' class='",k,"' ",g," >");v.show&&d.push(["<td pq-col-indx='-1' class='pq-grid-number-cell ui-state-default'>",c?"&nbsp;":a+1,"</td>"].join(""));n={rowIndx:a+
G,rowIndxPage:a,rowData:n};for(a=0;a<=m;a++)l&&a<h&&a>=e&&(a=h),c=b[a],c.hidden||(n.column=c,n.colIndx=a,n.tree=!1,d.push(this.renderCell(n)));d.push("</tr>");return d};a={widgetEventPrefix:"pqgrid"};a.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",bootstrap:{on:!1,thead:"table table-striped table-condensed table-bordered",tbody:"table table-striped table-condensed table-bordered",grid:"panel panel-default"},distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,
_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1E3}},colModel:null,columnBorders:!0,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:f.ui.keyCode.ENTER,onSave:"next",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",
validate:!0},editor:{select:!1,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,
rowHeight:25,scrollModel:{pace:"fast",smooth:!1,horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!1},selectionModel:{fireSelectChange:!1,type:"cell",mode:"block"},swipeModel:{on:!0,speed:20,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0};a._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",
strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"};f.extend(a.options,a._regional);a._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")};a._disable=function(){null==this.$disable&&(this.$disable=f("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))};a._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),
this.$disable=null)};a._destroy=function(){this.loading&&this.xhr.abort();this._destroyResizable();this._destroyDraggable();this._mouseDestroy();this.element.off(this.eventNamespace);f(window).unbind(this.eventNamespace);f(document).unbind(this.eventNamespace);this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()};a.destroy=function(){this._trigger("destroy");this._super();window.clearInterval(this._refreshEditorPosTimer);
this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout);for(var n in this)delete this[n];f.fragments={}};a.collapse=function(n){var a=this,b=this.element,d=this.options.collapsible,c=d.$collapse.children("span"),e=function(){b.css("overflow","hidden");c.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n");b.hasClass("ui-resizable")&&b.resizable("destroy");a.$toolbar.pqToolbar("disable");d.collapsed=!0;d._collapsed=!0;d.animating=!1;a._trigger("collapse")};n=n?n:{};if(d._collapsed)return!1;
d.htCapture=b.height();!1===n.animate?(b.height(23),e()):(d.animating=!0,b.animate({height:"23px"},function(){e()}))};a.expand=function(n){var a=this,b=this.element,d=this.options.collapsible,c=d.htCapture,e=d.$collapse.children("span"),l=function(){b.css("overflow","");d._collapsed=!1;d.collapsed=!1;a._refreshResizable();d.refreshAfterExpand&&a.refresh();e.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s");a.$toolbar.pqToolbar("enable");d.animating=!1;a._trigger("expand")};
n=n?n:{};if(!1===d._collapsed)return!1;!1===n.animate?(b.height(c),l()):(d.animating=!0,b.animate({height:c},function(){l()}))};a._createCollapse=function(){var n=this,a=this.$top,b=this.options,d=b.collapsible;d.$stripe||(a=f("<div class='pq-slider-icon pq-no-capture'  ></div>").appendTo(a),d.$stripe=a);d.on?d.$collapse||(d.$collapse=f(b.bootstrap.on?m("collapse-down"):h("circle-triangle-n")).appendTo(d.$stripe).click(function(a){d.collapsed?n.expand():n.collapse()})):d.$collapse&&(d.$collapse.remove(),
delete d.$collapse);d.collapsed&&!d._collapsed?n.collapse({animate:!1}):!d.collapsed&&d._collapsed&&n.expand({animate:!1});d.toggle?d.$toggle||(d.$toggle=f(b.bootstrap.on?m("fullscreen"):h("arrow-4-diag")).prependTo(d.$stripe).click(function(a){n.toggle()})):d.$toggle&&(d.$toggle.remove(),delete d.$toggle)};a._create=function(){var n=this,a=this.options,d=a.dataModel,c=a.bootstrap,e=a.sortModel;a.collapsible||(a.collapsible={on:!1,collapsed:!1});a.flexHeight&&(a.height="flex");a.flexWidth&&(a.width=
"flex");if(d.sortIndx){e.on=a.sortable;e.type=d.sorting;var k=[],g=d.sortIndx,d=d.sortDir;if(f.isArray(g)){for(var q=0;q<g.length;q++){var v=d&&d[q]?d[q]:"up";k.push({dataIndx:g[q],dir:v})}e.single=!1}else k.push({dataIndx:g,dir:d?d:"up"}),e.single=!0;e.sorter=k}!1===a.virtualXHeader&&(a.virtualXHeader=null);this.setEditorPosTimer();this.iGenerateView=new b(this);this.iRefresh=new f.paramquery.cRefresh(this);this.iKeyNav=new p(this);this.iIsValid=new l(this);this.hidearrHS=[];this.tables=[];this.$tbl=
null;this._calcThisColModel();this.iSort=new f.paramquery.cSort(this);this.iHeader=new f.paramquery.cHeader(this);this._initTypeColumns();e=this.element;e.on("scroll"+this.eventNamespace,function(){this.scrollTop=this.scrollLeft=0});e.empty().addClass("pq-grid ui-widget ui-widget-content "+(c.on?c.grid:"")+" "+(a.roundCorners?" ui-corner-all":"")).html(["<div class='pq-grid-top ui-widget-header",a.roundCorners?" ui-corner-top":"","'><div class='pq-grid-title",a.roundCorners?" ui-corner-top":"","'>&nbsp;</div></div><div class='pq-grid-center' ><div class='pq-header-outer ui-widget-header'></div><div class='pq-grid-cont-outer' ><div class='pq-grid-cont' tabindex='0'></div></div></div><div class='pq-grid-bottom ui-widget-header",
a.roundCorners?" ui-corner-bottom":"","'><div class='pq-grid-footer'>&nbsp;</div></div>"].join(""));this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});this.$top=f("div.pq-grid-top",e);a.showTop||this.$top.css("display","none");this.$title=f("div.pq-grid-title",e);a.showTitle||this.$title.css("display","none");this.$toolbar=f("div.pq-grid-toolbar",e);c=this.$grid_center=f("div.pq-grid-center",e).on("scroll",function(){this.scrollTop=0});this.$header_o=f("div.pq-header-outer",
this.$grid_center).on("scroll",function(){this.scrollLeft=this.scrollTop=0});this.$bottom=f("div.pq-grid-bottom",e);this.$footer=f("div.pq-grid-footer",e);this.$cont_o=f(".pq-grid-cont-outer",c);e=this.$cont=f("div.pq-grid-cont",c);f(window).bind("resize"+n.eventNamespace+" orientationchange"+n.eventNamespace,function(a,b){n.onWindowResize(a,b)});e.on("click",".pq-grid-cell,.pq-grid-number-cell",function(a){if(!0!==f.data(a.target,n.widgetName+".preventClickEvent")&&f(a.target).closest(".pq-grid")[0]==
n.element[0])return n._onClickCell(a)});e.on("click","tr.pq-grid-row",function(a){if(!0!==f.data(a.target,n.widgetName+".preventClickEvent")&&f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onClickRow(a)});e.on("contextmenu","td.pq-grid-cell",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onRightClickCell(a)});e.on("contextmenu","tr.pq-grid-row",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onRightClickRow(a)});e.on("dblclick","td.pq-grid-cell",
function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onDblClickCell(a)});e.on("dblclick","tr.pq-grid-row",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onDblClickRow(a)});e.on("mousedown","td.pq-grid-cell",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onCellMouseDown(a)});e.on("mousedown","tr.pq-grid-row",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onRowMouseDown(a)});e.on("mousedown",function(a){if(f(a.target).closest(".pq-grid")[0]==
n.element[0])return n._onContMouseDown(a)});e.on("mouseenter","td.pq-grid-cell",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onCellMouseEnter(a,f(this))});e.on("mouseenter","tr.pq-grid-row",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onRowMouseEnter(a,f(this))});e.on("mouseleave","td.pq-grid-cell",function(a){if(f(a.target).closest(".pq-grid")[0]==n.element[0])return n._onCellMouseLeave(a,f(this))});e.on("mouseleave","tr.pq-grid-row",function(a){if(f(a.target).closest(".pq-grid")[0]==
n.element[0])return n._onRowMouseLeave(a,f(this))});c.bind("mousewheel DOMMouseScroll",function(a){return n._onMouseWheel(a)});this.$hvscroll=f("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(c);this.$vscroll=f("<div class='pq-vscroll'></div>").appendTo(c);this.prevVScroll=0;e=a.scrollModel;void 0===e.lastColumn&&a.virtualX&&(e.lastColumn="auto");this.$vscroll.pqScrollBar({pace:e.pace,theme:e.theme,bootstrap:a.bootstrap,steps:a.virtualY&&!e.smooth,direction:"vertical",cur_pos:0,
pageDown:function(a,b){n.iKeyNav.pageDown()},pageUp:function(a,b){n.iKeyNav.pageUp()},drag:function(a,b){n.iMouseSelection.syncViewWithScrollBarVert(b.ratio)},scroll:function(a,b){n.iRefresh.refreshVscroll(b)}});k=this.$hscroll=f("<div class='pq-hscroll'></div>").appendTo(c);"flex"===a.height&&k.css("position","relative");k.pqScrollBar({direction:"horizontal",pace:e.pace,bootstrap:a.bootstrap,theme:e.theme,steps:a.virtualX&&!e.smooth,cur_pos:0,drag:function(a,b){n.iMouseSelection.syncViewWithScrollBarHor(b.ratio)},
scroll:function(b,d){var c=!1===a.virtualXHeader?!1:!0;a.virtualX&&!a.scrollModel.smooth&&n.refresh({header:c})}});a.selectionModel["native"]||this.disableSelection();c.bind("keydown.pq-grid",function(a){f(a.target).closest(".pq-grid")[0]==n.element[0]&&n._onKeyPressDown(a)});this._refreshTitle();this.iRows=new f.paramquery.cRows(this);this.iCells=new f.paramquery.cCells(this);this.generateLoading();this._initPager();this._refreshResizable();this._refreshDraggable();this.iResizeColumns=new f.paramquery.cResizeColumns(this);
this._mouseInit()};a.toggle=function(){var a=this.options,b=a.collapsible,d=this.element,c;c=f(document.body);"fixed"==d.css("position")?(a=this.maxim.eleObj,b=this.maxim.docObj,this.option({height:a.height,width:a.width,maxHeight:a.maxHeight}),d.css({position:a.position,left:a.left,top:a.top,margin:a.margin,zIndex:a.zIndex}),c.css({height:b.height,width:b.width,overflow:b.overflow}),f("html").css({overflow:"visible"}),window.scrollTo(b.scrollLeft,b.scrollTop),c="min"):(a={height:a.height,width:a.width,
position:d.css("position"),left:d.css("left"),top:d.css("top"),margin:d.css("margin"),zIndex:d.css("zIndex"),maxHeight:a.maxHeight},this.option({height:"100%",width:"100%",maxHeight:null}),d.css(f.extend({position:"fixed",left:0,top:0,margin:0},b.css)),b={height:c.height(),width:c.width(),overflow:c.css("overflow"),scrollLeft:f(window).scrollLeft(),scrollTop:f(window).scrollTop()},f(document.body).css({height:0,width:0,overflow:"hidden"}),f("html").css({overflow:"hidden"}),window.scrollTo(0,0),this.maxim=
{eleObj:a,docObj:b},c="max");this._trigger("toggle",null,{state:c});this._refreshResizable();this.refresh();f(window).trigger("resize",{$grid:d,state:c})};a._mouseCapture=function(a){var b=this.options;return b.virtualX&&b.virtualY&&!b.scrollModel.smooth||!a.target?!1:f(a.target).closest(".pq-grid")[0]==this.element[0]?(a=b.swipeModel,!1==a.on||"touch"==a.on&&!f.support.touch?!1:!0):!1};a._saveDims=function(){var a=this.$tbl;if(a)for(var b=0;b<a.length;b++){var d=a[b],c=f(d);c.data("offsetHeight",
Math.round(d.offsetHeight)-1);c.data("scrollWidth",Math.round(d.scrollWidth))}if(a=this.$tbl_header)for(b=0;b<a.length;b++)d=a[b],c=f(d).parent(),c.data("offsetHeight",Math.round(d.offsetHeight)),c.data("scrollWidth",Math.round(d.scrollWidth))};a._mousePQUp=function(a){f(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate);this._trigger("mousePQUp",a,null)};a._mouseDown=function(a){var b=this;if(f(a.target).closest(".pq-editor-focus").length)this._blurEditMode=!0,window.setTimeout(function(){b._blurEditMode=
!1},0);else return this._saveDims(),this._mousePQUpDelegate=function(a){return b._mousePQUp(a)},f(document).bind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._super(a)};a._mouseStart=function(a){this.blurEditor({force:!0});return!0};a._mouseDrag=function(a){return!1==this._trigger("mouseDrag",a,null)?!1:!0};a._mouseStop=function(a){return!1==this._trigger("mouseStop",a,null)?!1:!0};var d,k;a.onWindowResize=function(a,b){var c=this.options,e=this.element,l=e.parent();if(b){var g=b.$grid;
if(g&&(g==e||0==e.closest(g).length))return}if(l.length&&(l[0]==document.body||"fixed"==e.css("position")?(e=window.innerHeight?window.innerHeight:f(window).height(),l=f(window).width()):(e=l.height(),l=l.width()),null==d||e!=d||l!=k)&&(d=e,k=l,!(f.support.touch&&c.editModel.indices&&f(document.activeElement).is(".pq-editor-focus")))){var q=this,c=c.autoSizeInterval,c=void 0===c?0:c;this.autoResizeTimeout&&(clearTimeout(this.autoResizeTimeout),delete this.autoResizeTimeout);this.autoResizeTimeout=
window.setTimeout(function(){q._refreshAfterResize();delete q.autoResizeTimeout},c)}};a._onMouseWheel=function(a){this._saveDims();var b=this.options,d=0,c=!1;a=a.originalEvent;var e=a.wheelDeltaX,l=a.wheelDeltaY,k=a.wheelDelta;if(e&&Math.abs(e)>Math.abs(l)){if("flex"==b.width)return!0;c=!0;d=e/120}else if(k){if(!this.iRefresh.vscroll)return!0;d=k/120}else if(a.detail){if(!this.iRefresh.vscroll)return!0;d=-1*a.detail/3}a=c?this.$hscroll:this.$vscroll;k=a.pqScrollBar("option");l=parseInt(k.cur_pos);
e=parseInt(k.num_eles);if(!b.scrollModel.smooth&&(c&&b.virtualX||!c&&b.virtualY)){d=0<d?Math[1>d?"ceil":"floor"](d):Math[-1>d?"ceil":"floor"](d);b=l-d;0>b?b=0:b>e-1&&(b=e-1);if(b==l)return!0;a.pqScrollBar("option","cur_pos",l-d);a.pqScrollBar("scroll")}else{b=k.ratio;d=b-d/(e-1);1<d?d=1:0>d&&(d=0);if(b==d)return!0;a.pqScrollBar("option","ratio",d);a.pqScrollBar("drag")}return!1};a._onDblClickCell=function(a){var b=f(a.currentTarget),d=this.getCellIndices({$td:b}),c=d.rowIndxPage,e=c+this.rowIndxOffset,
d=d.colIndx;if(null!=d){if(!1==this._trigger("cellDblClick",a,{$td:b,rowIndxPage:c,rowIndx:e,colIndx:d,column:this.colModel[d],rowData:this.pdata[c]}))return!1;1<this.options.editModel.clicksToEdit&&this.isEditableRow({rowIndx:e})&&this.isEditableCell({colIndx:d,rowIndx:e})&&this.editCell({rowIndxPage:c,colIndx:d})}};a._onClickCont=function(a){};a._onClickRow=function(a){var b=f(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),c=d+this.rowIndxOffset;if(!isNaN(d)&&!1==this._trigger("rowClick",a,
{$tr:b,rowIndxPage:d,rowIndx:c,rowData:this.pdata[d]}))return!1};a._onRightClickRow=function(a){var b=f(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),c=d+this.rowIndxOffset;if(!isNaN(d)&&!1==this._trigger("rowRightClick",a,{$tr:b,rowIndxPage:d,rowIndx:c,rowData:this.pdata[d]}))return!1};a._onDblClickRow=function(a){var b=f(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),c=this.getRowIndxOffset();if(!1==this._trigger("rowDblClick",a,{$tr:b,rowIndxPage:d,rowIndx:d+c,rowData:this.pdata[d]}))return!1};
f.paramquery.getValueFromDataType=function(a,b,d){if("date"==b)return b=Date.parse(a),isNaN(b)?"":d?b:a;if("integer"==b)b=parseInt(a);else if("float"==b)b=parseFloat(a);else return"bool"==b?(b=f.trim(a).toLowerCase(),0==b.length?null:"true"==b||"yes"==b||"1"==b?!0:"false"==b||"no"==b||"0"==b?!1:Boolean(b)):f.trim(a);return isNaN(b)||null==b?null==a?a:null:b};var l=function(a){this.that=a},g=l.prototype;g._isValidCell=function(a){var b=this.that,d=a.column,c=d.validations;if(!c||!c.length)return{valid:!0};
var e=a.value,l=d.dataType,k=function(a){return f.paramquery.getValueFromDataType(a,l,!0)};a=a.rowData;if(!a)throw"rowData required.";for(var g=0;g<c.length;g++){var q=c[g],p=q.type,v=!1,h=q.msg,m=q.value;if(!1!==q.on&&(null==e&&"function"!=typeof p?v=!1:"minLen"==p?(e=k(e),m=k(m),e.length>=m&&(v=!0)):"nonEmpty"==p?null!=e&&""!==e&&(v=!0):"maxLen"==p?(e=k(e),m=k(m),e.length<=m&&(v=!0)):"gt"==p?(e=k(e),m=k(m),e>m&&(v=!0)):"gte"==p?(e=k(e),m=k(m),e>=m&&(v=!0)):"lt"==p?(e=k(e),m=k(m),e<m&&(v=!0)):"lte"==
p?(e=k(e),m=k(m),e<=m&&(v=!0)):"neq"==p?(e=k(e),m=k(m),e!==m&&(v=!0)):"regexp"==p?(new RegExp(m)).test(e)&&(v=!0):"function"==typeof p?(m={column:d,value:e,rowData:a,msg:h},!1==p.call(b.element[0],m)?(v=!1,m.msg!=h&&(h=m.msg)):v=!0):v=!0,!v))return{valid:!1,msg:h,column:d,warn:q.warn,dataIndx:d.dataIndx,validation:q}}return{valid:!0}};g.isValidCell=function(a){var b=this.that,d=a.rowData,c=a.rowIndx,e=a.value,l=a.valueDef,k=a.column,g=b.options,q=a.allowInvalid,p=k.dataIndx,v=g.validation,m=g.warning,
h=g.editModel,C=h.invalidClass,h=h.warnClass,G=document.activeElement;if(a.checkEditable&&!1==b.isEditableCell({rowData:d,rowIndx:c,dataIndx:p}))return{valid:!0};a=this._isValidCell({column:k,value:e,rowData:d});var e=a.valid,k=a.warn,D=a.msg;if(e)b.data({rowData:d,dataIndx:p,data:"pq_valid"})&&(b.removeClass({rowData:d,rowIndx:c,dataIndx:p,cls:h+" "+C}),b.removeData({rowData:d,dataIndx:p,data:"pq_valid"}));else var v=f.extend({},k?m:v,a.validation),H=v.css,I=v.cls,M=v.icon,K=v.style;if(q||k){if(e)return{valid:!0};
b.addClass({rowData:d,rowIndx:c,dataIndx:p,cls:k?h:C});b.data({rowData:d,dataIndx:p,data:{pq_valid:{css:H,icon:M,style:K,msg:D,cls:I}}});return a}if(!e){c=null==c?b.getRowIndx({rowData:d}).rowIndx:c;if(null==c)return a;if(!l)b.goToPage({rowIndx:c}),b.editCell({rowIndx:c,dataIndx:p});else if(f(G).hasClass("pq-editor-focus")&&(l=g.editModel.indices)){d=l.rowIndx;l=l.dataIndx;if(null!=c&&c!=d)throw"incorrect usage of isValid rowIndx: "+c;if(p!=l)throw"incorrect usage of isValid dataIndx: "+p;b.editCell({rowIndx:d,
dataIndx:p})}if((b=b.getEditCell())&&b.$cell){var N=b.$cell;N.attr("title",D);try{N.tooltip("destroy")}catch(Q){}N.tooltip({position:{my:"left center+5",at:"right center"},content:function(){return(""==M?"":"<span class='ui-icon "+M+" pq-tooltip-icon'></span>")+D},open:function(a,b){I&&b.tooltip.addClass(I);if(K){var n=b.tooltip.attr("style");b.tooltip.attr("style",n+";"+K).css("zIndex",N.zIndex()+5)}H&&b.tooltip.css(H)}}).tooltip("open")}return a}if(l&&(b=b.getEditCell())&&b.$cell){N=b.$cell;N.removeAttr("title");
try{N.tooltip("destroy")}catch(U){}}return{valid:!0}};a.isValid=function(a){return this.iIsValid.isValid(a)};g.isValid=function(a){var b=this.that;a=a||{};var d=a.allowInvalid,c=a.checkEditable,d=null==d?!1:d,e=a.dataIndx;if(null!=e){var l=b.columns[e],k=a.rowData||b.getRowData(a),g=a.hasOwnProperty("value"),b=g?a.value:k[e],b=this.isValidCell({rowData:k,checkEditable:c,rowIndx:a.rowIndx,value:b,valueDef:g,column:l,allowInvalid:d});return b.valid||b.warn?{valid:!0}:b}if(null!=a.rowIndx||null!=a.rowIndxPage||
null!=a.rowData)for(var k=a.rowData||b.getRowData(a),f=b.colModel,g=[],q=0,p=f.length;q<p;q++){if(l=f[q],!l.hidden&&(e=l.dataIndx,b=k[e],b=this.isValidCell({rowData:k,value:b,column:l,rowIndx:a.rowIndx,checkEditable:c,allowInvalid:d}),!b.valid&&!b.warn))if(d)g.push({rowData:k,dataIndx:e,column:l});else return b}else{a=a.data?a.data:b.options.dataModel.data;g=[];if(!a)return null;q=0;for(p=a.length;q<p;q++){k=a[q];if(c&&(l=this.getRowIndx({rowData:k}).rowIndx,!1==b.isEditableRow({rowData:k,rowIndx:l})))continue;
k=this.isValid({rowData:k,rowIndx:l,checkEditable:c,allowInvalid:d});if(!1===d){if(!k.valid)return k}else g=g.concat(k.cells)}}return d&&g.length?{cells:g,valid:!1}:{valid:!0}};a.isEditableRow=function(a){var b=this.options.editable;if(null!=b){if("function"==typeof b){var d=a.rowIndx;a=a.rowData||this.getRowData({rowIndx:d});return b.call(this.element[0],{rowData:a,rowIndx:d})}return b}return!0};a.isEditableCell=function(a){var b=a.colIndx,d=a.dataIndx,b=null==b?this.getColIndx({dataIndx:d}):b,b=
this.colModel[b],d=null==d?b.dataIndx:d,c=b.editable;if(a.checkVisible&&b.hidden)return!1;if(null!=c){if("function"==typeof c){var e=a.rowIndx;a=a.rowData||this.getRowData(a);return c.call(this.element[0],{rowIndx:e,rowData:a,column:b,dataIndx:d})}return c}return!0};a._getRowPQData=function(a,b,d){return(d=null==d?this.pdata[a]:d)?d[b]:null};a._setRowPQData=function(a,b,d){if(d=null==d?this.pdata[a]:d)for(var c in b)d[c]=b[c]};a._onContMouseDown=function(a){this.blurEditor({blurIfFocus:!0});if(!1===
this._trigger("contMouseDown",a,{dataModel:this.options.dataModel}))return!1;var b=f(a.target);a=b.closest(".pq-grid-cell");b=b.closest(".pq-grid-row");a.length||b.length||this.$cont.attr("tabindex",0).focus();return!0};a._onCellMouseDown=function(a){var b=f(a.currentTarget),d=this.getCellIndices({$td:b});d.$td=b;d.dataModel=this.options.dataModel;return!1==this._trigger("cellMouseDown",a,d)?!1:!0};a._onRowMouseDown=function(a){var b=f(a.currentTarget),d=this.getRowIndx({$tr:b});d.$tr=b;d.dataModel=
this.options.dataModel;return!1==this._trigger("rowMouseDown",a,d)?!1:!0};a._onCellMouseEnter=function(a,b){var d=this.options,c=this.getCellIndices({$td:b});if(null!=c.rowIndx&&null!=c.colIndx){if(!1===this._trigger("cellMouseEnter",a,c))return!1;"cell"==d.hoverMode&&this.highlightCell(b);return!0}};a._onRowMouseEnter=function(a,b){var d=this.options,c=this.getRowIndx({$tr:b}),e=c.rowIndxPage;if(!1===this._trigger("rowMouseEnter",a,c))return!1;"row"==d.hoverMode&&this.highlightRow(e);return!0};a._onCellMouseLeave=
function(a,b){"cell"==this.options.hoverMode&&this.unHighlightCell(b);return!0};a._onRowMouseLeave=function(a,b){var d=this.getRowIndx({$tr:b}).rowIndxPage;"row"==this.options.hoverMode&&this.unHighlightRow(d);return!0};a.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)};a.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(a){if(a.target){var b=f(a.target);if(b.is("input,textarea,select")||
b.closest(".pq-native-select").length)return!0;a.preventDefault()}})};a._onClickCell=function(a){var b=this.colModel,d=this.options.editModel,c=f(a.currentTarget),e=this.getCellIndices({$td:c}),k=e.rowIndxPage,l=k+this.rowIndxOffset,g,q,p=e.colIndx;e.rowIndx=l;null!=p&&(0<=p&&(g=b[p],q=g.dataIndx,e.dataIndx=q),e.evt=a);if(!1==this._trigger("cellClick",a,{$td:c,rowIndxPage:k,rowIndx:l,colIndx:p,dataIndx:q,column:g,rowData:this.pdata[k]}))return!1;null==p||0>p||1==d.clicksToEdit&&this.isEditableRow({rowIndx:l})&&
this.isEditableCell({colIndx:p,rowIndx:l})&&this.editCell(e)};a._onRightClickCell=function(a){var b=f(a.currentTarget),d=this.getCellIndices({$td:b}),c=d.rowIndxPage,e=c+this.rowIndxOffset,d=d.colIndx,k=this.colModel;if(null!=d&&(k=k[d],!1==this._trigger("cellRightClick",a,{$td:b,rowIndxPage:c,rowIndx:e,colIndx:d,dataIndx:k.dataIndx,column:k,rowData:this.pdata[c]})))return!1};a.highlightCell=function(a){a.addClass("pq-grid-cell-hover ui-state-hover")};a.unHighlightCell=function(a){a.removeClass("pq-grid-cell-hover ui-state-hover")};
a.highlightRow=function(a){isNaN(a)||(a=this.getRow({rowIndxPage:a}))&&a.addClass("pq-grid-row-hover ui-state-hover")};a.unHighlightRow=function(a){isNaN(a)||(a=this.getRow({rowIndxPage:a}))&&a.removeClass("pq-grid-row-hover ui-state-hover")};a._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}};a._findCellFromEvt=function(a){a=f(a.target).closest(".pq-grid-cell");if(null==a||0==a.length)return{rowIndxPage:null,colIndx:null,$td:null};
var b=this.getCellIndices({$td:a});b.$td=a;return b};a._initPager=function(){var a=this,b=a.options,d={bootstrap:b.bootstrap,change:function(b,d){a.blurEditor({force:!0});var c=a.options.pageModel;void 0!=d.curPage&&(c.prevPage=c.curPage,c.curPage=d.curPage);void 0!=d.rPP&&(c.rPP=d.rPP);"remote"==c.type?a.remoteRequest({callback:function(){a._delegatePageChangeEvent({type:"remote"});a._onDataAvailable({apply:!0,header:!1})}}):(a._delegatePageChangeEvent({type:"local"}),a.refreshView({header:!1}))},
refresh:function(b){a.refreshDataAndView()}},b=b.pageModel;b.type&&(this.$pager=b.appendTo?b.appendTo.pqPager(d):this.$footer.pqPager(d))};a._triggerPageChangeEvent=function(a){var b=this._pageChangeEvent;b&&(this._trigger("pageChange",a,b),delete this._pageChangeEvent)};a._delegatePageChangeEvent=function(a){this._pageChangeEvent=a};a.generateLoading=function(){this.$loading&&this.$loading.remove();this.$loading=f("<div class='pq-loading'></div>").appendTo(this.element);f(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",
this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading);this.$loading.find("div.pq-loading-bg").css("opacity",.2)};a._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)};a.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0);this.showLoadingCounter++;this.$loading.show()};a.hideLoading=function(){0<this.showLoadingCounter&&this.showLoadingCounter--;this.showLoadingCounter||this.$loading.hide()};
a.refreshDataFromDataModel=function(){var a=this._queueATriggers,b;for(b in a){var d=a[b];this._trigger(b,d.evt,d.ui)}this._queueATriggers={};this._trigger("beforeRefreshData",null,{});var c=this.options,a=c.pageModel,d=c.dataModel.data,e=a.type;this.rowIndxOffset=0;if(null==d||0==d.length)e&&(a.curPage=0,a.totalPages=0,a.totalRecords=0),this.pdata=d;else{if(e&&"local"==e){a.totalRecords=d.length;a.totalPages=Math.ceil(d.length/a.rPP);a.curPage>a.totalPages&&(a.curPage=a.totalPages);1>a.curPage&&
0<a.totalPages&&(a.curPage=1);var c=(a.curPage-1)*a.rPP,k=a.curPage*a.rPP;k>d.length&&(k=d.length);this.pdata=d.slice(c,k)}else"remote"==e?(c=Math.ceil(a.totalRecords/a.rPP),(a.totalPages=c)&&!a.curPage&&(a.curPage=1),k=a.rPP,k>d.length&&(k=d.length),this.pdata=d.slice(0,k)):this.pdata=c.backwardCompat?d.slice(0):d;if("local"==e||"remote"==e)this.rowIndxOffset=a.rPP*(a.curPage-1);a=this._queueBTriggers;for(b in a)d=a[b],this._trigger(b,d.evt,d.ui);this._queueBTriggers={};this._trigger("dataReady",
null,{})}};a.getQueryStringCRUD=function(){return""};a.remoteRequest=function(a){this.loading&&this.xhr.abort();a=a||{};var b=this,d="",c="",e=this.options,k=!1,l=this.colModel,g=e.dataModel,q=e.sortModel,p=e.filterModel,v=e.pageModel;if("function"==typeof g.getUrl)(e=g.getUrl.call(this.element[0],{colModel:l,dataModel:g,sortModel:q,groupModel:e.groupModel,pageModel:v,filterModel:p}))&&e.url&&(d=e.url),e&&e.data&&(c=e.data);else if("string"==typeof g.url){var d=g.url,c={},e={},m={};"remote"==q.type&&
(a.initBySort||this.sort({initByRemote:!0}),(q=this.iSort.getQueryStringSort())&&(c={pq_sort:q}));"remote"==v.type&&(m={pq_curpage:v.curPage,pq_rpp:v.rPP});"local"!=p.type&&(q=this.iFilterData.getQueryStringFilter())&&(k=!0,e={pq_filter:q});var q=g.postData,h=g.postDataOnce;q&&"function"==typeof q&&(q=q.call(this.element[0],{colModel:l,dataModel:g}));c=f.extend({pq_datatype:g.dataType},e,m,c,q,h)}d&&(this.loading=!0,this.showLoading(),this.xhr=f.ajax({url:d,dataType:g.dataType,async:null==g.async?
!0:g.async,cache:g.cache,contentType:g.contentType,type:g.method,data:c,beforeSend:function(a,d){if("function"==typeof g.beforeSend)return g.beforeSend.call(b.element[0],a,d)},success:function(d,c,e){"function"==typeof g.getData&&(d=g.getData.call(b.element[0],d,c,e));g.data=d.data;v.type&&"remote"==v.type&&(d.curPage&&(v.curPage=d.curPage),d.totalRecords&&(v.totalRecords=d.totalRecords));b.hideLoading();b.loading=!1;b._queueBTriggers.load={ui:{dataModel:g,colModel:l}};a.callback&&a.callback();k&&
(b._queueATriggers.filter={ui:{type:"remote",filterModel:p}})},error:function(a,d,n){b.hideLoading();b.loading=!1;if("function"==typeof g.error)g.error.call(b.element[0],a,d,n);else if("abort"!=n)throw"Error : "+n;}}))};a._refreshTitle=function(){this.$title.html(this.options.title)};a._destroyDraggable=function(){var a=this.element,b=a.parent(".pq-wrapper");b.length&&b.data("draggable")&&(b.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),a.unwrap(".pq-wrapper"))};a._refreshDraggable=
function(){var a=this.element,b=this.$title;this.options.draggable?(b.addClass("pq-draggable pq-no-capture"),a.parent(".pq-wrapper").length||a.wrap("<div class='pq-wrapper' />"),a.parent(".pq-wrapper").draggable({handle:b})):this._destroyDraggable()};a._refreshResizable=function(){var a=this,b=this.element,d=this.options,c=-1<(d.width+"").indexOf("%"),e=-1<(d.height+"").indexOf("%"),k="auto"==d.width,l="flex"==d.width,g="flex"==d.height;if(!d.resizable||(g||e)&&(l||c||k))this._destroyResizable();
else{var q="e,s,se";if(g||e)q="e";else if(l||c||k)q="s";c=!0;b.hasClass("ui-resizable")&&(e=b.resizable("option","handles"),q==e?c=!1:this._destroyResizable());c&&b.resizable({helper:"ui-state-default",handles:q,minWidth:d.minWidth,minHeight:d.minHeight?d.minHeight:100,delay:0,start:function(a,b){f(b.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(a,b){},stop:function(b,c){var e=a.element,u=d.width,k=d.height,l=-1<(u+"").indexOf("%"),g=-1<(k+"").indexOf("%"),
t="auto"==u,u="flex"==u,s=!1;g||"flex"==k||(s=!0,d.height=e.height());l||t||u||(s=!0,d.width=e.width());a.refresh();e.css("position","relative");s&&f(window).trigger("resize")}})}};a._refreshAfterResize=function(){var a=this.options,b=a.width,d=a.height,a=-1!=(b+"").indexOf("%")?!0:!1,b="auto"===b,d=-1!=(d+"").indexOf("%")?!0:!1;(a||b||d)&&this.refresh()};a.refresh=function(a){this.iRefresh.refresh(a)};a._refreshDataIndices=function(){for(var a="JSON"==this.getDataType()?!0:!1,b={},d={},c={},e=this.colModel,
k=e.length,l=0;l<k;l++){var g=e[l],f=g.dataIndx;null==f&&(f=a?"dataIndx_"+l:l,g.dataIndx=f);b[f]=g;d[f]=l;g.validations&&(c[f]=c)}this.columns=b;this.colIndxs=d;this.validations=c};a.refreshView=function(a){null!=this.options.editModel.indices&&this.blurEditor({force:!0});this.refreshDataFromDataModel();this.refresh(a)};a._refreshPager=function(){var a=this.options,b=a.pageModel,d=b.rPP,c=b.totalRecords;b.type?(b=a.pageModel,this.$pager||this._initPager(),this.$pager.pqPager("option",b),c>d?this.$bottom.css("display",
""):a.showBottom||this.$bottom.css("display","none")):(this.$pager&&(this.$pager.pqPager("destroy"),this.$pager=null),a.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none"))};a.getInstance=function(){return{grid:this}};a._addRowsData=function(a){var b=a.data,d=this.options.dataModel.data;a=a.rowIndx;null==d&&(d=[]);if(null==a)for(var c=0,e=b.length;c<e;c++){var k=b[c];d.push(k)}else if(a<d.length)for(c=0,e=b.length;c<e;c++)k=b[c],d.splice(a,0,k),a++;else return!1;return!0};
a.addRows=function(a){return this._addRowsData(a)?(this.refreshDataFromDataModel(),this.refresh(),!0):!1};a.refreshDataAndView=function(a){if("remote"==this.options.dataModel.location){var b=this;this.remoteRequest({callback:function(){b._onDataAvailable(a)}})}else this._onDataAvailable(a)};a.getColIndx=function(a){var b=a.dataIndx;a=a.column;var d;if(a)d=!0;else if(void 0===b)throw"dataIndx / column NA";var c=this.colModel,e=c.length;if(d)for(d=0;d<e;d++){if(c[d]==a)return d}else for(d=0;d<e;d++)if(c[d].dataIndx==
b)return d;return-1};a.getColumn=function(a){if(null==a.dataIndx)throw"dataIndx N/A";return this.columns[a.dataIndx]};a._setOption=function(a,b){var d=this.options,c=d.dataModel;if("height"===a)"flex"===b?(c=this.$vscroll,b&&c&&c.hasClass("pq-sb-vert")&&(d.virtualY?c.pqScrollBar("option","cur_pos",0):c.pqScrollBar("option","ratio",0)),this.$hscroll.css("position","relative")):"flex"===d.height&&this.$hscroll.css("position",""),this._super(a,b);else if("width"===a&&"flex"==b)this._super(a,b),c=this.$hscroll,
b&&c&&c.hasClass("pq-sb-horiz")&&(d.virtualX?c.pqScrollBar("option","cur_pos",0):c.pqScrollBar("option","ratio",0));else if("title"==a)this._super(a,b),this._refreshTitle();else if("roundCorners"==a)this._super(a,b),b?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"));else if("freezeCols"==a)b=parseInt(b),
!isNaN(b)&&0<=b&&b<=this.colModel.length-2&&this._super(a,b);else if("freezeRows"==a)b=parseInt(b),!isNaN(b)&&0<=b&&this._super(a,b);else if("resizable"==a)this._super(a,b),this._refreshResizable();else if("draggable"==a)this._super(a,b),this._refreshDraggable();else if("scrollModel"==a)this._super(a,b);else if("dataModel"==a)b.data!==c.data&&c.dataUF&&c.dataUF.length&&(c.dataUF.length=0),this._super(a,b);else if("groupModel"==a){if(null==b)for(var d=c.data,c=0,e=d.length;c<e;c++)d[c].pq_hidden=!1;
this._super(a,b)}else"pageModel"==a?this._super(a,b):"selectionModel"===a?this._super(a,b):"colModel"===a||"columnTemplate"==a?(this._super(a,b),this._calcThisColModel()):"disabled"===a?(this._super(a,b),!0===b?this._disable():this._enable()):"numberCell"===a?(this._super(a,b),this.iRefresh.decidePanes()):"strLoading"===a?(this._super(a,b),this._refreshLoadingString()):"showTop"===a?(this._super(a,b),!0===b?this.$top.css("display",""):this.$top.css("display","none")):"showTitle"===a?(this._super(a,
b),!0===b?this.$title.css("display",""):this.$title.css("display","none")):"showToolbar"===a?(this._super(a,b),!0===b?this.$toolbar.css("display",""):this.$toolbar.css("display","none")):"toolbar"==a?(this._super(a,b),this.$toolbar.remove(),this._super(a,b),this._createToolbar()):"collapsible"===a?(this._super(a,b),this._createCollapse()):"showBottom"===a?(this._super(a,b),!0===b?this.$bottom.css("display",""):this.$bottom.css("display","none")):this._super(a,b)};a._generateCellRowOutline=function(){var a=
this.options,b=a.editModel;if(this.$div_focus){if(a.debug)throw"this.$div_focus already present assert failed";}else a=this.element,b.inline&&(a=this.getCell(b.indices),a.css("padding",0).empty()),this.$div_focus=f("<div class='pq-editor-outer'><div class='pq-editor-inner'></div></div>").appendTo(a),this.$div_focus.css("zIndex",a.zIndex()+5),b=f.extend({all:!0},b.indices),b=this.getCell(b),b.css("height",b.height()),b.empty(),this.refreshEditorPos()};a._removeCellRowOutline=function(a){if(this.$div_focus){a=
this.$div_focus.find(".pq-editor-focus");a.hasClass("hasDatepicker")&&a.datepicker("hide").datepicker("destroy");if(a[0]==document.activeElement){var b=this._blurEditMode;this._blurEditMode=!0;a.blur();this._blurEditMode=b}this.$div_focus.remove();delete this.$div_focus;a=this.options.editModel;b=f.extend({},a.indices);a.indices=null;this.refreshCell(b)}};a.refreshEditorPos=function(){var a=this.options.editModel,b=a.cellBorderWidth,d=this.$div_focus,c=this.getCell(a.indices);if(!c||!c.length)return!1;
var a=c[0].offsetWidth,e=c[0].offsetHeight,k=this.element.offset(),c=c.offset();d.css({height:e,width:a,borderWidth:b,left:c.left-k.left,top:c.top-k.top-1})};a.setEditorPosTimer=function(){var a=this,b=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null);this._refreshEditorPosTimer=window.setInterval(function(){b.editModel.indices&&a.refreshEditorPos()},200)};a._findfirstUnhiddenColIndx=function(){for(var a=0;a<this.colModel.length;a++)if(!this.colModel[a].hidden)return a};
a.selectRow=function(a){var b=a.evt;if(b&&("keydown"==b.type||"keypress"==b.type)){if(!1==this.iRows.replace(a))return!1}else if(!1==this.iRows.add(a))return!1;return!0};a.get$Tbl=function(a,b){var d=this.$tbl,c=[];if(d&&d.length){var e=this.pqpanes,k=this.options,l=k.freezeRows,k=k.freezeCols;e.h&&e.v?null==b?a>=l?c.push(d[2],d[3]):c.push(d[0],d[1]):c=b>=k&&a>=l?d[3]:b<k&&a>=l?d[2]:b>=k&&a<l?d[1]:d[0]:c=e.v?null==b?d:b>=k?d[1]:d[0]:e.h?a>=l?d[1]:d[0]:d[0];if(c)return f(c)}};a.scrollCell=function(a){this.scrollRow(a);
this.scrollColumn(a)};a.scrollY=function(a){this.$vscroll.pqScrollBar("option","cur_pos",a).pqScrollBar("scroll")};a.scrollRow=function(a){if(!this.pdata||a.rowIndxPage>=this.pdata.length)return!1;this.options.virtualY?this._scrollRowVirtual(a):this.iMouseSelection.scrollRowNonVirtual(a)};a._scrollRowVirtual=function(a){var b=this.options,d=a.rowIndxPage,c=this.iHierarchy?!0:!1,e=a.rowIndx;a=this.$vscroll;var k=this.scrollCurPos,d=null==d?e-this.rowIndxOffset:d,l=parseInt(b.freezeRows);if(!(d<l)&&
(e=this._calcCurPosFromRowIndxPage(d),null!=e)){e<k&&a.pqScrollBar("option","cur_pos",e).pqScrollBar("scroll");var g=this.get$Tbl(d);if(!g||!g.length)return null;var f=g.children("tbody").children("tr[pq-row-indx="+d+"]"),q=d=f.last();1<f.length&&(q=f.first());var p=d[0],f=parseInt(g.css("marginTop"));if(void 0==p)b.scrollModel.smooth?a.pqScrollBar("option","ratio",e/this.totalVisibleRows).pqScrollBar("drag"):a.pqScrollBar("option","cur_pos",e).pqScrollBar("scroll");else{var b=p.offsetTop+p.offsetHeight,
p=this.$cont[0].offsetHeight,v=this._getSBHeight(),q=q.prev("tr");if(!q.hasClass("pq-row-hidden")&&!q.hasClass("pq-last-frozen-row")&&b>p-v-f){b-=p-v-f;f=g.children().children("tr");q=g=0;l?(l=f.filter("tr.pq-last-frozen-row").last().next(),0==l.length&&(l=f.filter("tr.pq-row-hidden").next())):l=f.filter("tr.pq-row-hidden").next();do{if(!l.length)break;g+=l[0].offsetHeight;if(l[0]==d[0])break;else if(c&&!1!=l.hasClass("pq-detail-child")||q++,g>=b)break;l=l.next()}while(1);c=k+q;c>e&&(c=e);k=a.pqScrollBar("option",
"num_eles");k<c+1&&(k=c+1);a.pqScrollBar("option",{num_eles:k,cur_pos:c}).pqScrollBar("scroll")}}}};a.blurEditor=function(a){if(this.$div_focus){var b=this.$div_focus.find(".pq-editor-focus");if(a&&a.blurIfFocus)document.activeElement==b[0]&&b.blur();else return b.triggerHandler("blur",a)}};a._scrollColumnVirtual=function(a){var b=a.colIndx,b=null==b?this.getColIndx({dataIndx:a.dataIndx}):b;a=this.options.freezeCols;var d=this._calcRightEdgeCol(b).width,c=this._getSBWidth(),c=this.$cont[0].offsetWidth-
c;if(d>c){for(var d=v.call(this,-1,b+1)-c,c=this.colModel,e=c.length,k=0,l=0,g=a;g<e;g++){var f=c[g];f.hidden||(k+=f.outerWidth);if(g==b){l=g-a-this._calcNumHiddenUnFrozens(g);break}else if(k>=d){l=g-a-this._calcNumHiddenUnFrozens(g)+1;break}}this.$hscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");return!0}return this.hidearrHS[b]?(this.hidearrHS[b]=!1,b=b-a-this._calcNumHiddenUnFrozens(b),this.$hscroll.pqScrollBar("option","cur_pos",b).pqScrollBar("scroll"),!0):!1};a.scrollColumn=function(a){var b=
this.options;return"flex"===b.width?!1:b.virtualX?this._scrollColumnVirtual(a):this.iMouseSelection.scrollColumnNonVirtual(a)};a.selection=function(a){var b=a.method,d=a.type;if("row"==d)return this.iRows[b](a);if("cell"==d)return this.iCells[b](a)};a.goToPage=function(a){var b=this.options.pageModel;if("local"==b.type||"remote"==b.type){var d=a.rowIndx,c=b.rPP;a=null==a.page?Math.ceil((d+1)/c):a.page;a!=b.curPage&&(b.curPage=a,"local"==b.type?(this.refreshDataFromDataModel(),this.refresh()):this.refreshDataAndView())}};
a.setSelection=function(a){if(null==a)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;var b=this.pdata,d,c;if(a.rowData)c=this.getRowIndx(a),d=c.rowIndx;else{var k=this.rowIndxOffset;d=a.rowIndx;c=a.rowIndxPage;d=null==d?c+k:d}k=null==a.colIndx&&void 0!==a.dataIndx?this.getColIndx({dataIndx:a.dataIndx}):a.colIndx;if(0>d||0>k||k>=this.colModel.length||null==b||0==b.length)return!1;a.rowIndx=d;a.colIndx=k;this.goToPage(a);c=d-this.rowIndxOffset;a.rowIndxPage=c;
null!=k&&(b=(b=this.attr({rowIndx:d,colIndx:k,attr:"style"}).attr)&&"none"==b.display?!0:!1,b?(c=e({rowIndx:d,colIndx:k,that:this,select:!0}),this.data({rowIndx:c.rowIndx,colIndx:c.colIndx,data:{pq_merge_nav:{rowIndx:d,colIndx:k}}}),a.rowIndx=c.rowIndx,a.colIndx=c.colIndx,a.rowIndxPage=c.rowIndx-this.rowIndxOffset):this.removeData({rowIndx:d,colIndx:k,data:"pq_merge_nav"}));this.scrollRow({rowIndxPage:a.rowIndxPage});if(null==k)return this.selectRow(a);this.scrollColumn({colIndx:a.colIndx});return this.selectCell(a)};
a.getColModel=function(){return this.colModel};a.saveEditCell=function(a){var b=this.options,d=b.editModel;if(!d.indices)return null;d=f.extend({},d.indices);a=a?a.evt:null;var e=d.colIndx,d=d.rowIndxPage,k=d+this.rowIndxOffset,l=this.colModel[e],g=l.dataIndx,q=this.pdata,p=q[d],v=b.dataModel,b=this.iGenerateView,m;if(null==p)return null;if(null!=d){var h=this.getEditCellData();if(f.isPlainObject(h)){m={};for(var E in h)m[E]=p[E]}else m=b.readCell(p,l);"<br>"==h&&(h="");null==m&&""===h&&(h=null);
E={rowIndx:k,rowIndxPage:d,dataIndx:g,column:l,newVal:h,value:h,oldVal:m,rowData:p,dataModel:v};if(!1===this._trigger("cellBeforeSave",a,E))return!1;l={};v=!1;f.isPlainObject(h)?(l=h,v=!0):l[g]=h;if((e=c(d,e,this))&&e.rowspan){e=e.rowspan;h={};h[g]=b.readCell(p,g);g=[];if(e)for(p=0;p<e;p++)g.push({newRow:l,rowIndx:k+p,rowData:q[d+p],oldRow:h,type:"update"});d=this._digestData({source:"edit",checkEditable:!1,rowList:g})}else d=this.updateRow({row:l,rowIndx:k,refresh:v,silent:!0,source:"edit",checkEditable:!1});
if(!1===d)return!1;this._trigger("cellSave",a,E);return!0}};a._addInvalid=function(a){};a._digestData=function(a){if(!1===this._trigger("beforeValidate",null,a))return!1;var b=this.options,d=b.editModel,c=b.dataModel,e=c.data,k=b.colModel,l=b.pageModel,g=b.historyModel,q=a.validate,q=null==q?d.validate:q,p=l.type,v=a.allowInvalid,v=null==v?d.allowInvalid:v,h=b.trackModel,d=a.track,d=null==d?null==b.track?h.on:b.track:d,m=a.history,m=null==m?g.on:m,C=a.checkEditable,C=null==C?!0:C,G=a.checkEditableAdd,
G=null==G?C:G,g=this.iGenerateView.saveCell,h=this.columns,D=this.colIndxs,H=a.source,I=this.rowIndxOffset,M=f.paramquery.getValueFromDataType,K=a.rowList,N=K.length;e||(e=b.dataModel.data=[]);for(var Q=[],U=0;U<N;U++){var L=K[U],J=L.newRow,P=L.rowData,O=L.type,W=L.checkEditable,S=L.rowIndx,Y=L.oldRow;null==W&&("update"==O?W=C:"add"==O&&(W=G));if("update"==O){if(!Y||!P)throw"assert failed: oldRow and rowData required while update";if(W&&!0!==b.editable&&!1===this.isEditableRow({rowIndx:S,rowData:P}))continue}else if("delete"==
O){Q.push(L);continue}if("add"==O)for(var V=0,X=k.length;V<X;V++){var T=k[V],R=T.dataIndx;J[R]=J[R]}for(R in J){T=h[R];V=D[R];if(T){if(W&&null!=T.editable&&!1===this.isEditableCell({rowIndx:S,colIndx:V,dataIndx:R})){delete J[R];continue}var X=T.dataType,V=M(J[R],X),Z=Y?Y[R]:void 0,Z=void 0!==Z?M(Z,X):void 0;J[R]=V;if(q&&T.validations)if("edit"==H&&!1===v){if(T=this.isValid({dataIndx:R,rowIndx:S,value:V}),!1==T.valid&&!T.warn)return!1}else T=this.iIsValid.isValidCell({column:T,rowData:"add"==O?J:P,
allowInvalid:v,value:V}),!1===T.valid&&(!1!==v||T.warn||delete J[R]);if("update"==O&&V===Z){if("edit"==H)return null;delete J[R];continue}}"update"==O&&(Y[R]=Z)}if(J)if("update"==O)for(R in J){Q.push(L);break}else Q.push(L)}K=a.rowList=Q;N=K.length;if(!N)return!1;m&&(this.iHistory.increment(),this.iHistory.push({rowList:K}));for(U=0;U<N;U++)if(L=K[U],O=L.type,J=L.newRow,S=L.rowIndx,b=L.rowIndxPage,P=L.rowData,"update"==O)for(R in d&&this.iUCData.update({rowData:P,row:J,refresh:!1}),J)T=h[R],V=J[R],
g(P,T,V);else if("add"==O)d&&this.iUCData.add({rowData:J}),null==S&&null==b?e.push(J):(b=S-I,b="remote"==p?b:S,e.splice(b,0,J)),"remote"==p&&l.totalRecords++;else if("delete"==O){b=this.getRowIndx({rowData:P});k=b.uf;S=b.rowIndx;if(d)this.iUCData["delete"]({rowIndx:S,rowData:P});b=S-I;b="remote"==p?b:S;k?c.dataUF.splice(b,1):(b=e.splice(b,1))&&b.length&&"remote"==p&&l.totalRecords--}this._trigger("change",null,a);return!0};a.refreshColumn=function(a){var b=this.colModel,d=a.colIndx,c=a.dataIndx,d=
null==d?this.getColIndx({dataIndx:c}):d,c=null==c?b[d]:c,e=this.rowIndxOffset;a.colIndx=d;for(var k=this.initV,l=this.finalV,g=k;g<=l;g++){var f=g;a.rowIndx=f+e;a.rowIndxPage=f;a.colIndx=d;a.column=b[d];a.skip=!0;this.refreshCell(a)}this._trigger("refreshColumn",null,{dataModel:this.options.dataModel,colModel:b,initV:k,finalV:l,colIndx:d,dataIndx:c});this.iRefresh.softRefresh()};a.refreshCell=function(a){if(this.pdata){var b=this.rowIndxOffset,d=a.skip,c=a.rowIndx,e=a.rowIndxPage,c=a.rowIndx=null==
c?e+b:c,e=a.rowIndxPage=null==e?c-b:e,b=a.dataIndx,k=a.colIndx,k=a.colIndx=null==k?this.getColIndx({dataIndx:b}):k,l=this.getCell({all:!0,rowIndxPage:e,colIndx:k}),g=a.column,f=this.colModel;a.column=g?g:f[k];if(g=this.pdata[e])a.rowData=g,l&&0<l.length&&(a=this.iGenerateView.renderCell(a),l.replaceWith(a),d||(this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:f,rowData:g,rowIndx:c,rowIndxPage:e,colIndx:k,dataIndx:b}),this.iRefresh.softRefresh()))}};a.refreshRow=function(a){if(this.pdata){var b=
this.rowIndxOffset,d=a.rowIndx;a=a.rowIndxPage;d=null==d?a+b:d;a=null==a?d-b:a;var b=this.getRow({all:!0,rowIndxPage:a}),c=this.colModel,e=this.pdata[a],k=!1,l=document.activeElement;f(l);if(l==b[0]||1<b.length&&l==b[1])k=!0;if(!e||!b||!b.length)return null;l=[];this.iGenerateView.refreshRow(a,c,l,null,null,e.pq_detail&&e.pq_detail.show);c=l.join("");b.replaceWith(c);k&&this.getRow({all:!0,rowIndxPage:a}).attr("tabindex",0).focus();this._trigger("refreshRow",null,{rowData:e,rowIndx:d,rowIndxPage:a});
this.iRefresh.softRefresh();return!0}};a.quitEditMode=function(a){if(!this._quitEditMode){var b=!1,d=!1,c=!1,e=this.options.editModel,k=e.indices,l=void 0;this._quitEditMode=!0;a&&(b=a.old,d=a.silent,c=a.fireOnly,l=a.evt);k&&(d||b||this._trigger("editorEnd",l,k),c||(this._removeCellRowOutline(a),e.indices=null));this._quitEditMode=null}};a.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}};a.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,
finalH:this.finalH}};a.getRowIndxOffset=function(){return this.rowIndxOffset};a.selectCell=function(a){var b=a.evt;if(b&&("keydown"==b.type||"keypress"==b.type)){if(!1==this.iCells.replace(a))return!1}else if(!1===this.iCells.add(a))return!1;return!0};a.getEditCell=function(){var a=this.options.editModel;if(a.indices){var a=this.getCell(a.indices),b=this.$div_focus.children(".pq-editor-inner"),d=b.find(".pq-editor-focus");return{$td:a,$cell:b,$editor:d}}return null};a.editCell=function(a){this.scrollRow(a);
this.scrollColumn(a);var b=this.getCell(a);if(b&&b.length)return this._editCell(a)};a.getFirstEditableColIndx=function(a){if(null==a.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(a))return-1;for(var b=this.colModel,d=0;d<b.length;d++)if(a.colIndx=d,this.isEditableCell(a)&&!b[d].hidden)return d;return-1};a.editFirstCellInRow=function(a){var b=this.rowIndxOffset,d=a.rowIndx;a=a.rowIndxPage;d=null==d?a+b:d;a=null==a?d-b:a;b=this.getFirstEditableColIndx({rowIndx:d});-1!=b&&this.editCell({rowIndxPage:a,
colIndx:b})};a._editCell=function(a){var b=this,d=a.evt,c=this.element[0],e=this.rowIndxOffset,k=a.rowIndxPage,l=a.rowIndx,l=null==l?k+e:l,k=null==k?l-e:k,e=a.colIndx,g=a.dataIndx,e=null==e?this.getColIndx({dataIndx:g}):e,q=this.colModel[e],g=q.dataIndx,p=q.editor,v=this.options,h=v.editModel,m=v.editor,C=p?f.extend({},m,p):m,p=b.pdata[k],v=!1;if(!this.pdata||k>=this.pdata.length)return!1;if(h.indices){var G=h.indices;if(G.rowIndxPage==k&&G.colIndx==e){this.refreshEditorPos();var D=this.$div_focus.find(".pq-editor-focus");
window.setTimeout(function(){D.focus()},0);return!1}if(!1===this.blurEditor({evt:d}))return!1;this.quitEditMode({evt:d})}h.indices={rowIndxPage:k,rowIndx:l,colIndx:e,column:q,dataIndx:g};this._generateCellRowOutline();G=this.$div_focus.children(".pq-editor-inner");"right"==q.align?G.addClass("pq-align-right"):"center"==q.align?G.addClass("pq-align-center"):G.addClass("pq-align-left");var H=b.iGenerateView.readCell(p,q),I,M={rowIndx:l,rowIndxPage:k,$cell:G,cellData:H,rowData:p,dataIndx:g,column:q},
K=C.type;a=null==a.select?C.select:a.select;var N=C.init,Q=C.valueIndx,U=C.dataMap,L=C.mapIndices,L=L?L:{},J=C.cls||"",J="function"===typeof J?J.call(c,M):J;I="pq-editor-focus "+J;var J=I+" pq-cell-editor ",P=C.attr||"",P="function"===typeof P?P.call(c,M):P,O=C.style||"",O=(O="function"===typeof O?O.call(c,M):O)?"style='"+O+"'":"";M.cls=I;"function"==typeof K&&(I=K.call(c,M))&&(K=I);m._type=K;"checkbox"==K?(C=C.subtype,G.html("<input "+(H?"checked='checked'":"")+" class='"+J+"' "+P+" "+O+" type=checkbox name='"+
g+"' />"),m=G.children("input"),"triple"==C&&(m.pqval({val:H}),G.click(function(a){f(this).children("input").pqval({incr:!0})}))):"textarea"==K||"select"==K||"textbox"==K?("textarea"==K?I="<textarea class='"+J+"' "+P+" "+O+" name='"+g+"' ></textarea>":"select"==K?(m=C.options||[],"function"===typeof m&&(m=m.call(c,M)),J=[P," class='",J,"' ",O," name='",g,"'"].join(""),I=f.paramquery.select({options:m,attr:J,prepend:C.prepend,labelIndx:C.labelIndx,valueIndx:Q,groupIndx:C.groupIndx,dataMap:U})):I="<input class='"+
J+"' "+P+" "+O+" type=text name='"+g+"' />",f(I).appendTo(G).val("select"==K&&null!=Q&&(L[Q]||this.columns[Q])?L[Q]?p[L[Q]]:p[Q]:H)):K&&"contenteditable"!=K||(G.html("<div contenteditable='true' tabindx='0' "+O+" "+P+" class='"+J+"'></div>"),G.children().html(H),v=!0);"function"==typeof N&&N.call(c,M);var b=this,D=G.children(".pq-editor-focus"),W=h.filterKeys;(c=q.editModel)&&void 0!==c.filterKeys&&(W=c.filterKeys);var S={$cell:G,$editor:D,dataIndx:g,column:q,colIndx:e,rowIndx:l,rowIndxPage:k,rowData:p};
h.indices=S;D.data({FK:W}).on("click",function(a){f(this).focus()}).on("keydown",function(a){b.iKeyNav._keyDownInEdit(a)}).on("keypress",function(a){return b.iKeyNav._keyPressInEdit(a,{FK:W})}).on("keyup",function(a){return b.iKeyNav._keyUpInEdit(a,{FK:W})}).on("blur",function(a,d){var c=b.options.editModel,e=c.onBlur,k="save"==e,l="validate"==e,n=c.cancelBlurCls,g=d?d.force:!1;if(!b._quitEditMode&&!b._blurEditMode&&c.indices){c=f(a.target);if(!g){if(!1===b._trigger("editorBlur",a,S)||!e||n&&c.hasClass(n))return;
if(c.hasClass("hasDatepicker")){if(c.datepicker("widget").is(":visible"))return!1}else if(c.hasClass("ui-autocomplete-input")){if(c.autocomplete("widget").is(":visible"))return}else if(c.hasClass("ui-multiselect")){if(f(".ui-multiselect-menu").is(":visible")||f(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(c.hasClass("pq-select-button")&&(f(".pq-select-menu").is(":visible")||f(document.activeElement).closest(".pq-select-menu").length))return}b._blurEditMode=!0;if(!b.saveEditCell({evt:a,
silent:g||k||!l})&&!g&&l)return b._deleteBlurEditMode(),!1;b.quitEditMode({evt:a});b._deleteBlurEditMode()}}).on("focus",function(a){b._trigger("editorFocus",a,S)});b._trigger("editorBegin",d,S);D.focus();window.setTimeout(function(){!1===f(document.activeElement).hasClass("pq-editor-focus")&&b.element.find(".pq-editor-focus").focus()},0);if(a)if(v)try{var Y=D[0],V=document.createRange();V.selectNodeContents(Y);var X=window.getSelection();X.removeAllRanges();X.addRange(V)}catch(T){}else D.select()};
a._deleteBlurEditMode=function(a){var b=this;a=a?a:{};b._blurEditMode&&(a.timer?window.setTimeout(function(){delete b._blurEditMode},0):delete b._blurEditMode)};a.getRow=function(a){var b=a.rowIndxPage,d=a.rowIndx,c=this.rowIndxOffset,b=null==b?d-c:b;a=a.all?this.$tbl:this.get$Tbl(b);var e;a&&a.length&&(d=a.children("tbody"),null!=b&&(e=d.children("tr[pq-row-indx="+b+"]"),e.length>a.length&&(e=e.filter(".pq-detail-master"))));return e};a.getCell=function(a){var b=a.rowIndxPage,d=a.rowIndx,b=null==
b?d-this.rowIndxOffset:b,d=a.colIndx,c=a.dataIndx,d=null==d?this.getColIndx({dataIndx:c}):d;return(a=a.all?this.$tbl:this.get$Tbl(b,d))&&a.length?a.children().children("tr[pq-row-indx="+b+"]").children("[pq-col-indx="+d+"]"):f()};a.getCellHeader=function(a){var b=a.colIndx;a=a.dataIndx;b=null==b?this.getColIndx({dataIndx:a}):b;a=this.$tbl_header;var d,c=this.options.freezeCols;void 0!=a&&(1<a.length&&(a=b>=c?f(a[1]):f(a[0])),d=a.children().children("tr.pq-grid-title-row:last").children("[pq-col-indx="+
b+"]"));return 0==d.length||"hidden"==d[0].style.visibility?null:d};a.getEditorIndices=function(){var a=this.options.editModel.indices;return a?f.extend({},a):null};a.getEditCellData=function(){var a=this.options,b=a.editModel.indices;if(!b)return null;var d=b.rowIndxPage,c=b.rowIndx,e=this.colModel[b.colIndx],k=e.editor,l=a.editor,a=k?f.extend({},l,k):l,g=a.valueIndx,q=a.labelIndx,k=(k=a.mapIndices)?k:{},p=e.dataIndx,v=this.$div_focus.children(".pq-editor-inner"),m;if("function"==typeof a.getData)m=
a.getData.call(this.element[0],{$cell:v,rowData:b.rowData,dataIndx:p,rowIndx:c,rowIndxPage:d,column:e});else if(b=l._type,"checkbox"==b)m=v.children(),m="triple"==a.subtype?m.pqval():m.is(":checked")?!0:!1;else if("contenteditable"==b)m=v.children().html();else if((d=v.find('*[name="'+p+'"]'))&&d.length)if("select"==b&&null!=g)if(k[g]||this.columns[g]){if(m={},m[k[g]?k[g]:g]=d.val(),m[k[q]?k[q]:q]=d.find("option:selected").text(),a=a.dataMap)if(b=d.find("option:selected").data("map"))for(d=0;d<a.length;d++)c=
a[d],m[k[c]?k[c]:c]=b[c]}else m=d.val();else m=d.val();else(d=v.find(".pq-editor-focus"))&&d.length&&(m=d.val());return m};a.getCellIndices=function(a){var b=a.$td;if(null==b||0==b.length||b.closest(".pq-grid")[0]!=this.element[0])return{rowIndxPage:null,colIndx:null};a=b.parent("tr").attr("pq-row-indx");var d;null!=a&&(a=parseInt(a),d=a+this.rowIndxOffset);var b=b.attr("pq-col-indx"),c;null!=b&&(b=parseInt(b),0<=b&&(c=this.colModel[b].dataIndx));return{rowIndxPage:a,rowIndx:d,colIndx:b,dataIndx:c}};
a.getRowsByClass=function(a){var b=this.options,d="remote"==b.pageModel.type?!0:!1,c=this.rowIndxOffset,b=b.dataModel.data,e=[];if(null==b)return e;for(var k=0,l=b.length;k<l;k++){var g=b[k];a.rowData=g;this.hasClass(a)&&(g={rowData:g},g.rowIndx=d?k+c:k,e.push(g))}return e};a.getCellsByClass=function(a){var b=this.options,d="remote"==b.pageModel.type?!0:!1,c=this.rowIndxOffset,b=b.dataModel.data,e=this.colModel,k=e.length,l=[],g=function(a){for(var b=0;b<k;b++){var d=e[b].dataIndx;a.dataIndx=d;this.hasClass(a)&&
l.push({rowData:a.rowData,dataIndx:d,colIndx:b,rowIndx:a.rowIndx})}};if(null==b)return l;if(null!=a.rowIndx||null!=a.rowIndxPage||null!=a.rowData)a.rowData=a.rowData||this.getRowData(a),null==a.rowIndx&&(a.rowIndx=this.getRowIndx({rowData:p})),g(a);else for(var f=0,q=b.length;f<q;f++){var p=b[f];a.rowData=p;a.rowIndx=d?f+c:f;g(a)}return l};a.data=function(a){var b=a.dataIndx,d=a.colIndx,b=null!=d?this.colModel[d].dataIndx:b,d=a.data,c=null==d||"string"==typeof d?!0:!1;a=a.rowData||this.getRowData(a);
if(!a)return{data:null};if(null==b){b=a.pq_rowdata;if(c){var e;null!=b&&(e=null==d?b:b[d]);return{data:e}}d=f.extend(!0,a.pq_rowdata,d);a.pq_rowdata=d}else{var k=a.pq_celldata;if(c)return null!=k&&(b=k[b],e=null==d||null==b?b:b[d]),{data:e};k||(a.pq_celldata={});d=f.extend(!0,a.pq_celldata[b],d);a.pq_celldata[b]=d}};a.attr=function(a){var b=a.rowIndx,d=a.dataIndx,c=a.colIndx,d=null!=c?this.colModel[c].dataIndx:d,c=a.attr,e=null==c||"string"==typeof c?!0:!1,k=this.rowIndxOffset,l=a.refresh;a=a.rowData||
this.getRowData(a);if(!a)return{attr:null};e||!1===l||null!=b||(b=this.getRowIndx({rowData:a}).rowIndx);if(null==d){d=a.pq_rowattr;if(e){var g;null!=d&&(g=null==c?d:d[c]);return{attr:g}}c=f.extend(!0,a.pq_rowattr,c);a.pq_rowattr=c;!1!==l&&null!=b&&(b=this.getRow({rowIndxPage:b-k}))&&(d=q(c),b.attr(d))}else{var p=a.pq_cellattr;if(e)return null!=p&&(b=p[d],g=null==c||null==b?b:b[c]),{attr:g};p||(a.pq_cellattr={});c=f.extend(!0,a.pq_cellattr[d],c);a.pq_cellattr[d]=c;!1!==l&&null!=b&&(b=this.getCell({rowIndxPage:b-
k,dataIndx:d}))&&(d=q(c),b.attr(d))}};var q=function(a,b){var d={},c;for(c in a){var e=a[c];if(e)if("title"==c)e=e.replace(/\"/g,"&quot;"),d[c]=e;else if("style"==c&&"object"==typeof e){var k=[],l,g;for(g in e)l=e[g],b&&"display"==g&&"none"==l||l&&k.push(g+":"+l);(e=k.join(";")+(k.length?";":""))&&(d[c]=e)}else"object"==typeof e&&(e=JSON.stringify(e)),d[c]=e}return d};a.removeData=function(a){var b=a.dataIndx,d=a.colIndx,b=null!=d?this.colModel[d].dataIndx:b,d=a.data,d=null==d?[]:d,d="string"==typeof d?
d.split(" "):d,c=d.length,e=a.rowData||this.getRowData(a);if(e)if(null==b){if(b=e.pq_rowdata){if(c)for(a=0;a<c;a++){var k=d[a];delete b[k]}c&&!f.isEmptyObject(b)||delete e.pq_rowdata}}else if((e=e.pq_celldata)&&e[b]){var l=e[b];if(c)for(a=0;a<c;a++)k=d[a],delete l[k];c&&!f.isEmptyObject(l)||delete e[b]}};a.removeAttr=function(a){var b=a.rowIndx,d=a.dataIndx,c=a.colIndx,d=null!=c?this.colModel[c].dataIndx:d,e=a.attr,e=null==e?[]:e,e="string"==typeof e?e.split(" "):e,k=e.length,c=b-this.rowIndxOffset,
l=a.refresh,g=a.rowData||this.getRowData(a);if(g)if(!1!==l&&null==b&&(b=this.getRowIndx({rowData:g}).rowIndx),null==d){if(d=g.pq_rowattr){if(k)for(a=0;a<k;a++){var q=e[a];delete d[q]}else for(q in d)e.push(q);k&&!f.isEmptyObject(d)||delete g.pq_rowattr}!1!==l&&null!=b&&e.length&&(e=e.join(" "),(b=this.getRow({rowIndxPage:c}))&&b.removeAttr(e))}else{if((g=g.pq_cellattr)&&g[d]){var p=g[d];if(k)for(a=0;a<k;a++)q=e[a],delete p[q];else for(q in p)e.push(q);k&&!f.isEmptyObject(p)||delete g[d]}!1!==l&&null!=
b&&e.length&&(e=e.join(" "),(b=this.getCell({rowIndxPage:c,dataIndx:d}))&&b.removeAttr(e))}};f.paramquery.uniqueArray=function(a){for(var b=[],d=f.inArray,c=0,e=a.length;c<e;c++){var k=a[c];-1==d(k,b)&&b.push(k)}return b};a.addClass=function(a){var b=a.rowIndx,d=a.dataIndx,c=f.paramquery.uniqueArray,e=a.cls,k=this.rowIndxOffset,l=a.refresh,g=a.rowData||this.getRowData(a);if(g)if(!1!==l&&null==b&&(b=this.getRowIndx({rowData:g}).rowIndx),null==d){var d=g.pq_rowcls,q;q=c((d?d+" "+e:e).split(/\s+/)).join(" ");
g.pq_rowcls=q;!1!==l&&null!=b&&(b=this.getRow({rowIndxPage:b-k}))&&b.addClass(e)}else{a=[];"function"!=typeof d.push?a.push(d):a=d;var p=g.pq_cellcls;p||(p=g.pq_cellcls={});for(var g=0,v=a.length;g<v;g++)d=a[g],q=(q=p[d])?q+" "+e:e,q=c(q.split(/\s+/)).join(" "),p[d]=q,!1!==l&&null!=b&&(d=this.getCell({rowIndxPage:b-k,dataIndx:d}))&&d.addClass(e)}};a.removeClass=function(a){var b=a.rowIndx,d=this.getRowData(a),c=a.dataIndx,e=a.cls;a=a.refresh;if(d){var k=d.pq_cellcls,l=d.pq_rowcls;!1!==a&&null==b&&
(b=this.getRowIndx({rowData:d}).rowIndx);if(null==c)l&&(d.pq_rowcls=this._removeClass(l,e),null!=b&&!1!==a&&(b=this.getRow({rowIndx:b}))&&b.removeClass(e));else if(k){l=[];"function"!=typeof c.push?l.push(c):l=c;for(var g=0,f=l.length;g<f;g++){var c=l[g],q=k[c];q&&(d.pq_cellcls[c]=this._removeClass(q,e),null!=b&&!1!==a&&(c=this.getCell({rowIndx:b,dataIndx:c}))&&c.removeClass(e))}}}};a.hasClass=function(a){var b=a.dataIndx,d=a.cls;a=this.getRowData(a);d=new RegExp("\\b"+d+"\\b");return a?null==b?(b=
a.pq_rowcls)&&d.test(b)?!0:!1:(a=a.pq_cellcls)&&a[b]&&d.test(a[b])?!0:!1:null};a._removeClass=function(a,b){if(a&&b){for(var d=a.split(/\s+/),c=b.split(/\s+/),e=[],k=0,l=d.length;k<l;k++){for(var g=d[k],f=!1,q=0,p=c.length;q<p;q++)if(g===c[q]){f=!0;break}f||e.push(g)}return 1<e.length?e.join(" "):1===e.length?e[0]:null}};a.getRowIndx=function(a){var b=a.$tr,d=a.rowData;a=a.row;if(d||a){var b=this.options,c=b.dataModel,b="remote"==b.pageModel.type?!0:!1,e=c.data,k=!1,c=c.dataUF;if(d){var l=!1;if(e)for(var g=
0,f=e.length;g<f;g++)if(e[g]==d){l=!0;break}if(!l&&c)for(k=!0,g=0,f=c.length;g<f;g++)if(c[g]==d){l=!0;break}}else for(g=0,f=e;g<f;g++){var d=e[g],l=!0,q;for(q in a)a[q]!==d[q]&&(l=!1);if(l)break}return l?(l=this.rowIndxOffset,{rowIndxPage:k?void 0:b?g:g-l,uf:k,rowIndx:b?g+l:g,rowData:d}):{}}if(null==b||0==b.length)return{rowIndxPage:null};d=b.attr("pq-row-indx");if(null==d)return{rowIndxPage:null};d=parseInt(d);return{rowIndxPage:d,rowIndx:d+this.rowIndxOffset}};var p=function(a){this.options=a.options;
this.that=a;var b=this,d=a.widgetEventPrefix.toLowerCase();a.element.on(d+"celleditkeyup"+a.eventNamespace,function(a,d){return b.filterKeys(a,d)})},g=p.prototype;g._incrRowIndx=function(a,b){var d=this.that,c=a;b=null==b?1:b;for(var d=d.pdata,e=0,k=a+1,l=d.length;k<l&&(d[k].pq_hidden||(e++,c=k,e!=b));k++);return c};g._decrRowIndx=function(a,b){var d=a,c=this.that.pdata;b=null==b?1:b;for(var e=0,k=a-1;0<=k&&(c[k].pq_hidden||(e++,d=k,e!=b));k--);return d};a.addColumn=function(a,b){var d=this.options,
c=d.dataModel.data;d.colModel.push(a);this._calcThisColModel();for(d=0;d<c.length;d++)c[d].push("")};a.rowNextSelect=function(){var a=this.selection({type:"row",method:"getSelection"}),b,d=this.rowIndxOffset;a&&a[0]&&(a=a[0].rowIndx,b=this.iKeyNav._incrRowIndx(a-d));null!=b&&(this.setSelection(null),this._setSelection({rowIndxPage:b}));return b};a.rowPrevSelect=function(){var a=this.selection({type:"row",method:"getSelection"}),b,d=this.rowIndxOffset;a&&a[0]&&(a=a[0].rowIndx,b=this.iKeyNav._decrRowIndx(a-
d));null!=b&&(this.setSelection(null),this.setSelection({rowIndxPage:b}));return b};g._incrIndx=function(a,b){var d=this.that,c=d._getLastVisibleRowIndxPage(d.pdata),d=d.colModel,e=d.length;if(null==b){if(a==c)return null;a=this._incrRowIndx(a);return{rowIndxPage:a}}var k;do{b++;if(b>=e){if(a==c)return null;a=this._incrRowIndx(a);b=0}k=d[b]}while(k&&k.hidden);return{rowIndxPage:a,colIndx:b}};g._decrIndx=function(a,b){var d=this.that,c=d.colModel,e=c.length,d=d._getFirstVisibleRowIndxPage(d.pdata);
if(null==b){if(a==d)return null;a=this._decrRowIndx(a);return{rowIndxPage:a}}var k;do{b--;if(0>b){if(a==d)return null;a=this._decrRowIndx(a);b=e-1}k=c[b]}while(k&&k.hidden);return{rowIndxPage:a,colIndx:b}};g._incrEditIndx=function(a,b){var d=this.that,c=d.colModel,e=c.length,k,l=d.rowIndxOffset,g=d._getLastVisibleRowIndxPage(d.pdata);do{b++;if(b>=e){if(a==g)return null;do{a=this._incrRowIndx(a);var f=a+l;k=d.isEditableRow({rowIndx:f});if(a==g&&!1==k)return null}while(!1==k);b=0}k=c[b];f=a+l;f=d.isEditableCell({rowIndx:f,
colIndx:b,checkVisible:!0})}while(k&&(k.hidden||!1==f));return{rowIndxPage:a,colIndx:b}};g._decrEditIndx=function(a,b){var d=this.that,c=d.colModel,e=c.length,k,l=d.rowIndxOffset,g=d._getFirstVisibleRowIndxPage(d.pdata);do{b--;if(0>b){if(a==g)return null;do{a=this._decrRowIndx(a);var f=a+l;k=d.isEditableRow({rowIndx:f});if(a==g&&!1==k)return null}while(!1==k);b=e-1}k=c[b];f=a+l;f=d.isEditableCell({rowIndx:f,colIndx:b,checkVisible:!0})}while(k&&(k.hidden||!1==f));return{rowIndxPage:a,colIndx:b}};g._incrEditRowIndx=
function(a,b){var d=this.that,c=d.rowIndxOffset,e=d._getLastVisibleRowIndxPage(d.pdata);if(a==e)return null;do{a=this._incrRowIndx(a);var k=a+c,l=d.isEditableRow({rowIndx:k}),k=d.isEditableCell({rowIndx:k,colIndx:b}),l=l&&k;if(a==e&&!l)return null}while(!l);return{rowIndxPage:a,colIndx:b}};g._decrEditRowIndx=function(a,b){var d=this.that,c=d.rowIndxOffset,e=d._getFirstVisibleRowIndxPage(d.pdata);if(a==e)return null;do{a=this._decrRowIndx(a);var k=a+c,l=d.isEditableRow({rowIndx:k}),k=d.isEditableCell({rowIndx:k,
colIndx:b}),l=l&&k;if(a==e&&!l)return null}while(!l);return{rowIndxPage:a,colIndx:b}};a._onKeyPressDown=function(a){if(0<f(a.target).closest(".pq-grid-header").length)return!1==this._trigger("headerKeyDown",a,{dataModel:this.options.dataModel})?!1:!0;if(!1===this.iKeyNav._bodyKeyPressDown(a)||!1==this._trigger("keyDown",a,{dataModel:this.options.dataModel}))return!1};g._saveAndMove=function(a,b){if(null==a)return b.preventDefault(),!1;var d=this.that,c=this.options.selectionModel,e=a.rowIndxPage,
k=a.colIndx;d._blurEditMode=!0;if(!1===d.saveEditCell({evt:b})||!d.pdata)return d.pdata||d.quitEditMode(b),d._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),b.preventDefault(),!1;d.quitEditMode(b);if(a.incr)var l,e=(l=b.shiftKey?this._decrEditIndx(e,k):this._incrEditIndx(e,k))?l.rowIndxPage:e,k=l?l.colIndx:k;"row"==c.type?(d.setSelection(null),d.setSelection({rowIndxPage:e}),d.scrollColumn({colIndx:k})):"cell"==c.type?(d.setSelection(null),d.setSelection({rowIndxPage:e,colIndx:k})):
(d.scrollRow({rowIndxPage:e}),d.scrollColumn({colIndx:k}));!1!==a.edit&&d._editCell({rowIndxPage:e,colIndx:k});d._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"});b.preventDefault();return!1};g._keyPressInEdit=function(a,b){var d=this.that,c=d.options.editModel.indices;b=b?b:{};var e=b.FK,k="Backspace Left Right Up Down Del Home End".split(" "),l=c.column.dataType;return a.key&&-1!==f.inArray(a.key,k)?!0:!1===d._trigger("editorKeyPress",a,f.extend({},c))||e&&("float"==l||"integer"==l)&&(d="float"==
l?"0123456789.-":"0123456789-",c=(c=a.charCode)?c:a.keyCode,(c=String.fromCharCode(c))&&-1==d.indexOf(c))?!1:!0};g.getValText=function(a){a=a[0].nodeName.toLowerCase();var b="text";-1!=f.inArray(a,["input","textarea","select"])&&(b="val");return b};g._keyUpInEdit=function(a,b){var d=this.that,c=d.options;b=b?b:{};var e=b.FK,c=c.editModel,k=c.indices;d._trigger("editorKeyUp",a,f.extend({},k));d=k.column.dataType;if(e&&("float"==d||"integer"==d)){var e=f(a.target),k="integer"==d?c.reInt:c.reFloat,c=
this.getValText(e),l=e.data("oldVal"),g=e[c]();if(!1==k.test(g))if(k.test(l))e[c](l);else if(d="float"==d?parseFloat(l):parseInt(l),isNaN(d))e[c](0);else e[c](d)}};g._keyDownInEdit=function(a){var b=this.that,d=b.options,c=d.editModel.indices;if(c){var e=f(a.target),k=f.ui.keyCode,l=d.selectionModel,g=d.editModel,c=f.extend({},c),d=c.rowIndxPage,q=c.colIndx,p=c.column.editModel,g=p?f.extend({},g,p):g,p=this.getValText(e);e.data("oldVal",e[p]());if(!1==b._trigger("cellEditKeyDown",a,c)||!1==b._trigger("editorKeyDown",
a,c))return!1;if(a.keyCode==k.TAB)return c={rowIndxPage:d,colIndx:q,incr:!0},this._saveAndMove(c,a);if(a.keyCode==g.saveKey)return c="next"==g.onSave?{rowIndxPage:d,colIndx:q,incr:!0}:{rowIndxPage:d,colIndx:q,edit:!1},this._saveAndMove(c,a);if(a.keyCode==k.ESCAPE)return b.quitEditMode({evt:a}),"cell"==l.type?b.getCell({rowIndxPage:d,colIndx:q}).attr("tabindex",0).focus():"row"==l.type&&(b=b.getRow({rowIndxPage:d}),f(b[0]).attr("tabindex",0).focus()),a.preventDefault(),!1;if(a.keyCode==k.PAGE_UP||
a.keyCode==k.PAGE_DOWN)return a.preventDefault(),!1;if(g.keyUpDown){if(a.keyCode==k.DOWN)return c=this._incrEditRowIndx(d,q),this._saveAndMove(c,a);if(a.keyCode==k.UP)return c=this._decrEditRowIndx(d,q),this._saveAndMove(c,a)}}};g.select=function(a){var b=this.that,d=a.rowIndx,c=a.colIndx,e=b.options.selectionModel;a=a.evt;a.shiftKey&&"single"!=e.mode?"row"==e.type?(b.scrollRow({rowIndx:d}),b.iRows.extendSelection({rowIndx:d,evt:a})):"cell"==e.type&&(b.scrollCell({rowIndx:d,colIndx:c}),b.iCells.extendSelection({rowIndx:d,
colIndx:c,evt:a})):b.setSelection({rowIndx:d,colIndx:c,evt:a,setFirst:!0})};g._bodyKeyPressDown=function(a){var b=this.that,d,k,l=b.rowIndxOffset,g=this.options,q=b.colModel,p=g.selectionModel,v=g.editModel,m=a.ctrlKey||a.metaKey,h,B,E=f.ui.keyCode,C=a.keyCode;if(v.indices)b.$div_focus.find(".pq-cell-focus").focus();else{if("row"==p.type){k=m?b.iRows.getFocusSelection({old:!0}):b.iRows.getFocusSelection({old:!1});if(null==k)return;h=k.rowIndx;g=h-l;if(null==h)return;if(!1==b._trigger("rowKeyDown",
a,{rowData:b.pdata[g],rowIndx:h,rowIndxPage:g}))return!1}else if("cell"==p.type){d=m?b.iCells.getFocusSelection({old:!0}):b.iCells.getFocusSelection({old:!1});if(null==d)return;B=d;h=B.rowIndx;var g=h-l,G=B.dataIndx;B=b.getColIndx({dataIndx:G});if(null==h||null==B)return;if(!1==b._trigger("cellKeyDown",a,{rowData:b.pdata[g],rowIndx:h,rowIndxPage:g,colIndx:B,dataIndx:G,column:q[B]}))return!1;if(a.cancelBubble)return}else return;if(C==E.LEFT||C==E.RIGHT||C==E.UP||C==E.DOWN){d=c(g,B,b);var D;d&&(D=b.data({rowIndx:h,
colIndx:B,data:"pq_merge_nav"}).data);if(C==E.LEFT){if(h=D?D.rowIndx:h,B=this._decrIndx(h-l,B))h=B.rowIndxPage+l,this.select({rowIndx:h,colIndx:B.colIndx,evt:a})}else if(C==E.RIGHT){if(h=D?D.rowIndx:h,B+=d&&d.colspan?d.colspan-1:0,B=this._incrIndx(h-l,B))h=B.rowIndxPage+l,this.select({rowIndx:h,colIndx:B.colIndx,evt:a})}else C==E.UP?(d?(h=e({rowIndx:h,colIndx:B,that:b}),h=h.rowIndx,g=this._decrRowIndx(h-l),h=g+l,h=e({rowIndx:h,colIndx:B,that:b}),h=h.rowIndx):(g=this._decrRowIndx(g),h=g+l),B=D?D.colIndx:
B,null!=g&&this.select({rowIndx:h,colIndx:B,evt:a})):C==E.DOWN&&(g+=d&&d.rowspan&&g+d.rowspan<b.pdata.length?d.rowspan-1:0,B=D?D.colIndx:B,g=this._incrRowIndx(g),null!=g&&(h=g+l,this.select({rowIndx:h,colIndx:B,evt:a})));a.preventDefault()}else if(C==E.PAGE_DOWN||C==E.SPACE){if(b=this.pageDown(g))g=b.rowIndxPage,null!=g&&(h=g+l,this.select({rowIndx:h,colIndx:B,evt:a}));a.preventDefault()}else if(C==E.PAGE_UP){if(b=this.pageUp(g))g=b.rowIndxPage,null!=g&&(h=g+l,this.select({rowIndx:h,colIndx:B,evt:a}));
a.preventDefault()}else C==E.HOME?("row"==p.type||m?(h=b._getFirstVisibleRowIndxPage(b.pdata)+l,this.select({rowIndx:h,colIndx:B,evt:a})):"cell"==p.type&&(B=b._getFirstVisibleColIndx(),this.select({rowIndx:h,colIndx:B,evt:a})),a.preventDefault()):C==E.END?("row"==p.type||m?(h=b._getLastVisibleRowIndxPage(b.pdata)+l,this.select({rowIndx:h,colIndx:B,evt:a})):"cell"==p.type&&(B=b._getLastVisibleColIndx(),this.select({rowIndx:h,colIndx:B,evt:a})),a.preventDefault()):C==E.ENTER?("row"==p.type?null!=k&&
b.editFirstCellInRow({rowIndx:g+l}):null!=d&&(D=b.getCell({rowIndxPage:g,colIndx:B}))&&0<D.length&&(h=g+l,l=b.isEditableRow({rowIndx:h}),D=b.isEditableCell({rowIndx:h,colIndx:B}),l&&D&&b.editCell({rowIndxPage:g,colIndx:B})),a.preventDefault()):m&&"65"==C?("row"==p.type&&"single"!=p.mode?b.iRows.selectAll({all:p.all}):"cell"==p.type&&"single"!=p.mode&&b.iCells.selectAll({all:p.all}),a.preventDefault()):v.pressToEdit&&32<=C&&127>=C&&!m&&null!=d&&(D=b.getCell({rowIndxPage:g,colIndx:B}))&&0<D.length&&
(h=g+l,l=b.isEditableRow({rowIndx:h}),D=b.isEditableCell({rowIndx:h,colIndx:B}),l&&D&&b.editCell({rowIndxPage:g,colIndx:B,select:!0}))}};g.incrPageSize=function(){for(var a=this.that,b=a.$tbl,d=b.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),b=parseInt(b.css("marginTop")),b=a.iRefresh.getEContHt()-b,c=d.length-1;0<=c;c--){var e=d[c];if(e.offsetTop<b)break}return{rowIndxPage:a.getRowIndx({$tr:f(e)}).rowIndxPage}};g.pageNonVirtual=function(a,b){var d=this.that,c=
d.$cont[0].offsetHeight-d._getSBHeight(),e=d.getRow({rowIndxPage:a}),k=0,l=0,g=f(e[0])[b]("tr.pq-grid-row"),q=g.length;if(0<q){do{e=g[l];k+=e.offsetHeight;if(k>=c)break;l++}while(l<q);l=0<l?l-1:l;do if(e=f(g[l]),a=d.getRowIndx({$tr:e}).rowIndxPage,null!=a)break;else l--;while(0<=l)}return a};g.pageDown=function(a){var b=this.that,d=b.options,c=b.$vscroll.pqScrollBar("option"),e=c.cur_pos,k=c.num_eles,c=c.ratio;if(d.virtualY){if(e<k-1){a=this.incrPageSize().rowIndxPage;var l=b._calcCurPosFromRowIndxPage(a);
if(null==l)return;b.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll")}}else null!=a?a=this.pageNonVirtual(a,"nextAll"):1>c&&(d=b.iRefresh.getEContHt(),b=b.iMouseSelection,b.updateTableY(-1*d),b.syncScrollBarVert());return{rowIndxPage:a,curPos:l}};g.pageUp=function(a){var b=this.that,d=b.options,c=b.$vscroll.pqScrollBar("option"),e=c.cur_pos,c=c.ratio;if(d.virtualY){if(0<e){a=this.decrPageSize().rowIndxPage;var k=b._calcCurPosFromRowIndxPage(a);if(null==k)return;b.$vscroll.pqScrollBar("option",
"cur_pos",k).pqScrollBar("scroll")}}else null!=a?a=this.pageNonVirtual(a,"prevAll"):0<c&&(d=b.iRefresh.getEContHt(),b=b.iMouseSelection,b.updateTableY(d),b.syncScrollBarVert());return{rowIndxPage:a,curPos:k}};g.decrPageSize=function(){var a=this.that,b=a.$tbl.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),d=a.options.freezeRows,c=0;if(b.length){var e;d?(e=b.filter("tr.pq-last-frozen-row"),e.length&&(e=e.next())):2<=b.length&&(e=f(b[1]));e&&e.length&&(c=a.getRowIndx({$tr:e}).rowIndxPage,
c=c-a.pageSize+4,0>c&&(c=0))}return{rowIndxPage:c}};a._calcNumHiddenFrozens=function(){for(var a=0,b=this.options.freezeCols,d=0;d<b;d++)this.colModel[d].hidden&&a++;return a};a._calcNumHiddenUnFrozens=function(a){var b=0;a=null!=a?a:this.colModel.length;for(var d=this.options.freezeCols;d<a;d++)this.colModel[d].hidden&&b++;return b};a._getSBHeight=function(){return this.iRefresh.getSBHeight()};a._getSBWidth=function(a){return this.iRefresh.getSBWidth()};a._getFirstVisibleRowIndxPage=function(a){for(var b=
0,d=a.length;b<d;b++)if(!a[b].pq_hidden)return b};a._getLastVisibleRowIndxPage=function(a){for(var b=a.length-1;0<=b;b--)if(!a[b].pq_hidden)return b;return null};a._getFirstVisibleColIndx=function(){for(var a=this.colModel,b=a.length,d=0;d<b;d++)if(!a[d].hidden)return d;return null};a._getLastVisibleColIndx=function(){for(var a=this.colModel,b=a.length-1;0<=b;b--)if(!a[b].hidden)return b;return null};a.getTotalVisibleColumns=function(){for(var a=this.colModel,b=a.length,d=0,c=0;c<b;c++)a[c].hidden||
d++;return d};a._calcCurPosFromRowIndxPage=function(a){var b=this.options,d=b.groupModel,c=d?this.dataGM:this.pdata,e=b.freezeRows;if(a<e)return 0;for(var b=0,k=e,l=c.length;e<l;e++){var g=c[e];if(!d||!g.groupSummary&&!g.groupTitle){if(k==a)break;k++}g.pq_hidden||b++}return b>=l?null:b};a._calcCurPosFromColIndx=function(a){var b=this.colModel,d=this.options.freezeCols;if(a<d)return 0;for(var c=0,e=d,k=b.length;d<k;d++){var l=b[d];if(e==a)break;e++;l.hidden||c++}return c>=k?null:c};var v=function(a,
b,d){var c=0,e=this.options.numberCell,k=this.colModel;-1==a&&(e.show&&(c=d?c+(parseInt(e.width)+1):c+e.outerWidth),a=0);if(d)for(;a<b;a++){if((d=k[a])&&!d.hidden){if(!d._width)throw"assert failed";c+=d._width+0}}else for(;a<b;a++)(d=k[a])&&!d.hidden&&(c+=d.outerWidth);return c};f.paramquery.pqgrid.calcWidthCols=v;a.calcHeightFrozenRows=function(){var a=this.$tbl,b=0;a&&a.length&&(a=f(a[0]).find("tr.pq-last-frozen-row"))&&a.length&&(b=a[0],b=b.offsetTop+b.offsetHeight);return b};a._calcRightEdgeCol=
function(a){var b=0,d=0,c=this.colModel,e=this.hidearrHS,k=this.options.numberCell;k.show&&(b+=k.outerWidth,d++);for(k=0;k<=a;k++){var l=c[k];l.hidden||!1!=e[k]||(b+=l.outerWidth,d++)}return{width:b,cols:d}};a.nestedCols=function(a,b,d){var c=a.length,e=[];null==b&&(b=1);for(var k=b,l=0,g=0,f=0;f<c;f++){var q=a[f];if(!0===d||!1===d)q.hidden=d;if(null!=q.colModel&&0<q.colModel.length){var p=this.nestedCols(q.colModel,b+1,q.hidden),e=e.concat(p.colModel);0<p.colSpan?(p.depth>k&&(k=p.depth),q.colSpan=
p.colSpan,l+=p.colSpan):(q.colSpan=0,q.hidden=!0);q.childCount=p.childCount;g+=p.childCount}else q.hidden?q.colSpan=0:(q.colSpan=1,l++),q.childCount=0,g++,e.push(q)}return{depth:k,colModel:e,colSpan:l,width:0,childCount:g}};a.getHeadersCells=function(){for(var a=this.options.colModel,b=this.colModel.length,d=this.depth,c=[],e=0;e<d;e++){c[e]=[];for(var k=0,l=0,g=0;g<b;g++){var f;if(0==e)f=a[k];else{var q=c[e-1][g];f=q.colModel;if(null==f||0==f.length)f=q;else{for(var q=g-q.leftPos,p=0,v=0,h=0;h<f.length;h++)if(p+=
0<f[h].childCount?f[h].childCount:1,q<p){v=h;break}f=f[v]}}q=f.childCount?f.childCount:1;g==l?(f.leftPos=g,c[e][g]=f,l+=q,a[k+1]&&k++):c[e][g]=c[e][g-1]}}return this.headerCells=c};a.getDataType=function(){var a=this.colModel;if(a&&a[0])return"string"==typeof a[0].dataIndx?"JSON":"ARRAY";throw"dataType unknown";};a.assignRowSpan=function(){for(var a=this.colModel.length,b=this.headerCells,d=this.depth,c=0;c<a;c++)for(var e=0;e<d;e++){var k=b[e][c];if(!(0<c&&k==b[e][c-1]||0<e&&k==b[e-1][c])){for(var l=
1,g=e+1;g<d;g++)k==b[g][c]&&l++;k.rowSpan=l}}return b};a._autoGenColumns=function(){var a=this.options,b=a.columnTemplate||{},d=b.dataType,c=b.title,e=b.width,b=a.dataModel.data,k=f.paramquery.validation,l=[];b&&b.length&&f.each(b[0],function(a,b){var g="string";k.isInteger(b)?g=-1<b+-1?"float":"integer":k.isDate(b)?g="date":k.isFloat(b)&&(g="float");l.push({dataType:d?d:g,dataIndx:a,title:c?c:a,width:e?e:100})});a.colModel=l};a._calcThisColModel=function(){var a=this.options,b=a.columnTemplate,d=
a.colModel;d||(this._autoGenColumns(),d=a.colModel);a=this.nestedCols(d);this.colModel=a.colModel;this.depth=a.depth;a=this.colModel;d=a.length;if(b)for(var c=0;c<d;c++){var e=a[c],k=f.extend({},b,e,!0);f.extend(e,k,!0)}this.getHeadersCells();this.assignRowSpan();this._refreshDataIndices()};a._createHeader=function(){this.iHeader.createHeader()};a.createTable=function(a){a.other=!0;this.iGenerateView.generateView(a)};f.widget("paramquery._pqGrid",f.ui.mouse,a)})(jQuery);
(function(f){function m(a){this.that=a}function h(a,b,d){for(var c=0;b<d;b++)!0!==a[b].hidden&&c++;return c}function c(a){if(a.length)var b=a.css({tableLayout:"auto",width:""}).addClass("pq-no-wrap").removeClass("pq-wrap").children("tbody").children(".pq-row-hidden").children("td").css("width","");return b||f()}var e=f.paramquery._pqGrid.prototype;e.getHeaderColumnFromTD=function(a){var b=a.attr("pq-col-indx");a=a.attr("pq-row-indx");var d;null!=b&&null!=a&&(b=parseInt(b),a=parseInt(a),d=this.headerCells[a][b]);
var c=!0;if(!d||d.colModel&&d.colModel.length)c=!1;return{column:d,colIndx:b,rowIndx:a,leaf:c}};e.flex=function(a){this.iResizeColumns.flex(a)};f.paramquery.cHeader=m;e=m.prototype;e.createHeader=function(){var a=this.that,b=this,d=a.options,c=d.bootstrap,e=d.hwrap,g=a.pqpanes,q=parseInt(d.freezeCols),p=d.numberCell,v=a.colModel,n=d.sortModel,h=a.depth,m=d.virtualX,t=a.initH,s=a.finalH,y=a.headerCells,x=a.$header_o;if(null==s)throw"finalH required for _createHeader";if(!1===d.showHeader)x.empty().css("display",
"none");else{x.css("display","");d=(c.on?c.thead:"")+" pq-grid-header-table ";e=["<table class='"+(e?d+"pq-wrap ":d+"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(1<=h){e.push("<tr class='pq-row-hidden'>");p.show&&e.push("<td style='width:"+p.width+"px;' ></td>");for(d=0;d<=s;d++){if(d<t&&d>=q&&m&&(d=t,d>s))throw"initH>finalH";c=v[d];c.hidden||e.push("<td style='width:"+c.outerWidth+"px;' pq-col-indx="+d+"></td>")}e.push("</tr>")}for(c=0;c<h;c++){e.push("<tr class='pq-grid-title-row'>");0==
c&&p.show&&e.push(["<th pq-col-indx='-1' class='pq-grid-number-col' rowspan='",h,"'><div class='pq-td-div'>",p.title?p.title:"&nbsp;","</div></th>"].join(""));for(d=0;d<=s;d++){if(d<t&&d>=q&&m&&(d=t,d>s))throw"initH>finalH";b.createHeaderCell(c,d,y,e,"pq-grid-col ",q,t,h,n)}e.push("</tr>")}a.ovCreateHeader(e,"pq-grid-col ");e.push("</table>");q=e.join("");x.empty();x[0].innerHTML=g.vH?["<span class='pq-grid-header pq-grid-header-left ui-state-default'><div class='pq-grid-header-inner'>",q,"</div></span><span class='pq-grid-header ui-state-default'><div class='pq-grid-header-inner'>",
q,"</div></span>"].join(""):["<span class='pq-grid-header ui-state-default'><div class='pq-grid-header-inner'>",q,"</div></span>"].join("");x=a.$header=x.children(".pq-grid-header");q=x.children(".pq-grid-header-inner");a.$tbl_header=q.children("table");a.$header_left=f(x[0]);a.$header_left_inner=f(q[0]);g.vH&&(a.$header_right=f(x[1]),a.$header_right_inner=f(q[1]));x.click(function(a){return b._onHeaderClick(a)});b._refreshResizeColumn(t,s,v);a._trigger("refreshHeader",null,null)}};e._onHeaderClick=
function(a){var b=this.that;if(!b.iDragColumns||"stop"==b.iDragColumns.status){var d=f(a.target).closest(".pq-grid-col");if(d.length&&(a.stopImmediatePropagation(),d=b.getHeaderColumnFromTD(d),b=d.colIndx,!1!=d.leaf))return this._onHeaderCellClick(b,a)}};e.createHeaderCell=function(a,b,d,c,e,g,f,p,v){var n=d[a][b],m=this.that.colModel,r=n.colSpan;if(!(n.hidden||0<a&&n==d[a-1][b])){if(0<b&&n==d[a][b-1]){if(b>f)return;a:{d=d[a];for(var t=0;t<d.length;t++)if(d[t]==n){d=t;break a}d=void 0}if(d<g)return;
r-=h(m,d,b)}else g&&b<g&&b+r>g&&(r-=h(m,g,f),m=h(m,b,g),r=Math.max(r,m));d=n.halign;t=n.align;m=n.title;m="function"==typeof m?m({column:n,colIndx:b}):m;m=null!=m?m:"";n.pqtitle=m;null!=d?e+=" pq-align-"+d:null!=t&&(e+=" pq-align-"+t);b==g-1&&1==p&&(e+=" pq-last-frozen-col");b<=g-1?e+=" pq-left-col":b>=f&&(e+=" pq-right-col");(g=n.cls)&&(e=e+" "+g);if(null==n.colModel||0==n.colModel.length)e+=" pq-grid-col-leaf";g=v.space?"pq-space":"";c.push(["<th  ","pq-col-indx="+b," ","pq-row-indx="+a,"  class='",
e,"' rowspan=",n.rowSpan," colspan=",r,"><div class='pq-td-div'>",m,"<span class='pq-col-sort-icon ",g,"'></span>",v.number?"<span class='pq-col-sort-count "+g+"'></span>":"","</div></th>"].join(""))}};e._onHeaderCellClick=function(a,b){var d=this.that,c=d.colModel[a],e=d.options,g=c.dataIndx;!1!==d._trigger("headerCellClick",b,{column:c,colIndx:a,dataIndx:g})&&e.sortModel.on&&!1!=c.sortable&&d.sort({sorter:[{dataIndx:g}],addon:!0,evt:b})};e._refreshResizeColumn=function(a,b,d){var c=this.that,e=
c.options,g=e.filterModel.ficon?!0:!1,f=e.numberCell,e=parseInt(e.freezeCols),p=[],h=[],n=c.pqpanes.vH,m=0,r=0;f.show&&(m=f.outerWidth,f.resizable&&p.push("<div pq-col-indx='-1' style='left:",m-5,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>"));for(f=0;f<=b;f++){if(f<a&&f>=e&&(f=a,f>b))throw"initH>finalH";r=d[f];if(!r.hidden){var t=r.ficon,s=t||null==t&&g,t=p,m=m+r.outerWidth;if(!1!==r.resizable||s)n&&f>=e&&(t=h),r=m-5,t.push("<div pq-col-indx='",f,"' style='left:",r,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>")}}h.length&&
c.$header_right_inner.append(h.join(""));c.$header_left_inner.append(p.join(""))};e.refreshHeaderSortIcons=function(){var a=this.that,b=a.$header;if(b){var d=a.iSort.getSorter(),c=d.length,e=!1,g=a.options.sortModel;b.find(".pq-grid-col-leaf").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active active");b.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");g.number&&1<c&&(e=!0);for(g=0;g<c;g++){var f=d[g],p=a.getColIndx({dataIndx:f.dataIndx}),h=f.dir,
f="active ui-state-active pq-col-sort-"+("up"==h?"asc":"desc"),h="ui-icon ui-icon-triangle-1-"+("up"==h?"n":"s")+" glyphicon glyphicon-arrow-"+h,p=b.find(".pq-grid-col-leaf[pq-col-indx="+p+"]");p.addClass(f);p.find(".pq-col-sort-icon").addClass(h);e&&p.find(".pq-col-sort-count").html(g+1)}}};e=function(a){this.that=a;var b=this;a.$header_o.on({mousedown:function(a){if(!a.pq_composed){var d=f(a.target);b.setDraggables(a);a.pq_composed=!0;a=f.Event("mousedown",a);d.trigger(a)}},dblclick:function(a){b.doubleClick(a)}},
".pq-grid-col-resize-handle");var d=a.options.flex;if(d.on&&d.one){var c=a.widgetEventPrefix.toLowerCase(),e=a.eventNamespace;a.element.one(c+"dataready"+e,function(){f(this).one(c+"refresh"+e,function(a){b.belongs(a)&&b.flex()})})}};f.paramquery.cResizeColumns=e;e=e.prototype=new f.paramquery.cClass;e.doubleClick=function(a){var b=this.that.options,d=b.flex;a=f(a.target);a=parseInt(a.attr("pq-col-indx"));isNaN(a)||d.on&&this.flex(d.all&&!b.scrollModel.autoFit?{}:{colIndx:[a]})};e.flex=function(a){a=
a||{};var b=this.that,d=b.options,e=b.element,l=d.virtualX,g=d.freezeCols,q=d.numberCell,d=a.colIndx,p,h=a.dataIndx;a=null==a.refresh?!0:a.refresh;var n=b.initH,m=b.finalH,r=!1,t=b.colModel,s=b.$tbl,y=b.$tbl_header,x=s&&s.length?f(s[0]).clone():f(),w=b.tables&&b.tables.length?b.tables[0].$tbl:null,w=w?f(w[0]).clone():f(),A=y&&y.length?f(y[0]).clone():f();if(null!=h)for(d=[],y=0,s=h.length;y<s;y++){var z=b.colIndxs[h[y]];null!=z&&d.push(z)}null!=d&&(d.sort(function(a,b){return a-b}),p=d.length);A.find("tr.pq-grid-header-search-row").remove();
h=c(x);s=c(w);z=c(A);x=f("<div class='pq-grid' style='width:1px;height:1px;position:absolute;left:0px;top:0px;'>").append(A).append(w).append(x);x.addClass(e.attr("class"));e.parent().append(x);e=q.show?0:-1;for(y=0;y<=m;y++)if(l&&y<n&&y>=g&&(y=n),q=t[y],!q.hidden){e++;if(d)if(d.length)if(d[0]===y)d.splice(0,1);else continue;else break;var w=h[e],A=z[e],F=s[e],w=Math.max(w?w.offsetWidth:0,F?F.offsetWidth:0,A?A.offsetWidth:0)-0+1;q._width!==w&&(r=!0,q.width=w,1===p&&(q._resized=!0))}x.remove();r&&
a&&b.refresh({source:"flex"})};e.setDraggables=function(a){var b=this,d,c,e;f(a.target).draggable({axis:"x",helper:function(a,d){var c=f(a.target),e=parseInt(c.attr("pq-col-indx"));b._setDragLimits(e);b._getDragHelper(a,d);return c},start:function(a,c){d=c.position.left;e=parseInt(b.$cl[0].style.left)},drag:function(a,f){c=f.position.left;b.$cl[0].style.left=e+(c-d)+"px"},stop:function(a,c){return b.resizeStop(a,c,d)}})};e._getDragHelper=function(a){var b=this.that,d=parseInt(b.options.freezeCols);
a=f(a.target);var c=b.$grid_center;a=parseInt(a.attr("pq-col-indx"));var e=c.outerHeight();this.$cl=f("<div class='pq-grid-drag-bar'></div>").appendTo(c);this.$clleft=f("<div class='pq-grid-drag-bar'></div>").appendTo(c);this.$cl.height(e);this.$clleft.height(e);c=f("[pq-col-indx="+a+"]",b.$header)[0];e=c.offsetLeft;b.pqpanes.vH?a>=d&&(e-=b.$header[1].scrollLeft):(e+=b.$header[0].offsetLeft,e-=b.$header[0].scrollLeft);this.$clleft.css({left:e});e+=c.offsetWidth;this.$cl.css({left:e})};e._setDragLimits=
function(a){if(!(0>a)){var b=this.that,d=b.colModel[a],c=b.$header_left;a>=b.options.freezeCols&&b.pqpanes.vH&&(c=b.$header_right);b=c.find("th[pq-col-indx='"+a+"']").offset().left+d._minWidth;d=b+d._maxWidth-d._minWidth;c.find("div.pq-grid-col-resize-handle[pq-col-indx="+a+"]").draggable("option","containment",[b,0,d,0])}};e.resizeStop=function(a,b,d){var c=this.that,e=c.colModel,g=c.options.numberCell;this.$clleft.remove();this.$cl.remove();d=b.position.left-d;b=f(b.helper);b=parseInt(b.attr("pq-col-indx"));
if(-1==b){var e=null,q=parseInt(g.width);g.width=q+d}else e=e[b],q=parseInt(e.width),e.width=q+d,e._resized=!0;c.refresh();c._trigger("columnResize",a,{colIndx:b,column:e,dataIndx:e?e.dataIndx:null,oldWidth:q,newWidth:e?e.width:g.width})};e=function(a){this.that=a;this.$drag_helper=null;var b=a.options.dragColumns,d=b.topIcon,c=b.bottomIcon,e=this;this.status="stop";this.$arrowTop=f("<div class='pq-arrow-down ui-icon "+d+"'></div>").appendTo(a.element);this.$arrowBottom=f("<div class='pq-arrow-up ui-icon "+
c+"' ></div>").appendTo(a.element);this.hideArrows();if(b&&b.enabled)a.$header_o.on("mousedown",".pq-grid-col",function(a,b){if(!f(a.target).is("input,select,textarea")&&!a.pq_composed){e.setDraggables(a,b);a.pq_composed=!0;var d=f.Event("mousedown",a);f(a.target).trigger(d)}})};f.paramquery.cDragColumns=e;e=e.prototype;e.showFeedback=function(a,b){var d=this.that,c=a[0],e=d.$grid_center[0].offsetTop,g=c.offsetLeft-c.offsetParent.offsetParent.offsetParent.scrollLeft+(b?0:c.offsetWidth)-8,d=e+d.$header[0].offsetHeight;
this.$arrowTop.css({left:g,top:e+c.offsetTop-16,display:""});this.$arrowBottom.css({left:g,top:d,display:""})};e.showArrows=function(){this.$arrowTop.show();this.$arrowBottom.show()};e.hideArrows=function(){this.$arrowTop.hide();this.$arrowBottom.hide()};e.updateDragHelper=function(a){var b=this.that.options.dragColumns,d=b.acceptIcon,b=b.rejectIcon,c=this.$drag_helper;c&&(a?(c.children("span.pq-drag-icon").addClass(d).removeClass(b),c.removeClass("ui-state-error")):(c.children("span.pq-drag-icon").removeClass(d).addClass(b),
c.addClass("ui-state-error")))};e.setDraggables=function(a,b){var d=f(a.currentTarget),c=this.that,e=c.options.dragColumns.rejectIcon,g=this;d.hasClass("ui-draggable")||!1!==c.getHeaderColumnFromTD(d).leaf&&d.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:c.element,revert:"invalid",helper:function(){var a=f(this);g.status="helper";g.setDroppables(a);c.$header.find(".pq-grid-col-resize-handle").hide();var b=a.attr("pq-col-indx"),d=a.attr("pq-row-indx");a.droppable("destroy");
a=f("<div class='pq-col-drag-helper ui-widget-content ui-corner-all panel panel-default' ><span class='pq-drag-icon ui-icon "+e+" glyphicon glyphicon-remove'></span>"+c.headerCells[d][b].pqtitle+"</div>");g.$drag_helper=a;return a[0]},drag:function(a,b){g.status="drag";var d=f(".pq-drop-hover",c.$header);if(0<d.length){g.showArrows();g.updateDragHelper(!0);var e=d.width();a.clientX-d.offset().left+f(document).scrollLeft()<e/2?(g.leftDrop=!0,g.showFeedback(d,!0)):(g.leftDrop=!1,g.showFeedback(d,!1))}else g.hideArrows(),
c.$toolbar.hasClass("pq-drop-hover")?g.updateDragHelper(!0):g.updateDragHelper()},stop:function(a,b){g.status="stop";c.$header.find(".pq-grid-col-resize-handle").show();g.hideArrows()}})};e._columnIndexOf=function(a,b){for(var d=0,c=a.length;d<c;d++)if(a[d]==b)return d;return-1};e.setDroppables=function(a){var b=this.that,d=this,c={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(a,c){if(!d.dropPending){var e=parseInt(c.draggable.attr("pq-col-indx")),k=parseInt(c.draggable.attr("pq-row-indx")),
l=f(this),h=parseInt(l.attr("pq-col-indx")),m=parseInt(l.attr("pq-row-indx")),t=b.options.colModel,s=b.headerCells,y=1<s.length,l=s[m][h],x=k?s[k-1][e].colModel:t,h=m?s[m-1][h].colModel:t,k=d._columnIndexOf(x,s[k][e]),s=d.leftDrop?1:0,w=x.splice(k,1)[0],A=d._columnIndexOf(h,l)+1-s;h.splice(A,0,w);d.dropPending=!0;window.setTimeout(function(){b._calcThisColModel();!1!==b._trigger("columnOrder",null,{dataIndx:w.dataIndx,column:w,oldcolIndx:e,colIndx:y?b.getColIndx({column:w}):A})&&b.refresh();d.dropPending=
!1},0)}}};a=b.$header_left.find(".pq-left-col");var e=b.pqpanes.v||b.pqpanes.vH?b.$header_right.find(".pq-right-col"):b.$header_left.find(".pq-right-col");a=a.add(e);a.each(function(a,b){var d=f(b);d.hasClass("ui-droppable")||d.droppable(c)})}})(jQuery);
(function(f){function m(c){var e=this;this.that=c;this.type="detail";this.refreshComplete=!0;this.detachView=!1;var a=c.widgetEventPrefix.toLowerCase(),b=c.eventNamespace;c.element.on(a+"cellclick"+b,function(a,b){if(e.belongs(a))return e.toggle(a,b)}).on(a+"cellkeydown"+b,function(a,b){if(e.belongs(a)&&a.keyCode==f.ui.keyCode.ENTER)return e.toggle(a,b)}).on(a+"refresh"+b,function(a,b){if(e.belongs(a))return e.aftertable()}).on(a+"beforetableview"+b,function(a,b){if(e.belongs(a))return e.beforeTableView(a,
b)}).on(a+"tablewidthchange"+b,function(a,b){if(e.belongs(a))return e.tableWidthChange(a,b)})}f.paramquery.cHierarchy=m;var h=m.prototype=new f.paramquery.cClass;h.tableWidthChange=function(){if(this.refreshComplete){this.refreshComplete=!1;for(var c=this.that.$tbl.children("tbody").children("tr.pq-detail-child").children("td.pq-detail-child"),e=0,a=c.length;e<a;e++)for(var b=f(c[e]).find(".pq-grid"),d=0,k=b.length;d<k;d++){var l=f(b[d]);l.is(":visible")&&l.pqGrid("onWindowResize")}this.refreshComplete=
!0}};h.aftertable=function(c){var e=this.that,a=e.options.detailModel.init,b=e.pdata;if(this.refreshComplete){this.refreshComplete=!1;c=c?c:e.$tbl.children("tbody").children("tr.pq-detail-child");for(var d=0,k=c.length;d<k;d++){var l=f(c[d]),g=l.attr("pq-row-indx"),q=b[g],g=!1,p=q.pq_detail.child;p||"function"!=typeof a||(g=!0,p=a.call(e.element[0],{rowData:q}),q.pq_detail.child=p,q.pq_detail.height=25);l=l.children("td.pq-detail-child");l.append(p);l=l.find(".pq-grid");p=0;for(q=l.length;p<q;p++){var h=
f(l[p]);g?h.hasClass("pq-pending-refresh")&&h.is(":visible")&&(h.removeClass("pq-pending-refresh"),h.pqGrid("refresh")):h.is(":visible")&&h.pqGrid("onWindowResize")}}this.refreshComplete=!0;this.detachView=!1}};h.beforeTableView=function(c,e){this.detachView||(this.detachInitView(),this.detachView=!0)};h.detachInitView=function(c){var e=this.that.$tbl;if(e&&e.length)for(c=c?c:e.children("tbody").children("tr.pq-detail-child"),e=0;e<c.length;e++)f(c[e]).children("td.pq-detail-child").children().detach()};
h.toggle=function(c,e){var a=this.that,b=e.column,d=e.rowData,k=e.rowIndx,l=this.type;b&&b.type===l&&(b={rowIndx:k,focus:!0},null==d.pq_detail?a.rowExpand(b):!1===d.pq_detail.show?a.rowExpand(b):this.rowCollapse(b))};h.rowExpand=function(c){this.normalize(c);var e=this.that,a=c.rowData,b=c.rowIndx,d=c.rowIndxPage,k=e.options.detailModel;if(null!=a){if(!1===e._trigger("beforeRowExpand",null,c))return!1;null==a.pq_detail?a.pq_detail={show:!0}:!1===a.pq_detail.show&&(a.pq_detail.show=!0);k.cache||this.rowInvalidate(c);
e.refreshRow({rowIndx:b});k=[];e.iGenerateView._generateDetailRow(a,d,e.colModel,k,null,!1);a=e.getRow({rowIndxPage:d});a.after(k.join(""));this.aftertable(a.next());c.focus&&e.getCell({rowIndx:b,dataIndx:"pq_detail"}).attr("tabindex","0").focus();c.scrollRow&&this.scrollRow({rowIndx:b})}};h.rowInvalidate=function(c){c=this.that.getRowData(c);var e=c.pq_detail;if(e=e?e.child:null)e.remove(),c.pq_detail.child=null,c.pq_detail.height=0};h.normalize=function(c){var e=this.that,a=c.rowIndx,b=c.rowIndxPage,
d=e.rowIndxOffset;c.rowIndx=null==a?b+d:a;c.rowIndxPage=null==b?a-d:b;c.rowData=e.getRowData(c)};h.rowCollapse=function(c){this.normalize(c);var e=this.that,a=e.options,b=c.rowData,d=c.rowIndx,k=c.rowIndxPage,l=a.detailModel;null!=b&&null!=b.pq_detail&&!0===b.pq_detail.show&&(l.cache||this.rowInvalidate(c),b.pq_detail.show=!1,a.virtualY?e.refresh():(a=e.getRow({rowIndxPage:k}).next("tr.pq-detail-child"),a.length&&(this.detachInitView(a),a.remove(),e.refreshRow({rowIndx:d})),c.focus&&e.getCell({rowIndx:d,
dataIndx:"pq_detail"}).attr("tabindex","0").focus()),c.scrollRow&&(d=c.rowIndx,this.scrollRow({rowIndx:d})))}})(jQuery);
(function(f){var m=f.paramquery.pqgrid.calcWidthCols,h=function(c){this.that=c};f.paramquery.cRefresh=h;h=h.prototype;h._computeOuterWidths=function(){for(var c=this.that,e=c.options.numberCell,c=c.colModel,a=c.length,b=0;b<a;b++){var d=c[b];d.outerWidth=d._width+0}e.show&&(e.outerWidth=e.width)};h.autoFit=function(){var c=this.that,e=c.colModel,a=e.length,c=m.call(c,-1,a,!0),b=this.contWd-this.getSBWidth();if(c!==b){for(var c=c-b,d,b=[],k=0;k<a;k++){var l=e[k],g=l._percent,f=l._resized;l.hidden||
g||f||(0>c?(g=l._maxWidth-l._width)&&b.push({availWd:-1*g,colIndx:k}):(g=l._width-l._minWidth)&&b.push({availWd:g,colIndx:k}));f&&(d=l,delete l._resized)}b.sort(function(a,b){return a.availWd>b.availWd?1:a.availWd<b.availWd?-1:0});k=0;for(a=b.length;k<a;k++){var l=b[k],g=l.availWd,l=l.colIndx,f=Math.round(c/(a-k)),l=e[l],p;p=l._width;Math.abs(g)>Math.abs(f)?(p-=f,c-=f):(p-=g,c-=g);l.width=l._width=p}0!=c&&d&&(p=d._width-c,p>d._maxWidth?p=d._maxWidth:p<d._minWidth&&(p=d._minWidth),d.width=d._width=
p)}};h.autoLastColumn=function(){var c=this.that,e=c.colModel,a=e.length,b=c.options.freezeCols,d=this.contWd-this.getSBWidth(),k=m.call(c,-1,b,!0),d=d-k,k=!1,c=c._getLastVisibleColIndx();if(null!=c&&(c=e[c],!c._percent)){for(var l=c._width,g,f=c._minWidth,p=c._maxWidth,a=a-1;a>=b;a--){var h=e[a];if(!h.hidden&&(h=h._width+0,d-=h,0>d)){k=!0;g=l+d>=f?l+d:l+h+d;break}}k||(g=l+d);g>p?g=p:g<f&&(g=f);c.width=c._width=g}};h.numericVal=function(c,e){var a;a=-1<(c+"").indexOf("%")?parseInt(c)*e/100:parseInt(c);
return Math.round(a)};h.refreshColumnWidths=function(c){c=c||{};var e=this.that,a=e.options,b=a.numberCell,d="flex"===a.width,k=e.colModel,l=a.scrollModel,g=l.lastColumn,l=l.autoFit,f=this.contWd,p=k.length,h=this.getSBWidth(),n=a._minColWidth,m=a._maxColWidth,r=0;b.show&&(b.width<b.minWidth&&(b.width=b.minWidth),b.outerWidth=b.width+1,r=b.outerWidth);b=d?null:f-h-r;n=Math.floor(this.numericVal(n,b));m=Math.ceil(this.numericVal(m,b));f=0;if(!d&&5>b||isNaN(b)){if(a.debug)throw"availWidth N/A";}else{delete e.percentColumn;
for(h=0;h<p;h++)if(r=k[h],!r.hidden){var t=r.width,s=-1<(t+"").indexOf("%")?!0:null,y=r.minWidth,x=r.maxWidth,y=y?this.numericVal(y,b):n,x=x?this.numericVal(x,b):m;x<y&&(x=y);if(void 0!=t){var w=0;!d&&s?(e.percentColumn=!0,r.resizable=!1,r._percent=!0,t=this.numericVal(t,b)-0,w=Math.floor(t),f+=t-w,1<=f&&(w+=1,f-=1)):t&&(w=parseInt(t));w<y?w=y:!d&&w>x&&(w=x);r._width=w}else r._width=y;s||(r.width=r._width);r._minWidth=y;r._maxWidth=d?1E3:x}!1===d&&!1!==c.refreshWidth&&(l&&this.autoFit(),"auto"===
g&&a.virtualX&&this.autoLastColumn());this._computeOuterWidths()}};h.estRowsInViewPort=function(){var c=Math.ceil(this.contHt/this.rowHt);return this.that.pageSize=c};h._refreshFrozenLine=function(){};h._refreshHideArrHS=function(){for(var c=this.that,e=c.colModel,a=c.hidearrHS,b=c.initH,d=c.finalH,k=parseInt(c.options.freezeCols),c=0;c<k;c++)a[c]=!1;for(c=k;c<b;c++)a[c]=!0;for(c=b;c<=d;c++)a[c]=!1;c=d+1;for(e=e.length;c<e;c++)a[c]=!0};h.setScrollVNumEles=function(c){var e=this.that;c=e.$vscroll;
var a=e.options;if(!a.maxHeight&&"flex"===a.height)return c.pqScrollBar("option","num_eles",0),0;var b=e.iHierarchy?!0:!1,d=c.pqScrollBar("option"),k=parseInt(d.num_eles),d=parseInt(d.cur_pos),k=this.getSBHeight(),k=this.contHt-k+1,a=(a.groupModel?e.dataGM:e.pdata)?e.totalVisibleRows:0,l,g=0;e.$tbl&&0<e.$tbl.length&&(l=e.$tbl[e.$tbl.length-1],g=l.scrollHeight,l=f(l));if(0<g){l=l.children().children("tr");for(g=d=e=0;g<l.length;g++){var q=l[g],e=e+q.offsetHeight;if(e>=k){b&&f(q).hasClass("pq-detail-child")?
(d--,d=1<d?d-1:1):d=1<d?d-1:0;break}else b?!1===f(q).hasClass("pq-detail-child")&&d++:d++}k=a-d+1}else k=d+1;k>a&&(k=a);c.pqScrollBar("option","num_eles",k);return k};h._setScrollVLength=function(c){c=this.that;var e=c.options;if("flex"!==e.height||e.maxHeight){var e=this.getSBHeight(),a=this.contHt-e+this.headerHt-2;c.$vscroll.css("bottom",e).pqScrollBar("option","length",a)}};h.setHeaderHeight=function(){var c=this.that,e=c.$header,a,b,d;if(e&&e.length){if(1<e.length){if(a=e[0].offsetHeight,b=e[1].offsetHeight,
d=Math.max(a,b),a!==b){var k=f(e[0]).find(".pq-grid-header-search-row"),l=f(e[1]).find(".pq-grid-header-search-row");k.css("height","");l.css("height","");a=e[0].offsetHeight;b=e[1].offsetHeight;d=Math.max(a,b);a<d?k.height(l[0].offsetHeight):l.height(k[0].offsetHeight)}}else d=a=e[0].offsetHeight;c.$header_o.height(d-2);this.headerHt=d}else c.$header_o.height(0),this.headerHt=0};h.initContHeight=function(){var c=this.that,e=c.options;if("flex"!=e.height||e.maxHeight)this.contHt=this.height-(e.showHeader?
this.rowHt:0)-(e.showTop?c.$top[0].offsetHeight:0)-(e.showBottom?c.$bottom[0].offsetHeight:0)};h.initContWidth=function(){var c=this.that.options;if("flex"!==c.width||c.maxWidth)this.contWd=this.width};h.setContHeight=function(c){c=this.that;var e=this.height-c.$header_o[0].offsetHeight-(c.options.showTop?c.$top[0].offsetHeight:0)-c.$bottom[0].offsetHeight;c.$cont.height(e);this.contHt=e};h.setContAndGridHeightForFlex=function(){var c=this.that;if(this.vscroll)c.$hscroll.css("position","");else{c.$hscroll.css("position",
"relative");var e=c.$cont,a=c.options.cls,b=e.children("."+a.cont_inner_b);e.height("");b.length||(b=e.children("."+a.cont_inner));b.height("");c.element.height("");c.$grid_center.height("")}};h.setContAndGridWidthFromTable=function(){var c=this.that,e=m.call(c,-1,c.colModel.length),c=c.element,a=this.getSBWidth();this.contWd=e+a;c.width(this.contWd+"px")};h.getTotalVisibleRows=function(c,e,a){var b=this.that,d=this.estRowsInViewPort(),k=0,l=a?a.length:0,g=e,f=0,p=0,h=null,n=!1,m=!1,r=b.iHierarchy?
!0:!1,b=b.options,t=b.detailModel.offset,s=0,y=this.rowHt,x=r?this.contHt:void 0;if(null==a||0==l)return{initV:null,finalV:null,tvRows:k,lastFrozenRow:null};for(var w=0,A=l>e?e:l;w<A;w++){var z=a[w],F=z.pq_hidden;F||(h=w,k++,r&&((z=z.pq_detail)&&z.show?(z=z.height||0,z>t&&(z=t),s+=z+y):s+=y))}if(l<e)return{initV:h,finalV:h,tvRows:k,lastFrozenRow:h};if(1E4<l&&null==b.groupModel)return f=c+d,f>=l&&(f=l-1),{initV:c+e,finalV:f,tvRows:l,lastFrozenRow:h};d-=k;w=e;for(A=l;w<A;w++)z=a[w],F=z.pq_hidden,n?
m||(F?f++:p===d?m=!0:(f++,p++)):F?g++:p===c?(n=!0,f=g,p=0):(g++,p++),F||(k++,r&&n&&((z=z.pq_detail)&&z.show?(z=z.height||0,z>t&&(z=t),s+=z+y):s+=y,s>x&&(m=!0)));g>=l&&(g=l-1);f<g&&(f=g);return{initV:g,finalV:f,tvRows:k,lastFrozenRow:h}};h.calcInitFinal=function(){var c=this.that,e=c.options,a=e.virtualY,b=e.freezeRows,d="flex"===e.height,k=e.groupModel?c.dataGM:c.pdata;if(null==k||0===k.length)b=this.getTotalVisibleRows(l,b,k),c.totalVisibleRows=b.tvRows,c.initV=b.initV,c.finalV=b.finalV,c.lastFrozenRow=
b.lastFrozenRow;else if(a){var a=c.$vscroll.pqScrollBar("option"),l=parseInt(a.cur_pos);if(isNaN(l)||0>l)throw"cur_pos NA";c.scrollCurPos=l;b=this.getTotalVisibleRows(l,b,k);c.totalVisibleRows=b.tvRows;c.initV=b.initV;c.lastFrozenRow=b.lastFrozenRow;c.finalV=d&&!e.maxHeight?k.length-1:b.finalV}else b=this.getTotalVisibleRows(0,b,k),c.lastFrozenRow=b.lastFrozenRow,c.totalVisibleRows=b.tvRows,c.initV=0,c.finalV=k.length-1};h.calcInitFinalH=function(){var c=this.that,e=c.options,a=e.virtualX,b=c.colModel,
d=b.length;if(a){for(var k=parseInt(c.$hscroll.pqScrollBar("option","cur_pos")),l=parseInt(e.freezeCols),g="flex"===e.width,f=l,p=0,h=l;h<d;h++)if(b[h].hidden)f++;else if(p===k)break;else f++,p++;f>d-1&&(f=d-1);c.initH=f;if(g||!a)c.finalH=d-1;else{a=m.call(c,-1,l);k=this.getEContWd();for(h=f;h<d;h++)if(f=b[h],!f.hidden){f=f.outerWidth;if(!f&&e.debug)throw"outerwidth N/A";a+=f;if(a>k)break}e=h;e>d-1&&(e=d-1);c.finalH=e}}else c.initH=0,c.finalH=d-1};h._calcOffset=function(c){return(c=/(-|\+)([0-9]+)/.exec(c))&&
3===c.length?parseInt(c[1]+c[2]):0};h.setMax=function(c){var e=this.that,a=e.element;(e=e.options[c])?(e==parseInt(e)&&(e+="px"),a.css(c,e)):a.css(c,"")};h.refreshGridWidthAndHeight=function(){var c=this.that,e=c.options,a,b,d=-1<(e.width+"").indexOf("%")?!0:!1,k=-1<(e.height+"").indexOf("%")?!0:!1,l=-1<(e.maxHeight+"").indexOf("%")?!0:!1,g="flex"==e.height,q=l&&g,p=-1<(e.maxWidth+"").indexOf("%")?!0:!1,h="flex"==e.width,n=p&&h,c=c.element;if(d||k||q||n){var m=c.parent();if(!m.length)return;var r;
m[0]==document.body||"fixed"==c.css("position")?(r=f(window).width(),m=window.innerHeight?window.innerHeight:f(window).height()):(r=m.width(),m=m.height());var t=this._calcOffset,s=d?t(e.width):0,t=k?t(e.height):0;n?a=parseInt(e.maxWidth)*r/100:d&&(a=parseInt(e.width)*r/100+s);q?b=parseInt(e.maxHeight)*m/100:k&&(b=parseInt(e.height)*m/100+t)}a||(h&&e.maxWidth?p||(a=e.maxWidth):d||(a=e.width));b||(g&&e.maxHeight?l||(b=e.maxHeight):k||(b=e.height));parseFloat(a)==a?(a=a<e.minWidth?e.minWidth:a,c.css("width",
a)):"auto"===a&&c.width(a);parseFloat(b)==b&&(b=b<e.minHeight?e.minHeight:b,c.css("height",b));this.width=Math.round(c.width());this.height=Math.round(c.height())};h.decidePanes=function(){var c=this.that,e=c.pqpanes={v:!1,h:!1,vH:!1},a=c.options,c=a.virtualX,b=a.virtualY,d="flex"==a.height&&!a.maxHeight,k="flex"==a.width&&!a.maxWidth,l=a.numberCell,g=a.freezeRows,a=a.freezeCols;!g||d||!a&&!l.show||k?g&&!d?b||(e.h=!0):!a&&!l.show||k||c||(e.v=!0,e.vH=!0):(b||(e.h=!0),c||(e.v=!0,e.vH=!0))};h._storeColumnWidths=
function(c){var e=this.that,a=e.colModel,b=c?a.length-1:e.finalH,d=[];for(c=c?0:e.initH;c<=b;c++)d[c]={outerWidth:a[c].outerWidth};return d};h._isColumnWidthChanged=function(c){for(var e=this.that,a=e.colModel,b=e.options,d=b.virtualX,b=b.freezeCols,k=e.initH,e=e.finalH,l=0;l<=e;l++)if(d&&l<k&&l>=b&&(l=k),a[l].outerWidth!==c[l].outerWidth)return!0;return!1};h.softRefresh=function(){var c=this.that,e=c.options;this.refreshScrollbars();c.iGenerateView.setPanes();c._saveDims();c.iMouseSelection.syncScrollBarVert();
"flex"==e.height&&this.setContAndGridHeightForFlex();"flex"==e.width&&this.setContAndGridWidthFromTable();this._refreshFrozenLine()};h.refreshScrollbars=function(c){c=c||{};var e=this.that,a=e.options,b="flex"===a.height,d="flex"===a.width;if((b||this.contHt)&&(d||this.contWd)&&null!==e.totalVisibleRows){var k=this.setScrollVNumEles(c),k=1<k?!0:!1;if((!b||a.maxHeight)&&k!==this.vscroll)if(this.vscroll=k,a.scrollModel.autoFit||a.virtualX||d){if(a=this._storeColumnWidths(),this.refreshColumnWidths(),
this._isColumnWidthChanged(a)||d)this.ignoreTResize=!0,this._refreshTableWidths(a,{table:!0,header:!0}),delete this.ignoreTResize,this.setHeaderHeight(),this.setContHeight(),e.iGenerateView.setPanes(),k=this.setScrollVNumEles(!0),this.vscroll=1<k?!0:!1}else e.iGenerateView.setPanes();k=this.setScrollHNumEles();this.hscroll=1<k?!0:!1;this._setScrollHLength();this._setScrollVLength(c);this._setScrollHVLength()}};h._setScrollHVLength=function(){var c=this.that;this.vscroll&&this.hscroll||c.$hvscroll.css("visibility",
"hidden")};h._setScrollHLength=function(){var c=this.that,e=c.$hscroll,a=c.$hvscroll;c.options.scrollModel.horizontal?(e.css("visibility",""),a.css("visibility",""),c=this.contWd,a=this.getSBWidth(),e.css("right",0===a?0:""),e.pqScrollBar("option","length",c-a)):(e.css("visibility","hidden"),a.css("visibility","hidden"))};h.estVscroll=function(){var c=this.that,e=!0;null==c.totalVisibleRows||null==this.contHt?e=!1:c.totalVisibleRows*this.rowHt<this.contHt&&(e=!1);this.vscroll=e};h.getSBWidth=function(){null==
this.vscroll&&this.estVscroll();return this.vscroll?17:0};h.estHscroll=function(){var c=this.that;if(null==this.contWd)throw"failed";var e=!1;1<this.calcColsOutsideCont(c.colModel)+1&&(e=!0);this.hscroll=e};h.getSBHeight=function(){if("flex"===this.that.options.width)return 0;null==this.hscroll&&this.estHscroll();return this.hscroll?17:0};h.getEContHt=function(){if(null==this.contHt)throw"contHt N/A";return this.contHt-this.getSBHeight()};h.getEContWd=function(){if(null==this.contWd)throw"contWd N/A";
return this.contWd-this.getSBWidth()};h.calcColsOutsideCont=function(c){var e=this.that.options,a=e.numberCell,e=e.freezeCols,b=this.contWd-this.getSBWidth(),d=0;a.show&&(d+=a.outerWidth);for(a=0;a<c.length;a++){var k=c[a];k.hidden||(d+=k.outerWidth)}var l=0,g=0,k=Math.round(d);k>b&&g++;for(a=e;a<c.length;a++)if(k=c[a],!k.hidden)if(l+=k.outerWidth,k=d-l,k>b)g++;else break;return g};h.setScrollHNumEles=function(){var c=this.that,e=c.options,a=c.colModel,b=e.scrollModel,d=0;if("flex"!==e.width||e.maxWidth)d=
"fullScroll"===b.lastColumn?a.length-e.freezeCols-c._calcNumHiddenUnFrozens():this.calcColsOutsideCont(a)+1;c.$hscroll.pqScrollBar("option","num_eles",d);return d};h.init=function(){var c=this.that,e=c.options;this.hscroll=this.vscroll=this.contHt=this.contWd=null;c.initH=c.initV=c.finalH=c.finalV=null;c.totalVisibleRows=c.lastFrozenRow=null;this.rowHt=e.rowHeight;this.headerHt=0;this.height=null};h.refresh=function(c){c=c||{};var e=this.that,a=c.header,b=c.table,d=c.pager,k=e.iGenerateView,l=e.element;
if(l[0].offsetWidth){e.iMouseSelection.resetMargins();this.init();l=e.options;this.decidePanes();l.collapsible._collapsed=!1;this.setMax("maxHeight");this.refreshGridWidthAndHeight();this.initContHeight();this.initContWidth();this.calcInitFinal();if(!1===a||!1===b)var g=this._storeColumnWidths(!0);this.refreshColumnWidths();this.calcInitFinalH();this._refreshHideArrHS();!1!==a?e._createHeader():this._isColumnWidthChanged(g)&&this._refreshTableWidths(g,{header:!0});e._refreshHeaderSortIcons();!1!==
d&&e._refreshPager();this.setHeaderHeight();this.setContHeight();!1!==b?k.generateView({source:c.source}):(this._refreshTableWidths(g,{table:!0}),k.setPanes());e._saveDims();k.scrollView();this.refreshScrollbars();"flex"==l.height&&this.setContAndGridHeightForFlex();"flex"==l.width&&this.setContAndGridWidthFromTable();this._refreshFrozenLine();e._createCollapse();l.dataModel.postDataOnce=void 0}else l.addClass("pq-pending-refresh")};h.refreshVscroll=function(c){c=this.that;var e=c.options;e.virtualY&&
!e.scrollModel.smooth&&(c.scrollMode=!0,this.calcInitFinal(),c.iGenerateView.generateView(),c._saveDims(),c.iGenerateView.scrollView(),1>=this.setScrollVNumEles()&&this.refreshScrollbars())};h._refreshTableWidths=function(c,e){var a=this.that,b=a.colModel,d=a.$tbl_header,k=e.header&&d,l=a.$tbl,g=e.table&&l,f=a.options,p=f.freezeCols,f=f.virtualX,h=a.initH,n=a.finalH,d=k?d.children().children(".pq-row-hidden"):null,m=k?a.$header.find(".pq-grid-col-resize-handle"):null,l=g&&l?l.children().children(".pq-row-hidden"):
null,r,t=!1,s=0;g&&a.tables.length&&(g=a.tables[0].$tbl.children().children(".pq-row-hidden"),l=l?l.add(g):g);for(g=0;g<=n;g++){f&&g<h&&g>=p&&(g=h);var y=b[g],x=c[g];y.hidden||(x=x.outerWidth,y=y.outerWidth,y!==x&&(k&&(r=d.find("td[pq-col-indx="+g+"]"),r.width(y)),l&&(r=l.find("td[pq-col-indx="+g+"]"),r.length&&(t=!0,r.width(y)))),s+=y-x,k&&0!==s&&(x=m.filter("[pq-col-indx="+g+"]"),y=parseInt(x.css("left")),x.css("left",y+s)))}t&&a._trigger("tableWidthChange");a._saveDims()}})(jQuery);
(function(f){var m={getFocusElement:function(){var a=document.activeElement;if(a){var a=f(a),d=a.closest(".pq-grid");if(d.length)return d[0]==this.element[0]?{$ae:a,$grid:d}:{$ae:a,$childGrid:d}}},rowExpand:function(a){this.iHierarchy.rowExpand(a)},rowInvalidate:function(a){this.iHierarchy.rowInvalidate(a)},rowCollapse:function(a){this.iHierarchy.rowCollapse(a)},saveState:function(a){a=a||{};var d=this.options,c=d.dataModel,e=this.element[0].id,d=JSON.stringify({colModel:d.colModel,height:d.height,
width:d.width,groupModel:d.groupModel,pageModel:d.pageModel,sortModel:d.sortModel,filter:c.dataUF&&c.dataUF.length?!0:!1});!1!==a.save&&"undefined"!==typeof Storage&&localStorage.setItem("pq-grid"+(e?e:""),d);return d},loadState:function(a){a=a||{};if("undefined"===typeof Storage)return!1;var d=this.element[0].id;if(d=a.state||localStorage.getItem("pq-grid"+(d?d:"")))"string"==typeof d&&(d=JSON.parse(d));else return!1;for(var c=this.colModel,e=d.colModel,e=this.nestedCols(e).colModel,g=0,q=e.length;g<
q;g++){var p=e[g],h=p.dataIndx;a:{for(var n=0,m=c.length;n<m;n++){var r=c[n];if(h==r.dataIndx){h=r;break a}}h=void 0}f.extend(!0,h,p);f.extend(!0,p,h)}this.option({colModel:e,height:d.height,width:d.width,sortModel:d.sortModel,pageModel:d.pageModel,groupModel:d.groupModel});!1!==a.refresh&&this.refreshDataAndView();return!0}},h=function(a){function d(d,c,e){a.filter({data:[{dataIndx:d,value:c,value2:e}]})}this.that=a;var c=this;this.dataHS={};var e=a.widgetEventPrefix.toLowerCase(),g=a.eventNamespace;
a.element.on(e+"headerkeydown"+g,function(a,b){if(c.belongs(a)){var d=f(a.originalEvent.target);return d.hasClass("pq-grid-hd-search-field")?c.onKeyDown(a,b,d):!0}});a.element.on(e+"createheader"+g,function(a,b){if(c.belongs(a))return c._onCreateHeader()});this.changeListener={change:function(a,b){d(b.dataIndx,b.value,b.value2)}};this.keyupListener={keyup:function(a,b){d(b.dataIndx,b.value,b.value2)}};this.clickListener={click:function(a,b){d(b.dataIndx,b.value)}}},c=h.prototype=new f.paramquery.cClass;
c.get$Ele=function(a,d){var c=this.that,e=c.options.freezeCols,g=f(c.$tbl_header[0]),q=".pq-grid-hd-search-field[name='"+d+"']",c=f(c.$tbl_header[2==c.$tbl_header.length?1:0]);return a>=e?c.find(q):g.find(q)};c.onKeyDown=function(a,d,c){d=this.that;if(a.keyCode===f.ui.keyCode.TAB){var e=c.attr("name"),g=d.getColIndx({dataIndx:e}),q=d.colModel,p,h=a.shiftKey,m=q[g];if("between"==m.filter.condition&&(d.scrollColumn({colIndx:g}),e=this.get$Ele(g,e),e[0]==c[0]?h||(p=e[1]):h&&(p=e[0]),p))return p.focus(),
a.preventDefault(),!1;do{h?g--:g++;if(0>g||g>=q.length)break;m=q[g];c=m.filter;if(!m.hidden&&c){d.scrollColumn({colIndx:g});e=m.dataIndx;p=this.get$Ele(g,e);"between"==c.condition&&(p=h?f(p[1]):f(p[0]));if(p)return p.focus(),a.preventDefault(),!1;break}}while(1)}else return!0};c._bindFocus=function(){function a(b){b=f(b.target).closest(".pq-grid-hd-search-field").attr("name");if(d.scrollColumn({dataIndx:b})){var e=d.getColIndx({dataIndx:b});c.get$Ele(e,b).focus()}}for(var d=this.that,c=this,e=d.$header.find(".pq-grid-header-search-row"),
g=0;g<e.length;g++)f(e[g]).on("focusin",a)};c._onCreateHeader=function(){var a=this.that,d=a.options;if(d.filterModel.header){this._bindFocus();var c=a.colModel,e=d.freezeCols,g=d.virtualX,q=d.virtualXHeader,d=!1===q?a.initHH:a.initH,q=!1===q?a.finalHH:a.finalH,p=a.$tbl_header,h=f(p[0]),m=f(p[1]),u="input,select";if(1<p.length){h.find(u).css("visibility","hidden");for(var r=0;r<e;r++){var t=c[r],u="*[name='"+t.dataIndx+"']";h.find(u).css("visibility","visible");m.find(u).css("visibility","hidden")}}for(r=
0;r<=q;r++){if(r<d&&r>=e&&g&&(r=d,r>q))throw"initH>finalH";t=c[r];if(!t.hidden){var s=t.filter;if(s){var u=t.dataIndx,y=h;r>=e&&1<p.length&&(y=m);y=y.find("*[name='"+u+"']");if(0!=y.length){var x=s.type,w=s.value,A=s.value2;"checkbox"==x&&"triple"==s.subtype?y.pqval({val:w}):"select"==x&&null!=w&&y.val(w);(x=s.init)&&x.call(y,{dataIndx:u,column:t});if(t=s.listeners)for(s=0;s<t.length;s++){x=t[s];"string"==typeof x&&(x=this[x+"Listener"]);for(var z in x)(function(d,c,e){d.bind(z,function(k){var l=
a.getColumn({dataIndx:e}),g=l.filter;"checkbox"==g.type?w="triple"==g.subtype?d.pqval({incr:!0}):d.is(":checked")?!0:!1:"between"==g.condition?(w=f(d[0]).val(),A=f(d[1]).val()):w=d.val();return c.call(this,k,{column:l,dataIndx:e,value:w,value2:A})})})(y,x[z],u)}}}}}}};c.createDOM=function(a,d){var c=this.that,e=c.options,g=e.virtualX,q=e.virtualXHeader,p=!1===q?c.initHH:c.initH,q=!1===q?c.finalHH:c.finalH,h=e.freezeCols,m=c.colModel,u=e.numberCell,e=function(a,b){return["<div class='pq-from-div'>",
a,"</div><span class='pq-from-to-center'>-</span><div class='pq-to-div'>",b,"</div>"].join("")};a.push("<tr class='pq-grid-header-search-row'>");u.show&&a.push("<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='1'><div class='pq-td-div'>&nbsp;</div></td>");for(u=0;u<=q;u++){if(u<p&&u>=h&&g&&(u=p,u>q))throw"initH>finalH";var r=m[u];if(!r.hidden){var t=d,s=r.halign;s||(s=r.align);"right"==s?t+=" pq-align-right":"center"==s&&(t+=" pq-align-center");(s=r.cls)&&(t=t+" "+s);if(s=r.filter){var y=
r.dataIndx,x=s.type,w=s.value,A=s.condition,z=s.cls,z="pq-grid-hd-search-field "+(z?z:""),F=s.style,F=F?F:"",B=s.attr,B=B?B:"",E="";if("between"==A)var C=s.value2,C=null!=C?C:"";"textbox"===x?(w=w?w:"",z+=" ui-corner-all pq-search-txt",E="between"==A?e(this._input(y,w,z+" pq-from",F,B),this._input(y,C,z+" pq-to",F,B)):this._input(y,w,z,F,B)):"textarea"===x?(w=w?w:"",z+=" ui-corner-all pq-search-txt",E="between"==A?e(this._textarea(y,w,z+" pq-from",F,B),this._textarea(y,C,z+" pq-to",F,B)):this._textarea(y,
w,z,F,B)):"select"===x?s.cache?E=s.cache:(x=s.options,"function"===typeof x&&(x=x.call(c.element[0],{column:r,value:w,dataIndx:y,cls:z,style:F,attr:B})),z+=" ui-corner-all",r=["name='",y,"' class='",z,"' style='",F,"' ",B].join(""),E=f.paramquery.select({options:x,attr:r,prepend:s.prepend,valueIndx:s.valueIndx,labelIndx:s.labelIndx,groupIndx:s.groupIndx}),s.cache=E):"checkbox"==x?E=["<input ",null==w||!1==w?"":"checked=checked"," name='",y,"' type=checkbox class='"+z+"' style='"+F+"' "+B+"/>"].join(""):
"string"==typeof x?E=x:"function"==typeof x&&(E=x.call(c.element[0],{width:r.outerWidth,value:w,value2:C,column:r,dataIndx:y,cls:z,attr:B,style:F}));a.push(["<td class='",t,"'><div class='pq-td-div' >",E,"</div></td>"].join(""))}else a.push(["<td class='",t,"'><div class='pq-td-div' >&nbsp;</div></td>"].join(""))}}a.push("</tr>")};c._input=function(a,d,c,e,g){return['<input value="',d,"\" name='",a,"' type=text style='"+e+"' class='"+c+"' "+g+" />"].join("")};c._textarea=function(a,d,c,e,g){return["<textarea name='",
a,"' style='"+e+"' class='"+c+"' "+g+" >",d,"</textarea>"].join("")};f.paramquery.select=function(a){var d=a.options,c=a.groupIndx,e=a.labelIndx,g=a.valueIndx,f=null!=e&&null!=g,p=null!=c,h=a.prepend,m=a.dataMap,u,r,t;a=["<select ",a.attr," >"];if(h)for(var s in h)a.push('<option value="',s,'">',h[s],"</option>");if(d&&d.length){for(var h=0,y=d.length;h<y;h++){var x=d[h];if(f){var w=x[g],A=x.pq_disabled?'disabled="disabled" ':"",z=x.pq_selected?'selected="selected" ':"";if(null!=w){if(m){u={};for(t=
0;t<m.length;t++){var F=m[t];u[F]=x[F]}u="data-map='"+JSON.stringify(u)+"'"}else u="";t=u;p&&(F=x.pq_disabled_group?'disabled="disabled" ':"",u=x[c],r!=u&&(null!=r&&a.push("</optgroup>"),a.push('<optgroup label="',u,'" ',F," >"),r=u));e==g?a.push("<option ",z,A,t,">",w,"</option>"):a.push("<option ",z,A,t,' value="',w,'">',x[e],"</option>")}}else if("object"==typeof x)for(s in x)a.push('<option value="',s,'">',x[s],"</option>");else a.push("<option>",x,"</option>")}p&&a.push("</optgroup>")}a.push("</select>");
return a.join("")};f.fn.pqval=function(a){if(a){if(a.incr)return a=this.data("pq_value"),this.prop("indeterminate",!1),a?(a=!1,this.prop("checked",!1)):!1===a?(a=null,this.prop("indeterminate",!0),this.prop("checked",!1)):(a=!0,this.prop("checked",!0)),this.data("pq_value",a),a;a=a.val;this.data("pq_value",a);this.prop("indeterminate",!1);null==a?(this.prop("indeterminate",!0),this.prop("checked",!1)):a?this.prop("checked",!0):this.prop("checked",!1);return this}return this.data("pq_value")};var e=
{_generateTitleRow:function(a,d,c,e){var g=this.that.options.numberCell,f=d.groupTitle,p=d.level,h=d.GMRowIndx,m=a.title,u=a.icon,u=(u=u?u[p]:null)&&u.length&&2==u.length&&"function"===typeof u.push?u:["ui-icon-minus glyphicon glyphicon-minus","ui-icon-plus glyphicon glyphicon-plus"];if(m&&null!=m[p]){m=m[p];if(!1===m)return;"function"==typeof m?f=m(d):(f=m.replace("{0}",f),f=f.replace("{1}",d.items))}else f=f+" - "+d.items+" item(s)";e="pq-group-row pq-grid-row"+(e?" pq-last-frozen-row":"");(a=a.titleCls)&&
(a=a[p])&&(e+=" "+a);c.push(["<tr class='",e,"' title=\"",d.groupTitle,"\" level='",p,"' GMRowIndx='",h,"'>"].join(""));g.show&&c.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");g=u[0];d.collapsed&&(g=u[1]);c.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",16*p,"px;'>","<span class='ui-icon ",g,"'></span>",f,"</div></td>");c.push("</tr>")},_generateSummaryRow:function(a,d,c,e,g){var f=d.level,p=d.rowData,h="pq-summary-row pq-grid-row"+
(g?" pq-last-frozen-row":"");(a=a.summaryCls)&&(a=a[f])&&(h+=" "+a);a=this.that;var m=a.options;g=m.virtualX;var u=a.initH,r=a.finalH,t=m.freezeCols,s=m.numberCell,m=m.columnBorders;e.push("<tr class='"+h+"'>");s.show&&e.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");for(h=0;h<=r;h++){if(h<u&&h>=t&&g&&(h=u,h>r))throw"initH>finalH";var s=c[h],y=s.dataIndx;if(!s.hidden){var x="pq-grid-cell ";"right"==s.align?x+=" pq-align-right":"center"==s.align&&(x+=" pq-align-center");h==t-
1&&m&&(x+=" pq-last-frozen-col");s.cls&&(x=x+" "+s.cls);var w=p[y],A;w&&(A=s.summary.title)&&(A=A[f])&&("function"==typeof A?(d.dataIndx=y,d.cellData=w,w=A.call(a.element[0],d)):w=A.replace("{0}",w));w=null==w?"&nbsp;":w;s=["<td class='",x,"' style='' >",w,"</td>"].join("");e.push(s)}}e.push("</tr>");return e},_generateDetailRow:function(a,d,c,e,g,f){c="pq-grid-row pq-detail-child";f&&(c+=" pq-last-frozen-row");var p=this.that.options;f=p.numberCell;var h="pq-grid-cell ";if(!p.wrap||g)h+="pq-wrap-text ";
p.stripeRows&&d/2==parseInt(d/2)&&(c+=" pq-grid-oddRow");a.pq_rowselect&&(c+=" pq-row-select ui-state-highlight");a=a.pq_rowcls;null!=a&&(c+=" "+a);e.push("<tr pq-row-indx='"+d+"' class='"+c+"' >");f.show&&e.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");e.push("<td class='"+h+" pq-detail-child' colSpan='20'></td>");e.push("</tr>");return e}},a=function(a){this.that=a},c=a.prototype;c._refreshDataFromDataModel=function(){this._groupData();this.initcollapsed()};c.bindEvents=function(){var a=
this;this.that.$cont.on("click","tr.pq-group-row",function(d){return a.onClickGroupRow(d)})};c.showHideRows=function(a,d,c){for(var e=[],g=this.that.dataGM,f=g.length;a<f;a++){var p=g[a],h=p;if(h.groupSummary)if(p.level<d)break;else p.pq_hidden=c;else if(h.groupTitle)if(p.collapsed&&e.push({indx:a,level:p.level}),p.level<=d)break;else p.pq_hidden=c;else p.pq_hidden=c}return e};c.onClickGroupRow=function(a){var d=f(a.currentTarget);a=this.that;var c=parseInt(d.attr("level")),d=parseInt(d.attr("GMRowIndx")),
e=!0,e=a.dataGM[d];e=e.collapsed?e.collapsed=!1:e.collapsed=!0;if(e)this.showHideRows(d+1,c,!0);else for(d=this.showHideRows(d+1,c,!1),e=0;e<d.length;e++){var g=d[e].indx,c=d[e].level;this.showHideRows(g+1,c,!0)}a.refresh()};c.initcollapsed=function(){var a=this.that.dataGM;if(a)for(var d=0,c=a.length;d<c;d++){var e=a[d];if(void 0!==e.groupTitle){var g=e.level;e.collapsed&&this.showHideRows(d+1,g,!0)}}};c.max=function(a,d){var c;"integer"==d||"float"==d?(c=Math.max.apply(Math,a),"float"===d&&(c=c.toFixed(2))):
(a="date"==d?a.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return a-b}):a.sort(),c=a[a.length-1]);return c};c.min=function(a,d){var c;"integer"==d||"float"==d?(c=Math.min.apply(Math,a),"float"===d&&(c=c.toFixed(2))):(a="date"==d?a.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return a-b}):a.sort(),c=a[0]);return c};c.count=function(a){return a.length};c.sum=function(a,d){var c=0,e;e="float"===d?parseFloat:"integer"===d?parseInt:function(a){return a};for(var g=0,f=a.length;g<f;g++)c+=e(a[g]);
"float"===d&&(c=c.toFixed(2));return c};c._groupData=function(){for(var a=this.that,d=a.pdata,c=a.options,e=c.groupModel,g=c.pageModel,c=a.colModel,g=g.type?(g.curPage-1)*g.rPP:0,h=c.length,p=e.dataIndx,m=p.length,n=e.collapsed,u=[],r=0;r<m;r++){u[r]=!1;for(var t=0;t<h;t++){var s=c[t],y=s.summary;if(y&&(y=y.type)&&"function"==typeof y.push&&y[r]){u[r]=!0;break}}}if(e&&d&&0<d.length){for(var e=[],t=[],x=[],w=[],A=[],r=0;r<m;r++)w[r]=null,x[r]="",A[r]={};for(var z=0,F=d.length;z<=F;z++){for(var B=d[z],
s=!1,E=null,r=0;r<m;r++)x[r]=z<F?f.trim(B[p[r]]):"",w[r]!=x[r]&&(s=!0),s&&null==E&&(E=r);if(s){for(s=0;s<m;s++)w[s]=x[s];if(0<z){for(r=m-1;r>=E;r--)if(u[r]){for(var C=[],G=0;G<h;G++)if(s=c[G],y=(y=s.summary)?y.type?y.type[r]:null:null){var D=s.dataIndx,H="",H="function"==typeof y?y(A[r][D],s.dataType):this[y](A[r][D],s.dataType);C[D]=H}e.push({groupSummary:!0,level:r,prevRowData:d[z-1],rowData:C})}for(s=E;s<m;s++)e[t[s]].items=A[s][c[0].dataIndx].length}if(z==F)break;for(r=m-1;r>=E;r--)for(y=0;y<
h;y++)s=c[y],A[r][s.dataIndx]=[];for(s=E;s<m;s++)e.push({groupTitle:x[s],level:s,nextRowData:B,GMRowIndx:e.length,collapsed:n&&null!=n[s]?n[s]:!1}),t[s]=e.length-1}if(z==F)break;B.rowIndx=z+g;B.pq_hidden=!1;e.push(B);for(E=0;E<h;E++)for(s=c[E],D=s.dataIndx,r=0;r<m;r++)A[r][D].push(B[D])}a.dataGM=e}else a.dataGM=null};m.options={cls:{cont_inner:"pq-grid-cont-inner",cont_inner_b:"pq-grid-cont-inner-b"},flex:{on:!0,one:!1,all:!0},detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se glyphicon glyphicon-minus",
collapseIcon:"ui-icon-triangle-1-e glyphicon glyphicon-plus"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check glyphicon-ok",rejectIcon:"ui-icon-closethick glyphicon-remove",topIcon:"ui-icon-circle-arrow-s glyphicon glyphicon-circle-arrow-down",bottomIcon:"ui-icon-circle-arrow-n glyphicon glyphicon-circle-arrow-up"},track:null,mergeModel:{on:!1},sortModel:{on:!0,type:"local",number:!0,single:!0,cancel:!0,sorter:[]},filterModel:{on:!0,type:"local",mode:"AND",header:!1}};m._create=function(){f.extend(f.paramquery.cGenerateView.prototype,
e);var b=f.paramquery,d=this.options;this._queueATriggers={};this._queueBTriggers={};this.iHistory=new b.cHistory(this);this.iGroupView=new a(this);b.cMerge&&(this.iMerge=new b.cMerge(this));this.iFilterData=new b.cFilterData(this);this.iHeaderSearch=new h(this);this.iUCData=new b.cUCData(this);this.iMouseSelection=new b.cMouseSelection(this);this._super();this.iGroupView.bindEvents();this.iDragColumns=new b.cDragColumns(this);this._createToolbar();"remote"===d.dataModel.location&&this.refresh({table:!0});
this.refreshDataAndView({header:!0})};m._createToolbar=function(){var a=this.options,d=a.toolbar;if(d){var c=d.cls,e=d.style,g=d.attr,d=d.items,c=f("<div class='"+(c?c:"")+"' style='"+(e?e:"")+"' "+(g?g:"")+" ></div>").appendTo(f(".pq-grid-top",this.element));c.pqToolbar({items:d,gridInstance:this});a.showToolbar||c.css("display","none");this.$toolbar=c}};m.isLeftOrRight=function(a){return a>this.freezeCols?"right":"left"};m.ovCreateHeader=function(a,d){this.options.filterModel.header&&this.iHeaderSearch.createDOM(a,
d)};m._createHeader=function(){this._super();this.options.showHeader&&this._trigger("createHeader")};m.filter=function(a){var d=this,c=this.options,e=void 0===a.apply?!0:a.apply,g=void 0===a.sort?!0:a.sort,h=c.dataModel,c=c.filterModel;if(void 0!=a){var p="replace"==a.oper?!0:!1;a=a.data;for(var m=this.colModel,m=e?m:f.extend(!0,[],m),n=0,u=m.length,r=a.length,t=0;t<u;t++){for(var s=m[t],y=!1,x=0;x<r&&n!=r;x++){var w=a[x];if(w.dataIndx==s.dataIndx){y=!0;n++;var x=s.filter,A=w.condition,z=w.value;
x?x.on=!0:x=s.filter={on:!0};A&&(x.condition=A);A=x.condition;x.value=z;if("between"==A)x.value2=w.value2;else if("range"==A){w=[];if(z)if("string"==typeof z){var A=x.options,F=z.indexOf('"'),B=z.lastIndexOf('"'),z=z.substr(F,B+1),z=JSON.parse("["+z+"]");if(A)for(F=0,B=A.length;F<B;F++){var E=A[F];-1!=f.inArray(E,z)&&w.push(E)}else w=z.split(",s*")}else"function"==typeof z.push&&(w=z);x.value=w}break}}p&&!y&&s.filter&&(s.filter.on=!1)}}var C={header:!1,apply:e,sort:g,CM:m};if("remote"==h.location&&
"local"!=c.type)this.remoteRequest({apply:e,CM:m,callback:function(){return d._onDataAvailable(C)}});else return C.source="filter",d._onDataAvailable(C)};m._initTypeColumns=function(){for(var a=this.colModel,d=0,c=a.length;d<c;d++){var e=a[d],g=e.type;"checkBoxSelection"===g?new f.paramquery.cCheckBoxColumn(this,e):"detail"===g&&(e.dataIndx="pq_detail",this.iHierarchy=new f.paramquery.cHierarchy(this))}};m.refreshHeader=function(){this._createHeader();this.iGenerateView.setPanes();this._refreshHeaderSortIcons()};
m.refreshDataFromDataModel=function(){this._super();this.options.groupModel&&this.iGroupView._refreshDataFromDataModel()};m._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()};m.getLargestRowCol=function(a){for(var d=0;d<a.length;d++);};m.bringCellToView=function(a){this._bringCellToView(a)};m._setUrl=function(a){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=a?a:"")}}};m.pageData=function(){return this.pdata};m.getData=function(a){var d=a.dataIndx,c=d.length;
a=a.data;var e=this.options.dataModel,g=e.data,e=e.dataUF,f=[],h=function(a){for(var b=0,e=a.length;b<e;b++){for(var g=a[b],l={},h=0;h<c;h++){var p=d[h];l[p]=g[p]}f.push(l)}};a?h(a):(g&&h(g),e&&h(e));a=[];for(g=0;g<c;g++)e=d[g],h=this.getColumn({dataIndx:e}),a.push({dataIndx:e,dir:"up",dataType:h.dataType,sortType:h.sortType});f=this.iSort._sortLocalData(a,f);a=[];g=void 0;for(e=0;e<f.length;e++){var h=f[e],m=JSON.stringify(h);m!==g&&(a.push(h),g=m)}return a};m._onDataAvailable=function(a){a=a||{};
var d=this.options,c=null==a.apply?!0:a.apply,e=a.source,g=a.sort,f=[],f=d.filterModel,h=d.dataModel,d=d.sortModel,m=h.location;!1!==c&&this._trigger("dataAvailable",a.evt,{dataModel:h,source:e});f=f&&f.on&&("local"==m&&"remote"!=f.type||"remote"==m&&"local"==f.type)?this.iFilterData.filterLocalData(a).data:h.data;"local"==d.type&&!1!==g&&(c?this.sort({refresh:!1}):f=this.iSort.sortLocalData(f));if(!1===c)return f;h.data=f;this.refreshView(a)};m.sort=function(a){a=a||{};var d=this,c=this.options,
e=c.dataModel.data,g=c.sortModel.type;if(e&&e.length||"local"!=g){var f=c.editModel,c=this.iSort,h=c.getSorter(),m,n=a.evt,u=null==a.single?c.readSingle():a.single;m=c.readCancel();a.sorter?a.addon?(a.single=u,a.cancel=m,m=c.refreshSorter(a)):m=a.sorter:m=c.readSorter();if(m.length||h.length)f.indices&&d.blurEditor({force:!0}),f={dataIndx:m.length?m[0].dataIndx:null,oldSorter:h,sorter:m,source:a.source,single:u},!1===d._trigger("beforeSort",n,f)?c.cancelSort():(c.resumeSort(),"local"==g&&c.saveOrder(),
c.setSorter(m),c.setSingle(u),c.writeSorter(m),c.writeSingle(u),"local"==g?(c.sortLocalData(e),this._queueATriggers.sort={evt:n,ui:f},!1!==a.refresh&&this.refreshView()):"remote"==g&&(this._queueATriggers.sort={evt:n,ui:f},a.initByRemote||this.remoteRequest({initBySort:!0,callback:function(){d._onDataAvailable()}})))}};f.widget("paramquery.pqGrid",f.paramquery._pqGrid,m);f.paramquery.pqGrid.regional={};f.paramquery.pqGrid.regional.en=m._regional})(jQuery);
(function(f){var m=f.paramquery._pqGrid.prototype;f.paramquery=f.paramquery||{};f.paramquery.pqgrid=f.paramquery.pqgrid||{};m.exportExcel=function(c){c.format="xls";return h.call(this,c)};m.exportCsv=function(c){c.format="csv";return h.call(this,c)};m.exportXml=function(c){c.format="xml";return h.call(this,c)};m.exportHtml=function(c){c.format="html";return h.call(this,c)};var h=function(c){var e=this,a=void 0===c.urlPost?c.url:c.urlPost,b=c.url,d=null==c.sheetName?"pqGrid":c.sheetName,k=c.format,
l=function(){for(var a=e.colModel,b=a.length,d=e.options.dataModel.data,c=d.length,k=[],l=[],f=[],h=0;h<b;h++){var m=a[h];!1!==m.copy&&(m=m.title.replace(/\"/g,'""'),l.push('"'+m+'"'))}k.push(l.join(","));for(h=0;h<c;h++){for(var l=d[h],y=0;y<b;y++)m=a[y],!1!==m.copy&&(m=l[m.dataIndx]+"",m=m.replace(/\"/g,'""'),f.push('"'+m+'"'));k.push(f.join(","));f=[]}return k.join("\n")};c="xls"==k?function(){for(var a=e.colModel,b=a.length,c=e.options.dataModel.data,k=c.length,l,f=[],h=[],m=0;m<b;m++){var s=
a[m];!1!==s.copy&&(l=s._width,l||(l=parseInt(s.width))||(l=100),h.push('<Column ss:AutoFitWidth="1"  ss:Width="'+l+'" />'))}h.push("<Row>");for(m=0;m<b;m++)s=a[m],!1!==s.copy&&h.push('<Cell><Data ss:Type="String">'+s.title+"</Data></Cell>");h.push("</Row>");h=h.join("\n");for(m=0;m<k;m++){l=c[m];f.push("<Row>");for(var y=0;y<b;y++)s=a[y],!1!==s.copy&&f.push('<Cell><Data ss:Type="String"><![CDATA['+l[s.dataIndx]+"]]\x3e</Data></Cell>");f.push("</Row>")}f=f.join("\n");return['<?xml version="1.0"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n xmlns:o="urn:schemas-microsoft-com:office:office"\n xmlns:x="urn:schemas-microsoft-com:office:excel"\n xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\n xmlns:html="http://www.w3.org/TR/REC-html40">\n<Worksheet ss:Name="',
d,'">\n<Table>',h,f,"</Table>\n</Worksheet>\n</Workbook>"].join("\n")}():"xml"==k?getXMLContent():"html"==k?getHTMLContent(c):l();f.ajax({url:a,type:"POST",cache:!1,data:{extension:"xls"==k?"xml":k,excel:c},success:function(a){a=b+((0<b.indexOf("?")?"&":"?")+"filename="+a);f(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+a+"></iframe>")}})}})(jQuery);
(function(f){var m=f.paramquery.pqGrid.prototype.options,h={on:!1,dirtyClass:"pq-cell-dirty"};m.trackModel=m.trackModel||h;m=(f.paramquery.cUCData=function(c){this.that=c;this.udata=[];this.ddata=[];this.adata=[];this.options=c.options;var e=this,a=c.eventNamespace,b=c.widgetEventPrefix.toLowerCase();c.element.on(b+"dataavailable"+a,function(a,b){e.belongs(a)&&"filter"!=b.source&&(e.udata=[],e.ddata=[],e.adata=[])})}).prototype=new f.paramquery.cClass;m.add=function(c){var e=this.that,a=this.adata;
c=c.rowData;for(var b=this.options.trackModel.dirtyClass,d=e.getRecId({rowData:c}),k=0,l=a.length;k<l;k++){var g=a[k];if(null!=d&&g.recId==d)throw"primary key violation";if(g.rowData==c)throw"same data can't be added twice.";}var k=[],f;for(f in c)k.push(f);e.removeClass({rowData:c,dataIndx:k,cls:b});c={recId:d,rowData:c};a.push(c)};m.update=function(c){var e=this.that,a=this.options.trackModel.dirtyClass,b=c.rowData||e.getRowData(c),d=e.getRecId({rowData:b}),k=c.dataIndx,l=c.refresh,g=e.columns,
h=f.paramquery.getValueFromDataType;c=c.row;var m=this.udata,v=m.slice(0),n=!1;if(null!=d){for(var u=0,r=m.length;u<r;u++){var t=m[u],s=t.oldRow;if(t.rowData==b){n=!0;for(k in c)m=g[k].dataType,r=c[k],r=h(r,m),t=s[k],t=h(t,m),s.hasOwnProperty(k)&&t===r?(m={rowData:b,dataIndx:k,refresh:l,cls:a},e.removeClass(m),delete s[k]):(m={rowData:b,dataIndx:k,refresh:l,cls:a},e.addClass(m),s.hasOwnProperty(k)||(s[k]=b[k]));f.isEmptyObject(s)&&v.splice(u,1);break}}if(!n){s={};for(k in c)s[k]=b[k],m={rowData:b,
dataIndx:k,refresh:l,cls:a},e.addClass(m);m={rowData:b,recId:d,oldRow:s};v.push(m)}this.udata=v}};m["delete"]=function(c){var e=this.that,a=c.rowIndx,b=c.rowIndxPage,d=e.rowIndxOffset,a=null==a?b+d:a,b="remote"==e.options.pageModel.type?null==b?a-d:b:a,d=this.adata,k=this.ddata;c=e.getRowData(c);for(var e=0,l=d.length;e<l;e++)if(d[e].rowData==c){d.splice(e,1);return}k.push({indx:b,rowData:c,rowIndx:a})};m.isDirty=function(c){var e=this.udata,a=this.adata,b=this.ddata,d=!1;if(c=this.that.getRowData(c))for(a=
0;a<e.length;a++){if(c==e[a].rowData){d=!0;break}}else if(e.length||a.length||b.length)d=!0;return d};m.getChangesValue=function(){for(var c=this.udata,e=this.adata,a=this.ddata,b={updateList:[],addList:[],deleteList:[]},d=[],k=[],l=[],g=[],h=[],m=0,v=a.length;m<v;m++){var n=a[m],n=n.rowData,u={};g.push(n);for(var r in n)0!=r.indexOf("pq_")&&(u[r]=n[r]);h.push(u)}for(m=0;m<c.length;m++)if(n=c[m],n=n.rowData,-1==f.inArray(n,g)&&-1==f.inArray(n,d)){u={};for(r in n)0!=r.indexOf("pq_")&&(u[r]=n[r]);d.push(n);
k.push(u)}for(m=0;m<e.length;m++){n=e[m];n=n.rowData;u={};for(r in n)0!=r.indexOf("pq_")&&(u[r]=n[r]);l.push(u)}b.updateList=k;b.addList=l;b.deleteList=h;return b};m.getChanges=function(){for(var c=this.udata,e=this.adata,a=this.ddata,b={updateList:[],addList:[],deleteList:[]},d=[],k=[],l=[],g=0,h=a.length;g<h;g++){var m=a[g],m=m.rowData;l.push(m)}g=0;for(h=c.length;g<h;g++)m=c[g],m=m.rowData,-1==f.inArray(m,l)&&-1==f.inArray(m,d)&&d.push(m);g=0;for(h=e.length;g<h;g++)m=e[g],m=m.rowData,k.push(m);
b.updateList=d;b.addList=k;b.deleteList=l;return b};m.getChangesRaw=function(){var c=this.adata,e=this.ddata,a={updateList:[],addList:[],deleteList:[]};a.updateList=this.udata;a.addList=c;a.deleteList=e;return a};m.commitAdd=function(c,e){for(var a=this.that.colModel,b=a.length,d=this.adata,k=f.inArray,l=d.length,g=f.paramquery.getValueFromDataType,h=[],m=c.length,v=[],n=0;n<m;n++)for(var u=c[n],r=0;r<l;r++){var t=d[r].rowData,s=!0;if(-1==k(t,v)){for(var y=0;y<b;y++){var x=a[y],w=x.dataType,A=x.dataIndx;
if(!x.hidden&&A!=e&&(x=t[A],x=g(x,w),A=u[A],A=g(A,w),x!==A)){s=!1;break}}if(s){r={};s={};r[e]=u[e];s[e]=t[e];h.push({type:"update",rowData:t,oldRow:s,newRow:r});v.push(t);break}}}a=[];for(r=0;r<l;r++)t=d[r].rowData,-1==k(t,v)&&a.push(d[r]);this.adata=a;return h};m.commitUpdate=function(c,e){for(var a=this.that,b=this.options.trackModel.dirtyClass,d=a.colModel,k=d.length,l=this.udata,g=l.length,h=c.length,m=[],v=0;v<g;v++){var n=l[v],u=n.rowData,n=n.oldRow;if(-1==f.inArray(u,m))for(var r=0;r<h;r++)if(u[e]==
c[r][e]){m.push(u);for(var t=0;t<k;t++)var s=d[t].dataIndx;for(s in n)a.removeClass({rowData:u,dataIndx:s,cls:b})}}a=[];for(v=0;v<g;v++)u=l[v].rowData,-1==f.inArray(u,m)&&a.push(l[v]);this.udata=a;return[]};m.commitDelete=function(c,e){for(var a=this.ddata,b=a.length,d=c.length,k=[],l=0;l<b;l++)for(var g=a[l].rowData,h=0;h<d;h++)g[e]==c[h][e]&&k.push(g);d=[];for(l=0;l<b;l++)g=a[l].rowData,-1==f.inArray(g,k)&&d.push(a[l]);this.ddata=d};m.commitUpdateAll=function(){for(var c=this.that,e=this.options.trackModel.dirtyClass,
a=this.udata,b=0,d=a.length;b<d;b++){var k=a[b],l=k.oldRow,k=k.rowData,g;for(g in l)c.removeClass({rowData:k,dataIndx:g,cls:e})}this.udata=[]};m.commitAddAll=function(){this.adata=[]};m.commitDeleteAll=function(){this.ddata=[]};m.commit=function(c){var e=this.that,a=c?c.history:null,a=null==a?!1:a,b=[],b=[],d=[],k=e.options.dataModel.recIndx;if(null==c)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var l=c.type;c=c.rows;"add"==l?c?b=this.commitAdd(c,k):this.commitAddAll():
"update"==l?c?d=this.commitUpdate(c,k):this.commitUpdateAll():"delete"==l&&(c?this.commitDelete(c,k):this.commitDeleteAll())}b=b.concat(d);b.length&&(e._digestData({source:"commit",checkEditable:!1,track:!1,history:a,rowList:b}),e.refreshView())};m.rollbackAdd=function(c,e){for(var a=this.adata,b=[],d=0,k=a.length;d<k;d++)b.push({type:"delete",rowData:a[d].rowData});this.adata=[];return b};m.rollbackDelete=function(c,e){for(var a=this.ddata,b=[],d=a.length-1;0<=d;d--){var k=a[d];b.push({type:"add",
rowIndx:k.rowIndx,newRow:k.rowData})}this.ddata=[];return b};m.rollbackUpdate=function(c,e){for(var a=this.that,b=this.options.trackModel.dirtyClass,d=this.udata,k=[],l=0,g=d.length;l<g;l++){var f=d[l],h=f.rowData,m={},n=f.oldRow;if(null!=f.recId){var f=[],u;for(u in n)m[u]=h[u],f.push(u);a.removeClass({rowData:h,dataIndx:f,cls:b,refresh:!1});k.push({type:"update",rowData:h,newRow:n,oldRow:m})}}this.udata=[];return k};m.rollback=function(c){var e=this.that,a=e.options.pageModel,b=c&&null!=c.refresh?
c.refresh:!0;c=c&&null!=c.type?c.type:null;var d=[],d=[],k=[],l=[],g=e.options.dataModel.data;if(null==c||"update"==c)k=this.rollbackUpdate(a,g);if(null==c||"delete"==c)d=this.rollbackDelete(a,g);if(null==c||"add"==c)l=this.rollbackAdd(a,g);d=d.concat(l,k);e._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:d});b&&e.refreshView()};m=f.paramquery.pqGrid.prototype;m.getChanges=function(c){this.blurEditor({force:!0});if(c&&(c=c.format)){if("byVal"==c)return this.iUCData.getChangesValue();
if("raw"==c)return this.iUCData.getChangesRaw()}return this.iUCData.getChanges()};m.rollback=function(c){this.blurEditor({force:!0});this.iUCData.rollback(c)};m.isDirty=function(c){return this.iUCData.isDirty(c)};m.commit=function(c){this.iUCData.commit(c)};m._getRowIndx=function(){var c=this.selection({type:"row",method:"getSelection"});if(c&&0<c.length){var c=c[0].rowIndx,e=this.options.pageModel,a=c-this.rowIndxOffset,b=e.rPP;if(e.type){if(0<=a&&a<b)return c}else return c}else return null};m.updateRow=
function(c){var e=c.rowIndx,a=c.row,b=c.rowData||this.getRowData({rowIndx:e});if(!b)return!1;var d={},k;for(k in a){var l=this.columns[k];l&&(d[k]=this.iGenerateView.readCell(b,l))}if(!1===this._digestData({source:c.source||"update",history:c.history,checkEditable:c.checkEditable,track:c.track,allowInvalid:c.allowInvalid,rowList:[{newRow:a,oldRow:d,rowData:b,rowIndx:e,type:"update"}]}))return!1;!1!==c.refresh&&this.refreshRow({rowIndx:e})};m.updateElseAdd=function(c){var e=c.row;null==this.getRowData({rowIndx:c.rowIndx})?
(c.rowData=e,this.addRow(c)):this.updateRow(c)};m._fillForm=function(c){var e=this.colModel,a=this.rowIndxOffset,b=null==c.rowIndxPage?c.rowIndx-a:c.rowIndxPage;c=null==c.rowIndx?b+a:c.rowIndx;this.rowData=b=this.options.dataModel.data["remote"==this.options.pageModel.type?b:c];this.$crudDialog.dialog("option","title","Edit Record ("+(c+1)+")");c=this.$crudForm;for(a=0;a<e.length;a++){var d=e[a].dataIndx,k=b[d];c.find("*[name='"+d+"']").val(k)}};m.getRecId=function(c){c.dataIndx=this.options.dataModel.recIndx;
c=this.getCellData(c);return null==c?null:c};m.getCellData=function(c){var e=c.rowData||this.getRowData(c);c=c.dataIndx;return e?e[c]:null};m.getRowData=function(c){if(!c)return null;var e=c.rowData;if(null!=e)return e;var a=this.options,e=a.dataModel,a=a.pageModel.type,b=e.recIndx,d=c.recId,e=e.data;if(null!=d)for(c=0,a=e.length;c<a;c++){var k=e[c];if(k[b]==d)return k}else return b=c.rowIndx,c=c.rowIndxPage,d=this.rowIndxOffset,b=null!=b?b:c+d,c="remote"==a?null!=c?c:b-d:b,k=e?e[c]:null;return null};
m.deleteRow=function(c){var e=c.rowIndx,a=c.rowIndxPage,b=this.rowIndxOffset,e=null!=a?a+b:e;null!=e&&(a=c.rowData||this.getRowData({rowIndx:e}),this._digestData({source:c.source||"delete",history:c.history,track:c.track,rowList:[{rowIndx:e,rowData:a,oldRow:a,type:"delete"}]}),!1!==c.refresh&&this.refreshView())};m.addRow=function(c){var e=c.rowData||c.row,a=c.rowIndx,b=c.rowIndxPage,d=this.rowIndxOffset,a=null!=b?b+d:a,b=this.options.dataModel,d=b.data;if(null==e)return null;null==d&&(b.data=[],
d=b.data);if(!1===this._digestData({source:c.source||"add",history:c.history,track:c.track,checkEditable:c.checkEditable,rowList:[{newRow:e,rowIndx:a,type:"add"}]}))return!1;!1!==c.refresh&&this.refreshView();return null==a?d.length-1:a}})(jQuery);
(function(f){f.widget("paramquery.pqToolbar",{options:{items:[],gridInstance:null},_create:function(){var m=this.options,h=m.gridInstance,c=h.colModel,e=m.items,a=this.element;a.closest(".pq-grid");a.addClass("pq-toolbar");for(var b=0,d=e.length;b<d;b++){var k=e[b],m=k.type,l=k.icon,g=k.label,q=k.listener,p=q?[q]:k.listeners,q=k.cls,q="ui-corner-all "+(q?q:""),v=k.style,v=v?'style="'+v+'"':"",n=k.attr,n=n?n:"",u;"textbox"==m?u=f("<input type='text' class='"+q+"' "+n+" "+v+">").appendTo(a):"checkbox"==
m?u=f("<input type='checkbox' class='"+q+"' "+n+" "+v+">").appendTo(a):"separator"==m?f("<span class='pq-separator '"+q+"' "+n+" "+v+"></span>").appendTo(a):"button"==m?(m=k.options?k.options:{},f.extend(m,{text:g?!0:!1,icons:{primary:l}}),u=f("<button type='button' class='"+q+"' "+n+" "+v+">"+g+"</button>").button(m).appendTo(a)):"select"==m?(m=k.options?k.options:[],"function"===typeof m&&(m=m.call(h.element[0],{colModel:c})),u=f.paramquery.select({options:m,attr:" class='"+q+"' "+n+" "+v,prepend:k.prepend,
groupIndx:k.groupIndx,valueIndx:k.valueIndx,labelIndx:k.labelIndx}),u=f(u).appendTo(a)):"string"==typeof m?u=f(m).appendTo(a):"function"==typeof m&&(u=m.call(h.element[0],{colModel:c,cls:q}),u=f(u).appendTo(a));if(p)for(k=0;k<p.length;k++){var q=p[k],r;for(r in q)u.bind(r,q[r])}}},_destroy:function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},_disable:function(){null==this.$disable&&(this.$disable=f("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},
_enable:function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},_setOption:function(f,h){"disabled"==f&&(!0==h?this._disable():this._enable())}})})(jQuery);
(function(f){var m=function(){this.focusSelection=null},h=m.prototype;h.triggerSelectChange=function(a){var b=this.that;if(b.options.selectionModel.fireSelectChange){var d=b.iRows.getSelection(),c=b.iCells.getSelection(),e=a.evt;a=a.ui;d={rows:d,cells:c};a=null==a?d:f.extend(d,a);b._trigger("selectChange",e,a)}};h.getOldRowSel=function(){var a=this.that,b;if((b=this.focusSelection)&&this.isSelected(b))return a=a.getRowIndx(b),a.rowData=b.rowData,a};h.getOldCellSel=function(){var a=this.that,b;if((b=
this.focusSelection)&&this.isSelected(b)){var d=b.rowData,a=a.getRowIndx({rowData:d});a.rowData=d;a.dataIndx=b.dataIndx;return a}};h.getNewRowSel=function(){var a=this.that,b=document.activeElement?f(document.activeElement):null;if(b&&b.hasClass("pq-grid-row")&&b.closest(".pq-grid")[0]==a.element[0])return a=a.getRowIndx({$tr:b}),a.$tr=b,a};h.getNewCellSel=function(){var a=this.that,b=document.activeElement?f(document.activeElement):null;if(b&&b.hasClass("pq-grid-cell")&&b.closest(".pq-grid")[0]==
a.element[0])return a=a.getCellIndices({$td:b}),a.$td=b,a};h.getFocusSelection=function(a){if(this instanceof c)return a&&!0===a.old?this.getOldRowSel():this.getNewRowSel();if(this instanceof e)return a&&!0===a.old?this.getOldCellSel():this.getNewCellSel()};h.getFirstSelection=function(){var a=this.firstSelection;if(a&&this.isSelected(a))return a;this.refresh();a=this.selection;if(a.length)return this.firstSelection=a[0],a[0]};h.getLastSelection=function(){var a=this.lastSelection;if(a){var b=a.rowData,
d=this.that.getRowData({rowIndx:rowIndx});return b==d&&this.isSelected(a)?a:!1}return null};h.getLastSelectionCurPage=function(){var a=this.lastSelection;if(a&&this.isSelected(a)){var b=a.rowIndx,d=this.that.options.pageModel;if(d.type){var c=d.curPage;return Math.ceil((b+1)/d.rPP)==c?a:null}return a}return null};h.getSelection=function(){this.refresh();return this.selection};h.getSelectionCurPage=function(){var a=this.that,b=this.getSelection(),d=[],c=a.options.pageModel;if(c.type){for(var a=c.curPage,
c=c.rPP,e=0;e<b.length;e++){var g=b[e];Math.ceil((g.rowIndx+1)/c)==a&&d.push(g)}return d}return b};h.inViewRow=function(a){var b=this.that,d=this.options,c=b.rowIndxOffset,e=b.initV,g=b.finalV;if(a<d.freezeRows)return!0;if(d.groupModel){if((b=b.dataGM)&&b.length)for(;e<=g;e++)if(d=b[e].rowIndx-c,null!=d&&d==a)return!0;return!1}return a>=e&&a<=g};h.setDirty=function(){};var c=function(a){this.that=a;this.options=a.options;this.selection=[]};f.paramquery.cRows=c;var e=function(a){this.options=a.options;
this.that=a;this.selection=[]};f.paramquery.cCells=e;h=e.prototype=new m;m=c.prototype=new m;m.extendSelection=function(a){var b=this.that,d=a.rowIndx,c=b.options.selectionModel.mode;a=a.evt;var e=this.getFirstSelection();null==e?b.setSelection({rowIndx:d}):"single"!=c&&(c=b=e.rowIndx,e=d,b>d&&(c=d,e=b),this.selectRange({initRowIndx:c,finalRowIndx:e,evt:a}),this.add({rowIndx:d}))};m.refresh=function(){this.selection=[];var a=this.that,b=a.options,d="remote"==b.pageModel.type?!0:!1,a=a.rowIndxOffset,
c=[];if(b=b.dataModel.data){for(var e=0,g=b.length;e<g;e++){var f=b[e];f.pq_rowselect&&c.push({rowIndx:d?e+a:e,rowData:f})}this.selection=c}};m.replace=function(a){var b=a.rowIndx,d=null==a.offset?this.that.getRowIndxOffset():a.offset;a.offset=d;a.rowIndxPage=b-d;this.removeAll({raiseEvent:!0});this.add(a)};m.indexOf=function(a){this.refresh();a=a.rowIndx;for(var b=this.selection,d=0;d<b.length;d++)if(b[d].rowIndx==a)return d;return-1};m.isSelected=function(a){var b=this.that;return(a=a.rowData||
b.getRowData(a))?null==a.pq_rowselect?!1:a.pq_rowselect:null};m._boundRow=function(a){var b=a.rowIndxPage,d=this.that;a=null==a.$tr?d.getRow({rowIndxPage:b}):a.$tr;if(null==a||0==a.length)return!1;a.addClass("pq-row-select ui-state-highlight");return a};m.selectRange=function(a){var b=a.initRowIndx,d=a.finalRowIndx;a=a.evt;for(var c=this.getSelection().slice(0),e=[],g=0;g<c.length;g++){var f=c[g],h=f.rowIndx;(h<b||h>d)&&e.push({rowIndx:h,rowData:f.rowData})}this.remove({rows:e,evt:a});e=[];b>d&&(c=
b,b=d,d=c);for(h=b;h<=d;h++)e.push({rowIndx:h,evt:a});this.add({rows:e,evt:a})};h._addToData=function(a){var b=a.dataIndx;a=this.that.getRowData(a);a.pq_cellselect||(a.pq_cellselect={});a.pq_cellselect[b]=!0};h.extendSelection=function(a){var b=this.that,d=this.getFirstSelection(),c=a.rowIndx,e=a.colIndx,g=b.options.selectionModel.mode;a=a.evt;if(null==d)b.setSelection({rowIndx:c,colIndx:e});else{var f=d.rowIndx,b=b.getColIndx({dataIndx:d.dataIndx}),d=f,h=c,m=b,n=e;f>c&&(d=c,h=f);"range"==g?(f>c&&
(m=e,n=b),c==f&&e<b&&(m=e,n=b),this.selectRange({initRowIndx:d,initColIndx:m,finalRowIndx:h,finalColIndx:n,evt:a}),this.add({rowIndx:c,colIndx:e})):"block"==g&&(b>e&&(m=e,n=b),this.selectBlock({initRowIndx:d,initColIndx:m,finalRowIndx:h,finalColIndx:n,evt:a}),this.add({rowIndx:c,colIndx:e}))}};h._removeFromData=function(a){var b=a.rowData;b&&b.pq_cellselect&&delete b.pq_cellselect[a.dataIndx]};h.removeAll=function(){this.refresh();var a=this.selection.slice(0);this.remove({cells:a});this.lastSelection=
null};m.removeAll=function(a){if(a&&null!=a.page)throw"objP.page not supported in removeAll";var b=this.that,d=a&&null!=a.all?a.all:!0;this.refresh();a=this.selection.slice(0);if(d)this.remove({rows:a}),this.lastSelection=null;else{for(var d=[],c=b.rowIndxOffset,b=(b=b.pdata)?b.length:0,e=0,g=a.length;e<g;e++){var f=a[e],h=f.rowIndx-c;if(0<=h)if(h<b)d.push(f);else break}this.remove({rows:d})}};h.isSelected=function(a){var b=this.that,d=a.rowData||b.getRowData(a),c=a.dataIndx;a=a.colIndx;if(null==
a&&null==c||null==d)return null;c=null==c?b.colModel[a].dataIndx:c;return d.pq_cellselect&&d.pq_cellselect[c]?!0:!1};h.refresh=function(){this.selection=[];var a=this.that,b=a.options.dataModel.data,d=[],c="remote"==a.options.pageModel.type?!0:!1,a=a.rowIndxOffset,e=this.that.colModel,g=e.length;if(b){for(var f=[],h=0;h<g;h++){var m=e[h].dataIndx;f[h]=m}for(var h=0,n=b.length;h<n;h++){var u=b[h],r=u.pq_cellselect;if(r)for(var t=c?h+a:h,s=0;s<g;s++)m=f[s],r[m]&&d.push({rowIndx:t,rowData:u,dataIndx:m,
colIndx:s,column:e[s]})}this.selection=d}};h.replace=function(a){var b=a.rowIndx,d=null==a.offset?this.that.getRowIndxOffset():a.offset;a.rowIndxPage=b-d;a.offset=d;this.removeAll({raiseEvent:!0});this.add(a)};h.inViewCell=function(a,b){var d=this.that,c=this.options.freezeCols;return this.inViewRow(a)?b<c||b>=d.initH&&b<=d.finalH:!1};h._add=function(a){var b=this.that,d=a.rowIndx,c=a.rowIndxPage,e=a.rowData||b.getRowData(a),g=b.rowIndxOffset,f,d=null==d?c+g:d,c=null==c?d-g:c,g=a.colIndx,h=a.dataIndx,
g=null==g?b.getColIndx({dataIndx:h}):g,m=b.colModel[g],h=null==h?m.dataIndx:h,n=a.evt,u=this.isSelected({rowData:e,dataIndx:h});if(null==u)return!1;var r=this.inViewCell(c,g);if(!1===u){if(r){var t=b.getCell({rowIndxPage:c,colIndx:g});t&&t.addClass("pq-state-select ui-state-highlight")}this._addToData({rowData:e,dataIndx:h});!1!==a.trigger&&b._trigger("cellSelect",n,{rowIndx:d,rowIndxPage:c,colIndx:g,dataIndx:h,column:m,rowData:e});f=!0}this.lastSelection={rowIndx:d,dataIndx:h,rowData:e};!1!==a.focus&&
r&&(t&&t.length||(t=b.getCell({rowIndxPage:c,dataIndx:h})),t&&t.length&&(t.attr("tabindex","0"),t.focus(),this.focusSelection={rowData:e,rowIndx:d,dataIndx:h}));a.setFirst&&(this.firstSelection={rowIndx:d,rowData:e,dataIndx:h});if(f)return{rowIndx:d,rowData:e,dataIndx:h,colIndx:g,column:m}};m._add=function(a){var b=this.that,c,e=a.rowIndx,l=a.rowIndxPage,g=b.rowIndxOffset,e=null==e?l+g:e,l=null==l?e-g:l,h=null==h?b.getRowData(a):h,g=a.$tr,m=a.evt,v=this.isSelected({rowData:h});a.rowIndxPage=l;if(null==
v)return!1;var n=this.inViewRow(l);!1===v&&(n&&(g=this._boundRow(a)),h.pq_rowselect=!0,!1!==a.trigger&&b._trigger("rowSelect",m,{rowIndx:e,rowIndxPage:l,rowData:h,$tr:g}),c=!0);this.lastSelection={rowIndx:e,rowData:h};!1!==a.focus&&n&&(g&&g.length||(g=b.getRow({rowIndxPage:l})),g&&(g=f(g[0]),g.attr("tabindex","0"),g.focus(),this.focusSelection={rowData:h,rowIndx:e}));a.setFirst&&(this.firstSelection={rowIndx:e,rowData:h});if(c)return{rowIndx:e,rowData:h}};h.add=function(a){var b=this.that,c=a.evt,
e=a.cells,f=!1,g=[];if(e&&"function"==typeof e.push){a=0;for(var h=e.length;a<h;a++)f=e[a],f.trigger=!1,(f=this._add(f))&&g.push(f);g.length&&(f=!0,b._trigger("cellSelect",c,{cells:g}))}else f=this._add(a);f&&this.triggerSelectChange({evt:c})};m.add=function(a){var b=this.that,c=a.evt,e=a.rows,f=!1,g=[];if(e&&"function"==typeof e.push){a=0;for(var h=e.length;a<h;a++)f=e[a],f.trigger=!1,(f=this._add(f))&&g.push(f);g.length&&(f=!0,b._trigger("rowSelect",c,{rows:g}))}else f=this._add(a);f&&this.triggerSelectChange({evt:c})};
h._remove=function(a){var b=this.that,c=a.rowIndx,e=a.rowIndxPage,f=b.rowIndxOffset,c=null==c?e+f:c,e=null==e?c-f:e,f=a.rowData||b.getRowData(a),g=a.colIndx,h=a.dataIndx,g=null==g?b.getColIndx({dataIndx:h}):g,m=a.column,m=null==m?b.colModel[g]:m,h=null==h?m.dataIndx:h,v=a.evt;if(this.isSelected({rowData:f,dataIndx:h}))return this.inViewCell(e,g)&&(e=b.getCell({rowIndxPage:e,colIndx:g,all:!0}))&&(e.removeClass("pq-state-select ui-state-highlight"),e.removeAttr("tabindex")),this._removeFromData({rowData:f,
dataIndx:h}),!1!==a.trigger&&b._trigger("cellUnSelect",v,{rowIndx:c,colIndx:g,dataIndx:h,rowData:f}),{rowIndx:c,rowData:f,dataIndx:h,colIndx:g,column:m}};m._remove=function(a){var b=this.that,c=a.rowIndx,e=a.rowIndxPage,f=b.rowIndxOffset,c=null==c?e+f:c,e=null==e?c-f:e,f=a.rowData,f=null==f?b.getRowData(a):f,g=a.$tr,h=a.evt;if(this.isSelected({rowData:f}))return this.inViewRow(e)&&(g=b.getRow({rowIndxPage:e}))&&(g.removeClass("pq-row-select ui-state-highlight"),g.removeAttr("tabindex")),f.pq_rowselect=
!1,!1!==a.trigger&&b._trigger("rowUnSelect",h,{rowIndx:c,rowData:f,$tr:g}),{rowIndx:c,rowData:f}};h.remove=function(a){var b=a.cells,c=a.evt,e=!1;if(b&&"function"==typeof b.push){a=[];for(var f=0,g=b.length;f<g;f++)e=b[f],e.trigger=!1,(e=this._remove(e))&&a.push(e);a.length&&(e=!0,this.that._trigger("cellUnSelect",c,{cells:a}))}else e=this._remove(a);e&&this.triggerSelectChange({evt:c})};m.remove=function(a){var b=a.rows,c=a.evt,e=!1;if(b&&"function"==typeof b.push){a=[];for(var f=0,g=b.length;f<
g;f++)e=b[f],e.trigger=!1,(e=this._remove(e))&&a.push(e);a.length&&(e=!0,this.that._trigger("rowUnSelect",c,{rows:a}))}else e=this._remove(a);e&&this.triggerSelectChange({evt:c})};h.indexOf=function(a){this.refresh();var b=a.rowIndx,c=this.that,c=null==a.dataIndx?c.colModel[a.colIndx].dataIndx:a.dataIndx;a.dataIndx=c;a=this.selection;for(var e=0;e<a.length;e++){var f=a[e];if(f.rowIndx==b&&f.dataIndx==c)return e}return-1};h.selectAll=function(a){var b=this.that,c=a&&a.all?!0:!1;a=c?this.options.dataModel.data:
b.pdata;var e=b.rowIndxOffset,f=b.colModel,g=f.length,h=[],b=function(a,b){for(var c=0;c<g;c++){var d=f[c];d.hidden||h.push({rowIndx:b,rowData:a,colIndx:c,dataIndx:d.dataIndx,focus:!1})}};if(a){for(var m=0,v=a.length;m<v;m++)var n=a[m];if(c)for(c="remote"==this.options.pageModel.type?!0:!1,m=0,v=a.length;m<v;m++){var n=a[m],u=m;c&&(u=m+e);b(n,u)}else for(m=0,v=a.length;m<v;m++)n=a[m],u=m+e,b(n,u);this.add({cells:h})}};m.selectAll=function(a){var b=this.that,c=a&&a.all?!0:!1,b=c?this.options.dataModel.data:
b.pdata;a=[];if(b){if(c)for(var c="remote"==this.options.pageModel.type?!0:!1,e=0,f=b.length;e<f;e++){var g={rowData:b[e],focus:!1};c?g.rowIndxPage=e:g.rowIndx=e;a.push(g)}else for(e=0,f=b.length;e<f;e++)a.push({rowIndxPage:e,rowData:b[e],focus:!1});this.add({rows:a})}};h.selectRange=function(a){var b=this.that,c=a.initRowIndx,e=a.initColIndx,f=a.finalRowIndx;a=a.finalColIndx;for(var g=b.colModel,h=g.length,m=this.getSelection().slice(0),v=[],n=0;n<m.length;n++){var u=m[n],r=u.rowIndx,t=u.dataIndx,
u=b.getColIndx({dataIndx:t});r<c||r>f?v.push({rowIndx:r,colIndx:u,dataIndx:t}):r==c&&u<e?v.push({rowIndx:r,colIndx:u,dataIndx:t}):r==f&&u>a&&v.push({rowIndx:r,colIndx:u,dataIndx:t})}this.remove({cells:v});v=[];for(u=0;u<h;u++)if(b=g[u],!b.hidden){t=b.dataIndx;r=c;do{if(!(r==c&&u<e))if(r==f&&u>a)break;else v.push({rowIndx:r,colIndx:u,dataIndx:t,focus:!1});r++}while(r<=f)}this.add({cells:v})};h.selectBlock=function(a){var b=this.that,c=a.initRowIndx,e=a.initColIndx,f=a.finalRowIndx,g=a.finalColIndx;
a=a.evt;for(var h=this.getSelection().slice(0),m=b.colModel,v=[],n=0;n<h.length;n++){var u=h[n],r=u.rowIndx,u=u.dataIndx,t=b.getColIndx({dataIndx:u});t<e||t>g?v.push({rowIndx:r,colIndx:t,dataIndx:u}):(r<c||r>f)&&v.push({rowIndx:r,colIndx:t,dataIndx:u})}this.remove({cells:v});v=[];for(t=e;t<=g;t++)if(b=m[t],u=b.dataIndx,!b.hidden){r=c;do v.push({rowIndx:r,colIndx:t,dataIndx:u,focus:!1}),r++;while(r<=f)}this.add({cells:v,evt:a})}})(jQuery);
(function(f){var m=(f.paramquery.cCheckBoxColumn=function(h,c){var e=this;this.that=h;this.options=h.options;this.column=c;c.cb=f.extend({},{all:!1,header:!0,select:!0},c.cb);this.dataIndx=c.dataIndx;var a=h.widgetEventPrefix.toLowerCase(),b=h.element,d=h.eventNamespace;b.on(a+"dataavailable"+d,function(a,b){if(e.belongs(a))return e._onDataAvailable(a,b)});b.on(a+"cellclick"+d,function(a,b){if(e.belongs(a))return e.cellClick(a,b)});c.cb.reverse&&(b.on(a+"rowselect"+d,function(a,b){if(e.belongs(a))return e.rowSelect(a,
b)}),b.on(a+"rowunselect"+d,function(a,b){if(e.belongs(a))return e.rowUnSelect(a,b)}));b.on(a+"cellkeydown"+d,function(a,b){if(e.belongs(a))return e.cellKeyDown(a,b)});b.on(a+"refresh"+d+" "+a+"refreshrow"+d,function(a,b){if(e.belongs(a))return e.refreshHeader(a,b)})}).prototype=new f.paramquery.cClass;m.hasHeaderChkBox=function(){return this.column.cb.header};m.setValCBox=function(){if(this.hasHeaderChkBox()){for(var f=this.that,c=this.options,e=this.dataIndx,f=this.column.cb.all?c.dataModel.data:
f.pdata,c=null,a=0,b=0,d=0,k=f.length;d<k;d++)f[d][e]?a++:b++;a==k?c=!0:b==k&&(c=!1);this.$inp.pqval({val:c})}};m.onHeaderClick=function(h){var c=this.that,e=f(h.currentTarget).find("input"),a=this.column,b=a.dataIndx,d=c.getColIndx({dataIndx:b}),k=a.cb,l=k.all?c.options.dataModel.data:c.pdata,a={column:a,dataIndx:b,source:"header"},g=f(h.target).is("input")?!0:!1,m=e.is(":checked"),p=m;g||(p=!m);if(p){if(!1===c._trigger("beforeCheck",h,a))return!1;g||e.pqval({val:!0});e=0;for(g=l.length;e<g;e++)m=
l[e],m[b]=!0;c.$tbl.children().children().children("[pq-col-indx="+d+"]").find("input").prop("checked",!0);!1!==c._trigger("check",h,a)&&k.select&&this.selectAllRows()}else{if(!1===c._trigger("beforeunCheck",h,a))return!1;g||e.pqval({val:!1});e=0;for(g=l.length;e<g;e++)m=l[e],m[b]=!1;c.$tbl.children().children().children("[pq-col-indx="+d+"]").find("input").prop("checked",!1);!1!==c._trigger("unCheck",h,a)&&k.select&&this.unSelectAllRows()}};m.refreshHeader=function(f,c){if(this.hasHeaderChkBox()){var e=
this.that;if(e.pdata){var a=this;if(e=e.getCellHeader({dataIndx:this.dataIndx}))e.html("<input type='checkbox'/>"),this.$inp=e.find("input"),e.click(function(b){return a.onHeaderClick(b)}),this.setValCBox()}}};m.selectAllRows=function(){this.that.iRows.selectAll({all:this.column.cb.all})};m.unSelectAllRows=function(){this.that.iRows.removeAll({all:this.column.cb.all})};m._onDataAvailable=function(){var f=this.that,c=this.options,e=c.dataModel.data,c="remote"==c.pageModel.type?f.rowIndxOffset:0,a=
this.column,b=a.cb,d=a.dataIndx;if(null!=d&&e){for(var k=[],l=0,g=e.length;l<g;l++){var m=e[l];m[d]&&k.push({rowIndx:l+c,rowData:m})}if(!1!==f._trigger("check",null,{rows:k,column:a,dataIndx:d,source:"dataAvailable"})&&b.select)for(l=0;l<g;l++)m=e[l],m[d]&&(m.pq_rowselect=!0)}};m.cellClick=function(f,c){if(c.dataIndx===this.dataIndx)return this.raiseEvent(f,c)};m.rowSelect=function(f,c){var e=this.that,a=c.rows,b=c.rowData,d=this.dataIndx;if(a)for(var k=0,l=a.length;k<l;k++){var b=a[k],g=b.rowIndx,
b=b.rowData;b[d]=!0;e.refreshCell({rowIndx:g,dataIndx:d})}else b&&(b[d]=!0,g=c.rowIndx,e.refreshCell({rowIndx:g,dataIndx:d}));this.setValCBox()};m.rowUnSelect=function(f,c){var e=this.that,a=c.rows,b=c.rowData,d=this.dataIndx;if(a)for(var k=0,l=a.length;k<l;k++){var b=a[k],g=b.rowIndx,b=b.rowData;b[d]=!1;e.refreshCell({rowIndx:g,dataIndx:d})}else b&&(b[d]=!1,g=c.rowIndx,e.refreshCell({rowIndx:g,dataIndx:d}));this.setValCBox()};m.raiseEvent=function(h,c){var e=this.that,a=c.rowData,b=this.column.cb,
d=f(h.originalEvent.target).is("input")?!0:!1,k=c.rowIndx,l=c.dataIndx;if(a[l]){if(!1===e._trigger("beforeunCheck",h,c))return!1;a[l]=!1;d||(a=e.getCell(c).find("input"),a.pqval({val:!1}));!1!==e._trigger("unCheck",h,c)&&b.select&&e.iRows.remove({rowIndx:k})}else{if(!1===e._trigger("beforeCheck",h,c))return!1;a[l]=!0;d||(a=e.getCell(c).find("input"),a.pqval({val:!0}));!1!==e._trigger("check",h,c)&&b.select&&e.iRows.add({rowIndx:k})}this.setValCBox();if(!d)return!1};m.cellKeyDown=function(f,c){if(c.dataIndx=
this.dataIndx)if(13==f.keyCode||32==f.keyCode)return this.raiseEvent(f,c)}})(jQuery);
(function(){for(var f=0,m=["moz","webkit"],h=0;!window.requestAnimationFrame&&h<m.length;h++)window.requestAnimationFrame=window[m[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[m[h]+"CancelAnimationFrame"]||window[m[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c){var e=(new Date).getTime(),e=Math.max(0,16-(e-f));return window.setTimeout(function(){f=(new Date).getTime();c()},e)});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(c){clearTimeout(c)})})();
(function(f){function m(c){this.that=c;var a=this,b=c.element,d=c.widgetEventPrefix.toLowerCase(),f=c.eventNamespace;this.borderBottomExtra=this.borderBottom=this.borderLeftExtra=this.borderLeft=this.borderTopExtra=this.borderTop=this.borderRightExtra=this.borderRight=this.scrollLeft=this.scrollTop=0;this.maxBorder=5E3;this.rowht=c.options.rowHeight;this.colwd=60;b.on(d+"contmousedown"+f,function(b,c){if(a.belongs(b))return a._onContMouseDown(b,c)}).on(d+"mousedrag"+f,function(b,c){if(a.belongs(b)&&
a.swipedown)return a._onMouseDrag(b,c)}).on(d+"mousestop"+f,function(b,c){return a._onMouseStop(b,c)}).on(d+"mousepqup"+f,function(b,c){return a._onMousePQUp(b,c)}).on(d+"rowmousedown"+f,function(b,c){if(a.belongs(b))return a._onRowMouseDown(b,c)}).on(d+"cellmousedown"+f,function(b,c){if(a.belongs(b))return a._onCellMouseDown(b,c)}).on(d+"beforetableview"+f,function(b,c){if(a.belongs(b))return a._beforeTableView(b,c)}).on(d+"refresh"+f,function(b,c){if(a.belongs(b))return a._onRefresh(b,c)}).on(d+
"cellmouseenter"+f,function(b,c){if(a.belongs(b))return a._onCellMouseEnter(b,c)}).on(d+"rowmouseenter"+f,function(b,c){if(a.belongs(b))return a._onRowMouseEnter(b,c)})}var h=f.paramquery.pqgrid.calcWidthCols;f.paramquery.cMouseSelection=m;var c=m.prototype=new f.paramquery.cClass;c._beforeTableView=function(c,a){var b=this.that,d=b.getFocusElement();this.lastFocus=null;d&&d.$grid&&(d=d.$ae,d.hasClass("pq-grid-row")?this.lastFocus=b=b.getRowIndx({$tr:d}):d.hasClass("pq-grid-cell")&&(this.lastFocus=
b=b.getCellIndices({$td:d})))};c.inViewPort=function(c){var a=this.that.iRefresh,b=a.getEContHt(),a=a.getEContWd()+1;c=c[0];var d=this.scrollLeft;if(b>=c.offsetTop+c.offsetHeight+this.marginTop)if("TD"==c.nodeName.toUpperCase()){if(a>=c.offsetLeft+c.offsetWidth+d)return!0}else return!0};c._onRefresh=function(c,a){var b=this.that,d=this.lastFocus;d&&(b=null!=d.dataIndx?b.getCell(d):b.getRow(d))&&b.length&&b.attr("tabindex","0").focus()};c._onCellMouseDown=function(c,a){var b=this.that,d=a.rowIndx,
f=a.colIndx,l=b.options.selectionModel,g=l.mode;if("cell"==l.type&&null!=f)return c.shiftKey?(b.iCells.extendSelection({rowIndx:d,colIndx:f,mode:g,evt:c}),c.preventDefault()):(c.ctrlKey||c.metaKey)&&"single"!=g?b.iCells.isSelected({rowIndx:d,colIndx:f})?b.iCells.remove({rowIndx:d,colIndx:f}):b.iCells.add({rowIndx:d,colIndx:f}):l.addon?b.iCells.isSelected({rowIndx:d,colIndx:f})?b.iCells.remove({rowIndx:d,colIndx:f}):(b.iCells.add({rowIndx:d,colIndx:f}),this.mousedown={r1:d,c1:f}):(this.mousedown={r1:d,
c1:f},b.setSelection(null),b.iCells.add({rowIndx:d,colIndx:f,setFirst:!0})),!0};c._onCellMouseEnter=function(c,a){var b=this.that;if("cell"==b.options.selectionModel.type&&this.mousedown){var d=this.mousedown,f=d.c1,l=a.rowIndx,g=a.colIndx;if(d.r1!=l||f!=g)if(d.r2!=l||d.c2!=g)this.mousedown.r2=l,this.mousedown.c2=g,b.scrollCell({rowIndx:l,colIndx:g}),b.iCells.extendSelection({rowIndx:l,colIndx:g,evt:c})}};c._onRowMouseEnter=function(c,a){var b=this.that;if("row"==b.options.selectionModel.type&&this.mousedown){var d=
a.rowIndx;this.mousedown.r1!=d&&this.mousedown.r2!=d&&(this.mousedown.r2=d,b.scrollRow({rowIndx:d}),b.iRows.extendSelection({rowIndx:d,evt:c}))}};c._onRowMouseDown=function(c,a){var b=this.that,d=a.rowIndx,f=b.options.selectionModel,l=f.mode;if("row"==f.type&&null!=d)return c.shiftKey?(b.iRows.extendSelection({rowIndx:d,evt:c}),c.preventDefault()):(c.ctrlKey||c.metaKey)&&"single"!=l?b.iRows.isSelected({rowIndx:d})?b.iRows.remove({rowIndx:d}):b.iRows.add({rowIndx:d}):(this.mousedown={r1:d,y1:c.pageY,
x1:c.pageX},b.setSelection(null),b.iRows.add({rowIndx:d,setFirst:!0})),!0};c._onContMouseDown=function(c,a){this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown={x:c.pageX,y:c.pageY});return!0};c._onMousePQUp=function(c,a){this.mousedown=null};c._stopSwipe=function(c){c&&(this.swipedownPrev=this.swipedown=null);window.clearInterval(this.intID);window.cancelAnimationFrame(this.intID);this.intID=null};c._onMouseStop=function(c,a){var b=this,d=this.that;if(this.swipedownPrev){var f=d.options.swipeModel,
d=this.swipedownPrev,l=d.ts,g=(new Date).getTime()-l,h=c.pageX,m=c.pageY,v=h-d.x,n=m-d.y;if(Math.sqrt(v*v+n*n)/g>f.ratio){var u=0,r=f.repeat;b._stopSwipe();var t=function(){u+=f.speed;r--;b._onMouseDrag({pageX:h+u*v/g,pageY:m+u*n/g});0<r?b.intID=window.requestAnimationFrame(t):b._stopSwipe(!0)};t()}else b.swipedown=null,b.swipedownPrev=null}};c._onMouseDrag=function(c,a){var b=this.that.options;if(this.swipedown){var d=this.swipedown,f=d.x,l=d.y,g=c.pageX,h=c.pageY;this.swipedownPrev={x:f,y:l,ts:(new Date).getTime()};
var m=b.scrollModel.smooth;if(!b.virtualY||m)this.scrollVertSmooth(l,h),this.syncScrollBarVert();b.virtualX&&!m||"flex"===b.width||(this.scrollHorSmooth(f,g),this.syncScrollBarHor());d.x=g;d.y=h}return!0};c.updateTableY=function(c){if(0==c)return!1;var a=this.that,b=this.getTableForVertScroll(),a=a.iRefresh.getEContHt();if(!b||!b.length)return!1;var d=b.data("offsetHeight")-1,f=this.scrollTop-c;this.setScrollTop(0>f?0:0>c&&0<a-d+f?d-a:f,b,a);return!0};c.setScrollTop=function(c,a,b){0<=c&&(this.scrollTop=
c=Math.round(c),a.parent("div").scrollTop(c))};c.getScrollLeft=function(c){return this.scrollLeft};c.getScrollTop=function(c){return this.scrollTop};c.setScrollLeft=function(c,a,b,d){0<=c&&(this.scrollLeft=c=Math.round(c),b=b?b.parent():f(),b=b.add(a?a.parent("div"):f()),b.scrollLeft(c))};c.scrollVertSmooth=function(c,a){c!=a&&this.updateTableY(a-c)};c.scrollHorSmooth=function(c,a){if(c!=a){var b=this.that,d=b.options,f=a-c,l=this.getTableForHorScroll(),g=this.getTableHeaderForHorScroll(),b=b.iRefresh.getEContWd();
if(l||g){var h=l?l:g,d=d.virtualX?this.getScrollWidth(h):h.data("scrollWidth"),f=this.scrollLeft-f;this.setScrollLeft(0>f?0:0>d-b-f?d-b:f,l,g,b)}}};c.syncViewWithScrollBarVert=function(c){if(null!=c){var a=this.that,b=this.getTableForVertScroll();if(b&&b.length){var d=a.options;d.editModel.indices&&a.blurEditor({force:!0});var f=b.data("offsetHeight"),a=a.iRefresh.getEContHt();c*=f-a;if((!f||!a)&&d.debug)throw"_syncViewWithScrollBarVert !scrollHt || !contHt";0>c&&(c=0);this.setScrollTop(c,b,a)}}};
c.syncViewWithScrollBarHor=function(c){if(null!=c){var a=this.that,b=this.getTableForHorScroll(),d=this.getTableHeaderForHorScroll();if(b||d){var f=a.options;f.editModel.indices&&a.blurEditor({force:!0});var l=b?b:d,f=f.virtualX?this.getScrollWidth(l):l.data("scrollWidth"),a=a.iRefresh.getEContWd();c*=f-a;f&&a&&(0>c&&(c=0),this.setScrollLeft(c,b,d,a))}}};c.resetMargins=function(){this.scrollTop=this.scrollLeft=0};c.syncHeaderViewWithScrollBarHor=function(c){if(null!=c){var a=this.that,b=this.getTableHeaderForHorScroll();
if(b){var d=a.options,f=d.freezeCols;d.editModel.indices&&a.blurEditor({force:!0});var d=b.data("scrollWidth"),l=a.iRefresh.getEContWd();c=h.call(a,f,c+f);d&&l&&(0>c&&(c=0),b.css("marginLeft",-c))}}};c.syncScrollBarVert=function(){var c=this.that,a=this.getTableForVertScroll();if(a&&a.length){var a=a.data("offsetHeight"),b=c.iRefresh.getEContHt(),a=this.scrollTop/(a-b);0<=a&&1>=a&&c.$vscroll.hasClass("pq-sb-vert")&&c.$vscroll.pqScrollBar("option","ratio",a)}};c.syncScrollBarHor=function(){var c=this.that,
a=c.options,b=this.getTableForHorScroll(),d=this.getTableHeaderForHorScroll();if(b||d)b=b?b:d,a=a.virtualX?this.getScrollWidth(b):b.data("scrollWidth"),b=c.iRefresh.getEContWd(),a=this.scrollLeft/(a-b),0<=a&&1>=a&&c.$hscroll.hasClass("pq-sb-horiz")&&c.$hscroll.pqScrollBar("option","ratio",a)};c.getTableForVertScroll=function(){var c=this.that,a=c.pqpanes;if((c=c.$tbl)&&c.length)return a.h&&a.v?c=f([c[2],c[3]]):a.v?c=f([c[0],c[1]]):a.h&&(c=f(c[1])),c};c.getTableForHorScroll=function(){var c=this.that,
a=c.pqpanes,b=[],d=c.$tbl;if(d&&d.length)return a.h&&a.v?b.push(d[1],d[3]):a.v?b.push(d[1]):a.h?b.push(d[0],d[1]):b.push(d[0]),c.tables.length&&(c=c.tables[0].$tbl,a.v?b.push(c[1]):b.push(c[0])),f(b)};c.getTableHeaderForHorScroll=function(){var c=this.that,a=c.pqpanes;if((c=c.$tbl_header)&&c.length)return c=a.vH?f(c[1]):f(c[0]),c.parent()};c.scrollRowNonVirtual=function(c){var a=this.that,b=a.options,d=c.rowIndxPage,f=c.rowIndx;c=a.iRefresh.getEContHt();d=null==d?f-a.rowIndxOffset:d;b=parseInt(b.freezeRows);
if(!(d<b)){var b=a.get$Tbl(d),l=a.getRow({rowIndxPage:d})[0];l&&(a=b[0].offsetTop+1,d=l.offsetHeight,f=this.getScrollTop(),l=l.offsetTop,0>a+l-f?(a=a+l+-1,this.setScrollTop(0>a?0:a,b,c),this.syncScrollBarVert()):l+d-f>c&&(this.setScrollTop(d+l-c,b,c),this.syncScrollBarVert()))}};c.scrollColumnNonVirtual=function(c){var a=this.that,b=c.colIndx,b=null==b?a.getColIndx({dataIndx:c.dataIndx}):b,d=a.options.freezeCols;if(!(b<d)){c=a._calcRightEdgeCol(b).width;var b=a._calcRightEdgeCol(b-1).width,d=a._calcRightEdgeCol(d-
1).width,f=this.getTableForHorScroll(),l=this.getTableHeaderForHorScroll(),a=a.iRefresh.getEContWd(),g=this.scrollLeft;c-g>a?(this.setScrollLeft(c-a,f,l,a),this.syncScrollBarHor()):b-d<g&&(this.setScrollLeft(b-d,f,l,a),this.syncScrollBarHor())}}})(jQuery);
(function(f){var m=null,h=!1,c="",e=f.paramquery.pqGrid.prototype,a=e.options,b={on:!0,header:!0,zIndex:1E4},d={on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"};e.copy=function(){m=new k(this);m.copy();m=null};e.paste=function(){m=new k(this);m.paste();m=null};a.pasteModel=a.pasteModel||d;a.copyModel=a.copyModel||b;var k=function(a,c){var b;this.that=a;c&&c.hasClass("pq-grid-row")?(this.rowIndx=a.getRowIndx({$tr:c}).rowIndx,this.dataIndx=null):c&&c.hasClass("pq-grid-cell")?
(b=a.getCellIndices({$td:c}),this.rowIndx=b.rowIndx,this.dataIndx=b.dataIndx):this.dataIndx=this.rowIndx=null},e=k.prototype;e.createClipBoard=function(){var a=f("#pq-grid-excel-div"),a=this.that.options.copyModel,c=f("#pq-grid-excel");0==c.length&&(a=f("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+a.zIndex+";'/>").appendTo(document.body),c=f("<textarea id='pq-grid-excel' autocomplete='off'  style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(a),
c.css({opacity:0}));c.select()};e.destroyClipBoard=function(){var a=this.that,c,b=a.iCells.getFocusSelection({old:!0});b?c=a.getCell({rowIndx:b.rowIndx,dataIndx:b.dataIndx}):(b=a.iRows.getFocusSelection({old:!0}))&&(c=a.getRow({rowIndx:b.rowIndx}));var b=f(window).scrollTop(),d=f(window).scrollLeft();c?c.attr("tabindex",0).focus():a.$cont.focus();a=f(window).scrollTop();c=f(window).scrollLeft();b==a&&d==c||window.scrollTo(d,b)};e.clearClipBoard=function(){f("#pq-grid-excel").val("")};e.copy=function(){var a=
f("#pq-grid-excel"),b=this.that,d=b.colModel,e=d.length,k=b.iGenerateView.readCell,h=[],m=[];if(b.options.copyModel.on){for(var h=b.iRows.getSelection(),r=0,t=h.length;r<t;r++){for(var s=h[r],y=s.rowData,x=[],w=0;w<e;w++)s=d[w],!1!==s.copy&&x.push(k(y,s));w=x.join("\t");m.push(w)}h=b.iCells.getSelection();d=b=null;x=[];r=0;for(t=h.length;r<t;r++)s=h[r],b=s.rowIndx,y=s.rowData,s=s.column,!1!==s.copy&&(null!=d&&b!=d?(w=x.join("\t"),x=[],m.push(w),d=b):null==d&&(d=b),x.push(k(y,s)));m.push(x.join("\t"));
w=m.join("\n");a.length&&(a.val(w),a.select());c=w}};e.paste=function(){var a=this.that,b=f("#pq-grid-excel"),d=b.length?b.val():c,d=d.replace(/\n$/,""),b=d.split("\n"),e=b.length,k,h=a.colModel,m=a.iGenerateView.readCell,r=a.options.pasteModel,t="row",s=h.length;if(r.on&&0!=d.length&&0!=e){d={rows:b};if(!1===a._trigger("beforePaste",null,d))return!1;var d=r.type,y,x,w,A,z=a.iRows.getSelectionCurPage();z&&z.length||(t="cell",z=a.iCells.getSelectionCurPage());z&&z.length?(y=z[0].rowIndx,w=z[z.length-
1].rowIndx,"cell"==t&&(x=a.getColIndx({dataIndx:z[0].dataIndx}),A=a.getColIndx({dataIndx:z[z.length-1].dataIndx}))):A=x=w=y=0;var F,B;"replace"==d?(F=y,B=w-y+1<e?"extend":"repeat"):"append"==d?(F=w+1,B="extend"):"prepend"==d&&(F=y,B="extend");var E;y="extend"==B?e:w-y+1;var C;w=0;for(var z=[],G=e=0;G<y;G++){var D=b[w],H=G+F,I="replace"==d?a.getRowData({rowIndx:H}):null,M=I?{}:null,K={};void 0===D&&"repeat"===B&&(w=0,D=b[w]);w++;var N=D.split("\t");if(!k)if("cell"==t){k=N.length;E=A-x+1<N.length?"extend":
"repeat";k="extend"==E?k:A-x+1;if(isNaN(k))throw"lenH NaN. assert failed.";k+x>s&&(k=s-x)}else k=s,x=0;var Q=0,U=0,D=0;C=k;for(U=0;U<C;U++){var L=h[U+x],J=N[Q],P=L.dataIndx;L.hidden?"extend"==E&&C+x<s&&C++:(void 0===J&&"repeat"===E&&(Q=0,J=N[Q]),Q++,K[P]=J,M&&(M[P]=m(I,L)))}!1==f.isEmptyObject(K)&&(N="update",null==I&&(N="add"),z.push({newRow:K,rowIndx:H,rowData:I,oldRow:M,type:N}),e++)}d={rowList:z,source:"paste",allowInvalid:r.allowInvalid,validate:r.validate};a._digestData(d);r.select&&("cell"==
t?a.iCells.selectBlock({initRowIndx:F,finalRowIndx:F+e-1,initColIndx:x,finalColIndx:"extend"==E?x+k-1+D:A}):a.iRows.selectRange({initRowIndx:F,finalRowIndx:F+e-1}));a.refreshView();d={rows:b};a._trigger("paste",null,d)}};f(document).unbind(".pqExcel").bind("keydown.pqExcel",function(a){if(a.ctrlKey||a.metaKey){var b=f(a.target);if(b.hasClass("pq-grid-row")||b.hasClass("pq-grid-cell")||b.is("#pq-grid-excel")||b.is("div.pq-grid-cont")){var c=b.closest(".pq-grid");if(m||b.length&&c.length){if(!m){try{var d=
c.pqGrid("getInstance").grid}catch(e){return!0}m=new k(d,b);m.createClipBoard()}"67"==a.keyCode||"99"==a.keyCode?m.copy():"86"==a.keyCode||"118"==a.keyCode?(h=!0,m.clearClipBoard(),window.setTimeout(function(){m&&(m.paste(),m.destroyClipBoard(),m=null);h=!1},0)):(b=f("#pq-grid-excel"),b.length&&document.activeElement==b[0]&&m.that._onKeyPressDown(a))}}}}).bind("keyup.pqExcel",function(a){var b=a.keyCode;h||!m||a.ctrlKey||a.metaKey||-1==f.inArray(b,[17,91,93,224])||(m.destroyClipBoard(),m=null)})})(jQuery);
(function(f){var m=f.paramquery.pqGrid.prototype.options,h={on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};m.historyModel=m.historyModel||h;m=(f.paramquery.cHistory=function(c){var e=this;this.that=c;this.options=c.options;this.records=[];this.id=this.counter=0;var a=c.eventNamespace,b=c.widgetEventPrefix.toLowerCase();c.element.on(b+"keydown"+a,function(a,b){if(e.belongs(a))return e._onKeyDown(a,b)});c.element.on(b+"dataavailable"+a,function(a,b){e.belongs(a)&&"filter"!=b.source&&e.reset()})}).prototype=
new f.paramquery.cClass;m._onKeyDown=function(c,e){var a=c.ctrlKey||c.metaKey;if(a&&"90"==c.keyCode)return this.undo(),!1;if(a&&"89"==c.keyCode)return this.redo(),!1};m.resetUndo=function(){if(0==this.counter)return!1;this.counter=0;this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})};m.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[];this.id=this.counter=0;this.that._trigger("history",
null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})};m.increment=function(){var c=this.records,e=c.length;this.id=e?c[e-1].id+1:0};m.push=function(c){var e=this.canRedo(),a=this.records,b=this.counter;a.length>b&&a.splice(b,a.length-b);a[b]=f.extend({id:this.id},c);this.counter++;c=this.that;var d,k;1==this.counter&&(d=!0);e&&this.counter==a.length&&(k=!1);c._trigger("history",null,{type:"add",canUndo:d,canRedo:k,num_undo:this.counter,num_redo:0})};m.canUndo=function(){return 0<this.counter?
!0:!1};m.canRedo=function(){return this.counter<this.records.length?!0:!1};m.undo=function(){var c=this.canRedo(),e=this.that,a=this.options.historyModel,b=this.records;if(0<this.counter)this.counter--;else return!1;for(var b=b[this.counter].rowList,d=[],f=0,h=b.length;f<h;f++){var g=b[f],m=g.newRow,p=g.rowData,v=g.type,n=g.oldRow,g=g.rowIndx;"update"==v?(g=e.getRowIndx({rowData:p}).rowIndx,d.push({type:v,rowIndx:g,rowData:p,oldRow:m,newRow:n})):"add"==v?d.push({type:"delete",rowData:m}):"delete"==
v&&d.push({type:"add",rowIndx:g,newRow:p})}e._digestData({history:!1,source:"undo",checkEditable:a.checkEditable,checkEditableAdd:a.checkEditableAdd,allowInvalid:a.allowInvalid,rowList:d});e.refreshView();var u,r;!1===c&&(u=!0);0==this.counter&&(r=!1);e._trigger("history",null,{canUndo:r,canRedo:u,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter});return!0};m.redo=function(){var c=this.canUndo(),e=this.that,a=this.options.historyModel,b=this.counter,d=this.records;if(b==
d.length)return!1;for(var b=d[b].rowList,f=[],h=0,g=b.length;h<g;h++){var m=b[h],p=m.newRow,v=m.rowData,n=m.type,u=m.oldRow,m=m.rowIndx;"update"==n?(m=e.getRowIndx({rowData:v}).rowIndx,f.push({type:n,rowIndx:m,rowData:v,oldRow:u,newRow:p})):"add"==n?f.push({type:"add",rowIndx:m,newRow:p}):"delete"==n&&f.push({type:"delete",rowData:v})}e._digestData({history:!1,source:"redo",checkEditable:a.checkEditable,checkEditableAdd:a.checkEditableAdd,allowInvalid:a.allowInvalid,rowList:f});e.refreshView();this.counter<
d.length&&this.counter++;var r,t;!1==c&&(r=!0);this.counter==this.records.length&&(t=!1);e._trigger("history",null,{canUndo:r,canRedo:t,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter});return!0};f.paramquery.pqGrid.prototype.history=function(c){return this.iHistory[c.method](c)}})(jQuery);
(function(f){var m=f.ui.autocomplete.prototype,h=m._renderMenu,c=m._renderItem;m._renderMenu=function(c,a){h.call(this,c,a);var b=this.options.selectItem;if(b&&b.on){var b=b.cls,b=void 0===b?"ui-state-highlight":b,d=this.element.val();d&&b&&f("a",c).filter(function(){return f(this).text()===d}).addClass(b)}};m._renderItem=function(e,a){var b=c.call(this,e,a),d=this.options.highlightText;if(d&&d.on){var f=this.element.val();if(f){var f=new RegExp("("+f+")","i"),h=a.label;if(f.test(h)){var g=d.style,
d=d.cls,h=h.replace(f,"<span style='"+(void 0===g?"font-weight:bold;":g)+"' class='"+(void 0===d?"":d)+"'>$1</span>");b.find("a").html(h)}}}return b};f.widget("paramquery.pqTooltip",f.ui.tooltip,{options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var c=f(this),a=c.closest(".pq-grid").pqGrid("getInstance").grid,b=a.getCellIndices({$td:c});return(a=a.data({rowIndx:b.rowIndx,dataIndx:b.dataIndx,data:"pq_valid"}).data)?(c=a.icon,a=a.msg,(""==
c?"":"<span class='ui-icon "+c+" pq-tooltip-icon'></span>")+(null!=a?a:"")):c.attr("title")}},_create:function(){this._super();var c=this.element,a=this.eventNamespace;c.on("pqtooltipopen"+a,function(a,c){var e=f(a.target),h=f(a.originalEvent.target);h.on("remove",function(a){e.pqTooltip("close",a,!0)});c.tooltip.css("zIndex",h.zIndex()+5);if(e.is(".pq-grid")){var g=e.pqGrid("getCellIndices",{$td:h}),m=g.dataIndx,p;(p=e.pqGrid("getRowData",{rowIndx:g.rowIndx}))&&(p=p.pq_celldata)&&(p=p[m])&&(p=p.pq_valid)&&
(m=p,g=m.style,c.tooltip.addClass(m.cls),m=c.tooltip.attr("style"),c.tooltip.attr("style",m+";"+g));e.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(a,b){a.currentTarget=h[0];e.pqTooltip("close",a,!0)})}});c.on("pqtooltipclose"+a,function(a,c){var e=f(a.target);f(a.originalEvent.target).off("remove");e.is(".pq-grid")&&e.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})}})})(jQuery);
(function(f){f.paramquery.filter=function(){var c={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",
TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}};return{conditions:c,getAllConditions:function(){var e=[],a;for(a in c)e.push(a);return e}(),getConditions:function(e){var a=[],b;for(b in c)c[b][e]&&
a.push(b);return a},getTRConditions:function(){var e=[],a;for(a in c)c[a].TR&&e.push(a);return e}(),getWTRConditions:function(){var e=[],a;for(a in c)c[a].TR||e.push(a);return e}()}}();f.paramquery.filter.rules={};f.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",
great:"Great Than",gte:"Greater than or equal"};var m=function(c){this.that=c};f.paramquery.cFilterData=m;var h=m.prototype;m.conditions={equal:function(c,e){if(c==e)return!0},contain:function(c,e){if(-1!=c.indexOf(e))return!0},notcontain:function(c,e){if(-1==c.indexOf(e))return!0},empty:function(c){if(0==c.length)return!0},notempty:function(c){if(0<c.length)return!0},begin:function(c,e){if(0==(c+"").indexOf(e))return!0},notbegin:function(c,e){if(0!=c.indexOf(e))return!0},end:function(c,e){var a=
c.lastIndexOf(e);if(-1!=a&&a+e.length==c.length)return!0},notend:function(c,e){var a=c.lastIndexOf(e);if(-1==a||a+e.length!=c.length)return!0},regexp:function(c,e){if(e.test(c))return e.lastIndex=0,!0},notequal:function(c,e){if(c!=e)return!0},great:function(c,e){if(c>e)return!0},gte:function(c,e){if(c>=e)return!0},between:function(c,e,a){if(c>=e&&c<=a)return!0},range:function(c,e){if(-1!=f.inArray(c,e))return!0},less:function(c,e){if(c<e)return!0},lte:function(c,e){if(c<=e)return!0}};m.convert=function(c,
e){c=null==c?"":c;"string"==e?c=f.trim(c).toUpperCase():"date"==e?c=Date.parse(c):"integer"==e?c=parseInt(c):"float"==e?c=parseFloat(c):"bool"==e&&(c=String(c).toLowerCase());return c};h.isMatchCellSingle=function(c,e){var a=c.dataType,b=c.value,d=c.value2,f=c.cbFn,h=e[c.dataIndx],h="regexp"==c.condition?null==h?"":h:m.convert(h,a);return f(h,b,d)?!0:!1};h.isMatchRow=function(c,e,a){if(0==e.length)return!0;for(var b=0;b<e.length;b++){var d=this.isMatchCell(e[b],c);if("OR"==a&&d)return!0;if("AND"==
a&&!d)return!1}if("AND"==a)return!0;if("OR"==a)return!1};h.getQueryStringFilter=function(){var c=this.that,e=c.options,a=e.stringify,e=e.filterModel,b=e.mode,c=this.getFilterData({CM:c.colModel,location:"remote"}),d="";e&&e.on&&c&&(c.length?(e={mode:b,data:c},d=!1===a?e:JSON.stringify(e)):d="");return d};h.filterLocalData=function(c){c=c||{};var e=this.that,a=c.apply;c=this.getFilterData({CM:!1===a?c.CM:e.colModel});var b=e.options,d=b.dataModel,f=e.iSort,h=d.data,g=d.dataUF,m=b.filterModel,p=m.multiple,
b=m?m.mode:null;h||(h=d.data=[]);g||(g=d.dataUF=[]);!1===a&&(h=h.slice());if(g.length)h.push.apply(h,g),0==f.readSorter().length&&f.sortLocalData(h),g=d.dataUF=[];else if(c.length)f.saveOrder();else return{data:h,dataUF:g};this.isMatchCell=p?this.isMatchCellMultiple:this.isMatchCellSingle;if(m.on&&b&&c&&c.length&&h.length)for(d=h.length-1;0<=d;d--)this.isMatchRow(h[d],c,b)||g.push(h.splice(d,1)[0]);!1!==a&&(e._queueATriggers.filter={ui:{type:"local",filter:c}});return{data:h,dataUF:g}};h.getFilterData=
function(c){var e=c.CM;if(!e)throw"CM N/A";var a=e.length,b=c.location;c=this.that.options.filterModel.multiple;for(var d=f.paramquery.filter.getAllConditions,h=f.paramquery.filter.getTRConditions,m=[],g=f.paramquery.cFilterData,q=function(a,b,c){return"function"==typeof a?!0:"between"==a?null!=b&&""!==b||null!=c&&""!==c?!0:!1:-1!=f.inArray(a,d)?null!=b&&""!==b||-1==f.inArray(a,h)?!0:!1:!0},p=function(a,c){return"remote"==b?(null==a?"":a).toString():g.convert(a,c)},v=0;v<a;v++){var n=e[v],u=n.dataIndx,
r=n.dataType,r=r&&"function"!=typeof r?r:"string",t=n.filter;if(c){if((t=n.filterModel)&&t.on){for(var s=[],y=t.mode,x=t.filters,n=0;n<x.length;n++){var t=x[n],w=t.value,A=t.condition;q(A,w)&&(w=p(w,r),s.push({value:w,condition:A}))}m.push({dataIndx:u,mode:y,dataType:r,filters:s})}}else if(t&&t.on&&(w=t.value,s=t.value2,A=t.condition,q(A,w,s))){if("between"==A)""===w||null==w?(A="lte",w=p(s,r)):""===s||null==s?(A="gte",w=p(w,r)):(w=p(w,r),s=p(s,r));else if("regexp"==A)if("remote"==b)w=w.toString();
else{if("string"==typeof w)try{var z=t.modifiers,z=z?z:"gi",w=new RegExp(w,z)}catch(F){w=/.*/}}else if("range"==A)if(null==w)continue;else if("string"==typeof w)w=p(w,r),w=w.split(/\s*,\s*/);else{if(w&&"function"==typeof w.push){if(0==w.length)continue;w=w.slice();n=0;for(t=w.length;n<t;n++)w[n]=p(w[n],r)}}else w=p(w,r);m.push({dataIndx:u,value:w,value2:s,condition:A,dataType:r,cbFn:"remote"==b?"":"function"==typeof A?A:g.conditions[A]})}}return m}})(jQuery);
(function(f){f=(f.paramquery.cSort=function(f){this.that=f;this.sorters=[];this.cancel=!1}).prototype;f.cancelSort=function(){this.cancel=!0};f.resumeSort=function(){this.cancel=!1};f.readSorter=function(){var f=this.that.options,h=f.groupModel,c=h?h.dataIndx:null,e=h?h.dir:null,a=[];if(h&&c)for(h=0;h<c.length;h++)a.push({dataIndx:c[h],dir:e&&e[h]?e[h]:"up"});c=f.sortModel;f=c.sorter;c=c.single;f&&f.length&&(c&&(f=[f[0]]),a=a.concat(f));return a};f.setSingle=function(f){this.single=f};f.getSingle=
function(){return this.single};f.readSingle=function(){return this.that.options.sortModel.single};f.writeSingle=function(f){this.that.options.sortModel.single=f};f.setCancel=function(f){this.cancel=f};f.getCancel=function(){return this.cancel};f.readCancel=function(){return this.that.options.sortModel.cancel};f.writeCancel=function(f){this.that.options.sortModel.cancel=f};f.writeSorter=function(f){var h=this.that.options,c=h.sortModel,e=h.groupModel,h=e?e.dataIndx:null,a=e?e.dir:null;if(h){a||(e.dir=
[]);for(e=0;e<h.length;e++){var b=f[e];if(h[e]!=b.dataIndx)throw"gDataIndx!=sorter.dataIndx";a[e]=b.dir}f.splice(0,h.length)}c.sorter=f};f.refreshSorter=function(f){f=f||{};var h=f.sorter,c=h[0].dataIndx,e=h[0].dir,a=f.single,h=f.cancel,b=this.that.options.groupModel,d=b?b.dataIndx:null,k=d?d.length:0,l=-1;f=this.readSorter();if(null==a)throw"sort single N/A";if(b)for(b=0;b<d.length;b++)d[b]==c&&(l=b);-1<l?f[l].dir="up"===f[l].dir?"down":"up":null!=c&&(a?f[k]&&f[k].dataIndx==c?(c=f[k].dir,c="up"===
c?"down":h&&"down"===c?"":"up",""===c?f.length--:f[k].dir=c):f[k]={dataIndx:c,dir:e?e:"up"}:(k=this.inSorters(f,c),-1<k?(c=f[k].dir,"up"==c?f[k].dir="down":h&&"down"==c?f.splice(k,1):1==f.length?f[k].dir="up":f.splice(k,1)):f.push({dataIndx:c,dir:"up"})));return f};f.saveOrder=function(f){var h=this.that.options.dataModel;f=h.data;if(!(!f||!f.length||h.dataUF&&h.dataUF.length||this.getSorter().length&&null!=f[0].pq_order))for(var h=0,c=f.length;h<c;h++)f[h].pq_order=h};f.getQueryStringSort=function(){if(this.cancel)return"";
var f=this.sorters,h=this.that.options.stringify;return f.length?!1===h?f:JSON.stringify(f):""};f.getSorter=function(){return this.sorters};f.setSorter=function(f){this.sorters=f.slice(0)};f.inSorters=function(f,h){for(var c=-1,e=0;e<f.length;e++)if(f[e].dataIndx==h){c=e;break}return c};f.sortLocalData=function(f){for(var h=this.that,c=h.colModel,e=this.sorters,a=0;a<e.length;a++){var b=e[a],d=h.getColIndx({dataIndx:b.dataIndx}),d=c[d],k=d.sortType;b.dataType=d.dataType;b.sortType=k}e.length||(e=
[{dataIndx:"pq_order",dir:"up",dataType:"integer"}]);return this._sortLocalData(e,f)};f._sortLocalData=function(f,h){function c(a,b,c,d){a=a[c];b=b[c];a=a?parseInt(a,10):0;b=b?parseInt(b,10):0;return(a-b)*d}function e(a,b,c,d){a=a[c];b=b[c];a=a?Date.parse(a):0;b=b?Date.parse(b):0;return(a-b)*d}function a(a,b,c,d){a=(a[c]+"").replace(/,/g,"");b=(b[c]+"").replace(/,/g,"");a=a?parseFloat(a):0;b=b?parseFloat(b):0;return(a-b)*d}function b(a,b,c,d){a=a[c];b=b[c];a=a?a:"";b=b?b:"";c=0;a>b?c=1:a<b&&(c=-1);
return c*d}function d(a,b,c,d){a=a[c];b=b[c];a=a?a.toUpperCase():"";b=b?b.toUpperCase():"";c=0;a>b?c=1:a<b&&(c=-1);return c*d}function k(a,b,c,d){a=a[c];b=b[c];c=0;if(a&&!b||!1===a&&null===b)c=1;else if(b&&!a||!1===b&&null===a)c=-1;return c*d}if(null==h||0==h.length)return[];if(!f||!f.length)return h;var l=this.that,g=l.columns,q=l.iGenerateView.readCell;(function(){for(var l=[],v=[],n=[],u=f.length,r=0;r<u;r++){var t=f[r],s=t.dataIndx,y="up"==t.dir?1:-1,x=t.sortType,t=t.dataType;v[r]=s;n[r]=y;l[r]=
"integer"==t?c:"float"==t?a:"function"==typeof t?function(a){return function(b,c,d,e){return a(b[d],c[d])*e}}(t):x?function(a){return function(b,c,d,e){return a(b,c,d)*e}}(x):"date"==t?e:"stringi"==t?d:"bool"==t?k:b;if((y=g[s])&&y.nested)for(r=0,x=h.length;r<x;r++)t=h[r],t[s]=q(t,y)}h=h.sort(function(a,b){for(var c=0,d=0;d<u&&(c=l[d](a,b,v[d],n[d]),0==c);d++);return c})})();return h}})(jQuery);
